## 小说模块

### 本模块包括

> 前台pc、wap 端

> 后台小说管理

> 小说爬虫

## 爬虫使用方法

允许直接输入小说页面，或整站

```cmd

php artisan book/spider --url= --site=

--url   表示单本

--start 开始章节 只对单本下载有效

--site  整站下载

```

## WEB 端爬取

进入admin 后台，点击“同步小说”菜单，搜索小说名或网址，

搜索小说调用 追书神器 api，

网址会调用自有爬虫爬取

根据目录下载，有进度条显示，每次下载20章节


## 自动识别原理

标题 只能取页面标题

第一步，获取源码

第二步，净化源码，去除head、去除空格、去除元素属性（保留img.src a.href）、规范<br>

第三步，提取元素标签并相邻合并，标记中间标签，例如\<dd>\<a> 会被合成一个 dd.a

第四步，根据最中间的标签判断内容，如果包含 a 则认为是目录，反之为内容

第五步，目录区域为中间标签开始位置到下一个标签的开始，提取 a 的链接，内容位置为前一个标签的开始位置减去闭合到下一标签的开始


## 注意

本程序采用单线程下载模式，下载会比较慢