function bindRegister(){$(".login-form .input-group input").on("blur",function(){var n=$(this),i=n.closest(".input-group"),o=n.attr("name"),n=n.val().toString().trim();n.length<1?i.addClass("is-invalid"):"name"===o||"email"===o?postJson(BASE_URI+"check",{name:o,value:n},function(n){200==n.code&&n.data&&(i.addClass("is-invalid"),Dialog.tip(("name"==o?"昵称":"邮箱")+"已注册"))}):"rePassword"===o&&n!==$('.login-form input[name="password"]').val()?(i.addClass("is-invalid"),Dialog.tip("两次密码不一致")):i.removeClass("is-invalid")})}function bindLogin(o){function n(){a.find(".qr-box img").attr("src",BASE_URI+"qr?v="+Math.random()),t=!0,r(),a.attr("class","login-qr-box")}var i=!1,t=!1,a=$(".login-form .login-qr-box"),e=function(i){$.getJSON(BASE_URI+"qr/check",function(n){200==n.code?(a.attr("class","login-qr-box qr_success"),t=!1,parseAjax(n)):201==n.code?i&&i():202==n.code?(a.attr("class","login-qr-box waiting_confirm"),i&&i()):t=(203==n.code?a.attr("class","login-qr-box qr_reject"):a.attr("class","login-qr-box qr_expired"),!1)})},r=function(){t&&setTimeout(function(){e(r)},3e3)};$(".login-form .other-box .fa-qrcode").on("click",function(){$(".login-box").addClass("slided"),i||(i=!0,n())}),a.find(".fa-sync").on("click",function(){n()}),a.find(".btn").on("click",function(){$(".login-box").removeClass("slided")}),$(".login-webauth").on("click",function(){navigator.credentials&&postJson(o+"/passkey",{},function(n){n=n.data;n.challenge=Base64.toBuffer(n.challenge),navigator.credentials.get({publicKey:n}).then(function(n){var i=n.response;postJson(o+"/passkey/login",{credential:{id:n.id,clientDataJSON:Base64.encode(i.clientDataJSON),authenticatorData:Base64.encode(i.authenticatorData),userHandle:Base64.encode(i.userHandle),signature:Base64.encode(i.signature)},redirect_uri:$("[name=redirect_uri]").val()})}).catch(console.error)})}).toggle(!!navigator.credentials)}$(function(){window.parent===window||$(window.parent.document.body).hasClass("login-page")?$(".login-form").on("focus",".input-group input",function(){$(this).closest(".input-group").addClass("input-focus").removeClass("error")}).on("blur",".input-group input",function(){$(this).closest(".input-group").removeClass("input-focus")}).on("click",".captcha-input .btn",function(n){n.preventDefault();n=$(this).find("img");n.attr("src",n.data("src")+"?v="+Math.random())}).on("submit",function(){var i,o=$(this);return 0<o.find(".error").length?Dialog.tip("您填写的信息不正确!"):(i=Dialog.loading(),postJson(o.attr("action"),o.serialize(),function(n){i.close(),1009===n.code?o.find(".captcha-input").show().find(".btn").trigger("click"):1015===n.code&&o.find(".2fa-input").show(),parseAjax(n)})),!1}):window.parent.location.href=window.location.href});