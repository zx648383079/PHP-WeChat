function formData(t){var o=[];return t.find("input,textarea,select").each(function(){this.type&&0<=["radio","checkbox"].indexOf(this.type)&&!this.checked||o.push(encodeURIComponent(this.name)+"="+encodeURIComponent($(this).val().toString()))}),o.join("&")}function bindBlogPage(){$(".book-nav").click(function(){$(this).toggleClass("hover")}),$(".book-search").focus(function(){$(this).addClass("focus")}).blur(function(){$(this).removeClass("focus")}),$(".book-search .fa-search").click(function(){var t=$(".book-search");t.hasClass("focus")?$(".book-search form").submit():t.addClass("focus")}),$(".book-navicon").click(function(){$(".book-skin").toggleClass("book-collapsed")}),$(".book-search [name=keywords]").keypress(function(){var t=$(this).val();t&&$.getJSON(BASE_URI+"home/suggest?keywords="+t,function(t){if(200==t.code){var e="";$.each(t.data,function(t,o){e+='<li><a href="'+o.url+'">'+o.title+"</li>"}),$(".book-search .search-tip").html(e)}})}),$(".book-body .book-item").addClass("fade-pre-item").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).removeClass("fade-item")}).lazyload({callback:function(t,o,e,n){t.removeClass("fade-pre-item").css("animation-duration",.5*Math.floor(n/2)+1.5+"s").addClass("fade-item")}})}function bindBlog(t,o,e){void 0===e&&(e={}),1!=o&&(uParse("#content",{rootPath:"/assets/ueditor"}),SyntaxHighlighter.all());var a=$(".book-dynamic");$.get(BASE_URI+"log",{blog:t},function(t){a.html(t)}),$.getJSON(BASE_URI+"counter",{blog:t},function(t){200==t.code&&($(".book-body .tools .comment b").text(t.data.comment_count),$(".book-body .tools .click b").text(t.data.click_count),$(".book-body .tools .recommend-blog b").text(t.data.recommend))});var c=$(".book-footer");0<c.length&&$.get(BASE_URI+"comment",{blog_id:t},function(t){c.html(t)}),$(".book-body .toggle-open").click(function(){$(this).closest(".book-body").toggleClass("open")}),$(".rule-box button").click(function(){var t=$(this);$.post(t.data("url"),formData(t.closest(".rule-box")),function(t){200==t.code?(alert(t.messages),setTimeout(function(){t.data.refresh?window.location.reload():t.data.url&&(window.location.href=t.data.url)},500)):alert(t.errors)},"json")}),$(".recommend-blog").click(function(){var o=$(this).find("b");$.getJSON(BASE_URI+"recommend",{blog_id:t},function(t){200!=t.code?Dialog.tip(t.message):o.text(t.data)})});var s=$(".book-skin");$(".book-navicon").click(function(){s.toggleClass("book-collapsed")});function n(){i.headers.length<1||i.box.toggle(767<$(window).width())}var i=$("#content").sideNav({target:".book-side-nav",contentLength:20,maxLength:8,title:e.side_title,maxFixedTop:function(t,o){var e=c.length<1?s.offset().top+s.height():c.offset().top,n=o+$(window).height()-t.height()<e;if(!n)return t.css("top","auto"),n;var i=a.offset().top+a.height()-o;return i<=0?i=0:i+=20,t.css("top",i+"px"),n}});n(),$(window).resize(function(){n()})}function bindBlogComment(t,e){void 0===e&&(e={});function o(o,e){void 0===e&&(e=n),$.get(BASE_URI+"comment/more",{blog_id:t,page:o,order:i?"desc":"asc"},function(t){o<2?e.html(t):e.append(t)})}var n=$("#comment-box"),i=!0;$(".comment-item .expand").click(function(){$(this).parent().parent().toggleClass("active")});var a=$(".book-comments").on("click","*[data-type=reply]",function(){var t=$(this),o=$(".book-comment-form");t.parent().append(o),o.find(".title").text(e.reply_title),o.find(".btn-submit").text(e.reply_btn),o.find("input[name=parent_id]").val(t.parents(".comment-item").attr("data-id"))}).on("click",".order span",function(){var t=$(this);t.hasClass("active")||(t.addClass("active").siblings().removeClass("active"),i=t.index()<1,o(1))}).on("click",".actions .agree",function(){var o=$(this),t=o.closest(".comment-item").data("id");$.getJSON(BASE_URI+"comment/agree",{id:t},function(t){302!=t.code?200==t.code?o.find("b").text(t.data):alert(t.errors):window.location.href=t.url})}).on("click",".actions .disagree",function(){var o=$(this),t=o.closest(".comment-item").data("id");$.getJSON(BASE_URI+"comment/disagree",{id:t},function(t){302!=t.code?200==t.code?o.find("b").text(t.data):alert(t.errors):window.location.href=t.url})});$(".book-comment-form .btn-cancel").click(function(){var t=$(this).closest(".book-comment-form"),o=$(".hot-comments");0<o.length?o.after(t):a.before(t),t.find("textarea").val(""),t.find(".title").text(e.comment_title),t.find(".btn-submit").text(e.comment_btn),t.find("input[name=parent_id]").val(0)}),$("#comment-form").submit(function(){var o=$(this);return $.post(o.attr("action"),o.serialize(),function(t){200!=t.code?alert(t.message):o.find(".btn-cancel").trigger("click")},"json"),!1}),n.on("click",".load-more",function(){var t=$(this);o(t.data("page")),t.remove()}),o(1)}$(function(){});