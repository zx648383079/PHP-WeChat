var OTHER_CODE=[8220,8221,8216,8217,65281,12290,65292,12304,12305,12289,65311,65288,65289,12288,12298,12299,65306];function getStrLength(t){if(!t)return 0;for(var e,n=0,i=0;e=t.charCodeAt(n);)n++,e<48||57<e&&e<65||90<e&&e<97||122<e&&e<128||128<e&&0<=OTHER_CODE.indexOf(e)||i++;return i}function bindChapter(){var e=$(".length-box"),n=$("#content-box"),t=function(){var t=getStrLength(n.val());e.find("span").text(t),e.find("input").val(t)};n.on("input propertychange",function(){t()}).on("keydown",function(t){if(9===t.keyCode){t.preventDefault();var e=this.selectionStart+4;this.value=this.value.substr(0,this.selectionStart)+"    "+this.value.substr(this.selectionStart),this.selectionStart=e,this.selectionEnd=e,this.focus()}}),t()}function bindImport(t){var a=$(".book-box"),o=[];$(".search form").submit(function(){return postJson(t+"spider/search",$(this).serialize(),function(t){if(200==t.code){o=t.data;for(var e="",n=0;n<o.length;n++){var i=o[n];e+='<div class="book-item" data-index="'+n+'"><div class="info"><p>'+i.name+"("+i.author+")</p><p>总字数： "+i.size+"</p> <p>最新章节： "+i.last_chapter+'</p></div><div class="actions"><a href="javascript:;">同步</a></div></div>'}a.html(e)}else parseAjax(t)}),!1}),a.on("click",".book-item .actions a",function(t){t.preventDefault()})}