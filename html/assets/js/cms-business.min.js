var isTouchDevice="ontouchstart"in document.documentElement;function setHome(e){for(var t=window,a=window.location.href,i=!1,n=0,o=[function(){e.style.behavior="url(#default#homepage)",e.setHomePage(a),i=!0},function(){t.netscape&&(t.netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),t.Components.classes["@mozilla.org/preferences-service;1"].getService(t.Components.interfaces.nsIPrefBranch).setCharPref("browser.startup.homepage",a),i=!0)}];n<o.length;n++){var s=o[n];try{s()}catch(e){}if(i)return}alert("抱歉，您所使用的浏览器无法完成此操作。\n您需要手动将【".concat(a,"】设置为首页。"))}function addFavorite(){for(var e=window,t=window.location.href,a=document.title,i=!1,n=0,o=[function(){e.external&&(e.external.addFavorite(t,a),i=!0)},function(){e.sidebar&&(e.sidebar.addPanel(a,t,""),i=!0)}];n<o.length;n++){var s=o[n];try{s()}catch(e){}if(i)return}alert("加入收藏失败，请使用Ctrl+D进行添加")}function parseAjax(e){if(302===e.code||401===e.code&&e.url)window.location.href=e.url;else{var i;if(200!==e.code)return"object"==typeof e.message?(i="",$.each(e.message,function(a,e){$.each(e,function(e,t){i=a+(t||"表单未填写完整")})}),void alert(i||"表单未填写完整")):void alert(e.message||"操作执行失败！");alert(e.message||"操作执行完成！"),e.data&&e.data.refresh&&setTimeout(function(){window.location.reload()},500),e.data&&e.data.url&&setTimeout(function(){-1===e.data.url?history.go(-1):window.location.href=e.data.url},500)}}function updateModalCenter(e){e.css({left:Math.max(window.innerWidth-e.width(),0)/2,top:Math.max(window.innerHeight-e.height(),0)/2,margin:0})}$(function(){$("img.lazy").lazyload({callback:"img"}),$(".menu-bar").on("click",".menu-item-arrow",function(){$(this).closest(".menu-item").toggleClass("menu-item-open")}),$(window).on("resize",function(){$(".dialog:visible").each(function(){updateModalCenter($(this))})}),$(document).on("click",".tab-box .tab-header .tab-item",function(){var e=$(this),t=(e.addClass("active").siblings().removeClass("active"),e.closest(".tab-box").find(".tab-body .tab-item").eq(e.index()).addClass("active"));t.siblings().removeClass("active"),t.trigger("tabActived",e.index())}).on("click","*[modal]",function(e){e.preventDefault(),e.stopPropagation();var e=$(this).attr("modal"),t=$("#"+e).show();"searchDialog"!==e&&updateModalCenter(t)}).on("change",".form-table select",function(){var e,t=$(this),a=t.data("tab");a&&(e=this.selectedIndex,a+="-",t.closest(".form-table").find("tr").each(function(){this.classList.contains(a+e)?this.classList.remove("hidden"):0<=this.className.indexOf(a)&&this.classList.add("hidden")}))}).on("submit","form[data-type=ajax]",function(e){e.preventDefault();var t=$(this);return $.post(t.attr("action"),t.serialize(),function(e){200===e.code&&t.hasClass("login-panel")?window.location.reload():parseAjax(e)},"json"),!1}).on("click","a[data-type=ajax]",function(e){e.preventDefault();e=$(this).attr("data-tip")||"确定执行此操作？";confirm(e)&&$.post($(this).attr("href"),{},function(e){window.location.reload()},"json")}).on("click",".code-input-group img",function(e){e.preventDefault();var e=$(this),t=e.attr("src");e.attr("src",t.split("?")[0]+"?v="+Math.random())}).on("click",".dialog .dialog-close",function(){$(this).closest(".dialog").hide()}).on("click",".dialog .dialog-submit",function(){$(this).closest(".dialog").find("form").trigger("submit")}).on("click",".app-header .nav-bar .nav-item",function(e){var t;e.target===this&&isTouchDevice&&0!==(t=$(this)).find(".nav-item-drop").length&&(e.preventDefault(),t.toggleClass("nav-item-open").siblings().removeClass("nav-item-open"))}).on("click",".app-header .nav-bar-toggle",function(){$(this).closest(".app-header").toggleClass("nav-bar-open")}).on("click",function(e){var e=$(e.target),t=e.hasClass("dialog")?e:e.closest(".dialog");$(".dialog").each(function(){t.is(this)||$(this).hide()})})});