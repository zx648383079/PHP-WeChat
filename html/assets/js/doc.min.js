function formatJson(t,e){var a=null,i="",o=0;return(e=e||{}).newlineAfterColonIfBeforeBraceOrBracket=!0===e.newlineAfterColonIfBeforeBraceOrBracket,e.spaceAfterColon=!1!==e.spaceAfterColon,a=/([\{\}])/g,t=(t=("string"!=typeof t||(t=JSON.parse(t)),JSON.stringify(t))).replace(a,"\r\n$1\r\n"),a=/([\[\]])/g,t=t.replace(a,"\r\n$1\r\n"),a=/(\,)/g,t=t.replace(a,"$1\r\n"),a=/(\r\n\r\n)/g,t=t.replace(a,"\r\n"),a=/\r\n\,/g,t=t.replace(a,","),e.newlineAfterColonIfBeforeBraceOrBracket||(a=/\:\r\n\{/g,t=t.replace(a,":{"),a=/\:\r\n\[/g,t=t.replace(a,":[")),e.spaceAfterColon&&(a=/\:/g,t=t.replace(a,":")),t.split("\r\n").forEach(function(t,e){var a=0,r=0,n="";for(t.match(/\{$/)||t.match(/\[$/)?r=1:t.match(/\}/)||t.match(/\]/)?0!==o&&(o-=1):r=0,a=0;a<o;a++)n+="    ";i+=n+t+"\r\n",o+=r}),i}function delField(e,t){postJson(t,function(t){200==t.code&&$(e).parents("tr").remove()})}function getRowHtml(t,e){var a;switch(void 0===e&&(e=!0),t.kind+""){case"3":a=strFormat('<td style="width: 20%">{0}</td><td style="width: 35%">{1}</td><td style="width: 35%">{2}</td><td style="width: 10%"><a href="javascript:;" onclick="editField(this, \'{3}\');" class="fa fa-edit"></a><a href="javascript:;" onclick="delField(this, \'{4}\');" class="fa fa-trash-o"></a></td>',t.name,t.default_value,t.remark,t.edit_url,t.delete_url);break;case"2":a=strFormat('<td style="text-align: left;padding-left: 50px;">{1}{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td>{6}</td><td style="width: 10%"><a href="javascript:;" onclick="editField(this, \'{7}\');" class="fa fa-edit"></a><a href="javascript:;" onclick="delField(this, \'{8}\');" class="fa fa-trash-o"></a>{9}</td>',t.parent_id<1?"warning":"",0<t.parent_id?"└":"",t.name,t.title,t.type_label,t.mock,t.remark,t.edit_url,t.delete_url,t.has_children?strFormat('<a href="javascript:;" onclick="addField(\'{0}\', this);" class="btn btn-xs"><i class="fa fa-fw fa-plus"></i></a>',t.child_url):"");break;case"1":default:a=strFormat('<td>{0}</td><td>{1}</td><td>{2}</td><td>{3}</td><td>{4}</td><td>{5}</td><td style="width: 10%"><a href="javascript:;" onclick="editField(this, \'{6}\');" class="fa fa-edit"></a><a href="javascript:;" onclick="delField(this, \'{7}\');" class="fa fa-trash-o"></a></td>',t.name,t.title,t.type_label,t.is_required?"是":"否",t.default_value,t.remark,t.edit_url,t.delete_url)}return e?"<tr>"+a+"</tr>":a}function addField(t,e){Dialog.box({url:t,title:"添加字段"}).on("done",function(){var t=this.find("form");postJson(t.attr("action"),t.serialize(),function(t){200==t.code?(Dialog.remove(),e?$(e).closest("tr").after(getRowHtml(t.data)):$("#table-"+t.data.kind+" tbody:last").append(getRowHtml(t.data))):parseAjax(t)})})}function editField(e,t){Dialog.box({url:t,title:"编辑字段"}).on("done",function(){var t=this.find("form");postJson(t.attr("action"),t.serialize(),function(t){200==t.code?(Dialog.remove(),$(e).parents("tr").html(getRowHtml(t.data,!1))):parseAjax(t)})})}function importField(t){Dialog.form({content:{type:"textarea",placeholder:"允许xml、json和表单格式数据",style:"width: 500px;height:300px"}},"自动配数据").on("done",function(){postJson(t,this.data,function(t){parseAjax(t),this.close()})})}function refreshMock(t){postJson(t,function(t){200==t.code?refreshJson(t.data):parseAjax(t)})}function refreshJson(t){$(".json-box").html('<pre><code class="language-json">'+Prism.highlight(formatJson(t),Prism.languages.json)+"</code></pre>")}$(function(){new ClipboardJS(".btn-copy").on("success",function(t){Dialog.tip("复制成功")}),$("#debug-box #uri-list").change(function(){$(this).next("input").val($(this).find("option:selected").attr("data-url"))}),$("#debug-box table").on("click",".fa-trash-o",function(){$(this).parents("tr").remove()}),$("#debug-box .js_addHeaderBtn").click(function(){$(this).parents(".panel").find("tbody:last").append('<tr><td style="width:40%"> <input name="header[key][]" class="form-control" placeholder="key"/> </td><td style="width:55%"> <input name="header[value][]" class="form-control" placeholder="value"/> </td><td style="width:5%"><a href="javascript:void(0);" class="fa fa-trash-o" title="删除header参数"></a> </td></tr>')}),$("#debug-box .js_addRequestBtn").click(function(){$(this).parents(".panel").find("tbody:last").append('<tr><td style="width:40%"> <input name="request[key][]" class="form-control" placeholder="key"/> </td><td style="width:55%"> <input name="request[value][]" class="form-control" placeholder="value"/> </td><td style="width:5%"><a href="javascript:void(0);" class="fa fa-trash-o" title="删除request参数"></a> </td></tr>')}),$("#debug-box .js_submit").click(function(){var t=$("#debug-box form");$.post(t.attr("action"),t.serialize(),function(t){$("#debug-box .js_responseBox").html(t)})}),$('select[data-type="code"]').change(function(){var t,e=$(this),a=e.val();if(!(a.trim().length<1)){var r=e.attr("name");postJson(e.data("url"),((t={})[r]=a,t),function(t){200==t.code?Dialog.box({title:"预览",content:'<pre><code class="language-'+a+'">'+Prism.highlight(t.data,Prism.languages[a])+"</code></pre>"}):parseAjax(t)})}})});