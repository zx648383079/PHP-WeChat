function formatJson(t,e){var i="",r=0;return(e=e||{}).newlineAfterColonIfBeforeBraceOrBracket=!0===e.newlineAfterColonIfBeforeBraceOrBracket,e.spaceAfterColon=!1!==e.spaceAfterColon,"string"!=typeof t||(t=JSON.parse(t)),t=(t=(t=(t=(t=(t=JSON.stringify(t)).replace(/([\{\}])/g,"\r\n$1\r\n")).replace(/([\[\]])/g,"\r\n$1\r\n")).replace(/(\,)/g,"$1\r\n")).replace(/(\r\n\r\n)/g,"\r\n")).replace(/\r\n\,/g,","),e.newlineAfterColonIfBeforeBraceOrBracket||(t=(t=t.replace(/\:\r\n\{/g,":{")).replace(/\:\r\n\[/g,":[")),(t=e.spaceAfterColon?t.replace(/\:/g,":"):t).split("\r\n").forEach(function(t,e){var n=0,o=0,a="";for(t.match(/\{$/)||t.match(/\[$/)?o=1:t.match(/\}/)||t.match(/\]/)?0!==r&&--r:o=0,n=0;n<r;n++)a+="    ";i+=a+t+"\r\n",r+=o}),i}function dialogPost(t,e,n){Dialog.box({url:t,title:e}).on("done",function(){var e=this,t=this.find("form");$.post(t.attr("action"),t.serialize(),function(t){e.close(),n&&n(t)})})}function refreshMock(t){postJson(t,function(t){200!=t.code?parseAjax(t):refreshJson(t.data)})}function refreshJson(t){$(".json-box").html('<pre><code class="language-json">'+Prism.highlight(formatJson(t),Prism.languages.json)+"</code></pre>")}function bindEditProject(){$("body").on("click",".js_addEnvBtn",function(t){t.stopPropagation();t=$(this).closest("tr");t.before(t.clone(!0)).find("input").val("")}),$("body").on("click",".js_deleteEnvBtn",function(t){if(t.stopPropagation(),$(".js_deleteEnvBtn").length<=1)return Dialog.tip("至少要保留一个环境域名"),!1;$(this).closest("tr").remove()}),$("#type").change(function(t){$("#environment-box").toggle(1==$(this).val())})}function bindProject(e){$(".version-bar .btn").on("click",function(){var t=prompt("请输入新版本号：");!t||t.trim().length<1||postJson(BASE_URI+"project/version_new",{project:e,version:$(".version-bar select").val(),name:t})})}function editApi(o,a){$("[name=parent_id]").change(function(){$(".extent-box").toggle(0<$(this).val())}),$(document).on("click",'[data-action="add"]',function(){var e=$(this).closest(".panel"),t=e.data("kind");dialogPost(o+"create_field?kind="+t+"&api_id="+a,"添加字段",function(t){e.find("table tbody").html(t)})}).on("click",'[data-action="import"]',function(){var n=$(this).closest(".panel"),t=n.data("kind");Dialog.form({content:{type:"textarea",placeholder:"允许xml、json和表单格式数据",style:"width: 500px;height:300px"}},"自动配数据").on("done",function(){var e=this;$.post(o+"import_field?kind="+t+"&api_id="+a,e.data,function(t){e.close(),n.find("table tbody").html(t)})})}).on("click",'[data-action="edit"]',function(){var e=$(this).closest(".panel"),t=(e.data("kind"),$(this).closest("tr"));dialogPost(o+"edit_field?id="+t.data("id"),"编辑字段",function(t){e.find("table tbody").html(t)})}).on("click",'[data-action="delete"]',function(){var e=$(this).closest(".panel"),t=(e.data("kind"),$(this).closest("tr"));$.post(o+"delete_field?id="+t.data("id"),function(t){e.find("table tbody").html(t)})}).on("click",'[data-action="child"]',function(){var e=$(this).closest(".panel"),t=e.data("kind"),n=$(this).closest("tr");dialogPost(o+"create_field?kind="+t+"&api_id="+a+"&parent_id="+n.data("id"),"添加字段",function(t){e.find("table tbody").html(t)})})}$(function(){var n;new ClipboardJS(".btn-copy").on("success",function(t){Dialog.tip("复制成功")}),$("#debug-box #uri-list").change(function(){$(this).next("input").val($(this).find("option:selected").attr("data-url"))}),$("#debug-box table").on("click",".fa-trash-o",function(){$(this).parents("tr").remove()}),$("#debug-box .js_addHeaderBtn").on("click",function(){$(this).parents(".panel").find("tbody:last").append('<tr><td style="width:40%"> <input name="header[key][]" class="form-control" placeholder="key"/> </td><td style="width:55%"> <input name="header[value][]" class="form-control" placeholder="value"/> </td><td style="width:5%"><a href="javascript:void(0);" class="fa fa-trash-o" title="删除header参数"></a> </td></tr>')}),$("#debug-box .js_addRequestBtn").on("click",function(){$(this).parents(".panel").find("tbody:last").append('<tr><td style="width:40%"> <input name="request[key][]" class="form-control" placeholder="key"/> </td><td style="width:55%"> <input name="request[value][]" class="form-control" placeholder="value"/> </td><td style="width:5%"><a href="javascript:void(0);" class="fa fa-trash-o" title="删除request参数"></a> </td></tr>')}),$("#debug-box .js_submit").on("click",function(){var t=$("#debug-box form");$.post(t.attr("action"),t.serialize(),function(t){$("#debug-box .js_responseBox").html(t)})}),$(".version-bar select").change(function(){var t=window.location.href;window.location.href=t+(0<t.indexOf("?")?"&":"?")+"version="+$(this).val()}),0<$("#coder-dialog").length&&((n=$("#coder-dialog").dialog()).find(".dialog-header form").submit(function(){var t=$(this),e=t.find("[name=lang]").val();return postJson(t.attr("action"),t.serialize(),function(t){200!=t.code?parseAjax(t):(n.find(".dialog-body").html('<pre><code class="language-'+e+'">'+Prism.highlight(t.data,Prism.languages[e])+"</code></pre>"),n.showCenter())}),!1}),$('a[data-action="code"]').on("click",function(){n.show()}))});