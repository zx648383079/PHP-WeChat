$(function(){var e=$("footer"),i=$(window).height()-e.offset().top-e.height(),s=(0<i&&e.css("margin-top",i+"px"),window.localStorage.getItem("c_t")||$(".dialog-cookie-tip").show(),$(".dialog-cookie-tip .btn").on("click",function(){window.localStorage.setItem("c_t","1"),$(this).closest(".dialog-cookie-tip").hide()}),"undefined"==typeof SUGGESTION_URI&&"undefined"!=typeof BASE_URI&&(SUGGESTION_URI=BASE_URI+"suggestion"),$(".dialog-search"));$(".nav-bar .search-icon").on("click",function(){s.show(),s.find("form input").trigger("focus")}),s.on("click",".dialog-close",function(){s.hide()}).on("keyup","form input",function(e){var i=$(this),t=i.val();if(s.toggleClass("inputting",0<t.length),"Enter"===e.key)i.closest("form").trigger("submit");else if("ArrowDown"!==e.key&&"ArrowUp"!==e.key)t=t,o=s.find(".search-suggestion"),"undefined"==typeof SUGGESTION_URI?o.hide():!t||t.length<1?o.html("").hide():$.getJSON(SUGGESTION_URI,{keywords:t},function(e){var n;200==e.code&&(n="",e.data.forEach(function(e,i){i+=1;var t=void 0,o=e;"object"==typeof e&&(t=e.url,o=e.title||e.name),n+=(t?'<li data-url="'.concat(t,'"><span>'):"<li><span>").concat(i,"</span> ").concat(o,"</li>")}),o.html(n).show())});else{var o,n=s.find(".search-suggestion li");if(!(n.length<0)){for(var a=-1,r=0;r<n.length;r++){var c=$(n[r]);if(c.hasClass("active")){a=r,c.removeClass("active");break}}"ArrowDown"===e.key?a=a<n.length-1?a+1:0:"ArrowUp"===e.key&&(a=(a<1?n.length:a)-1);t=n.eq(a);t.addClass("active"),i.val(t.text().replace(/^\d+/,"").trim())}}}).on("click",".input-clear",function(){$(this).prev("input").val("").trigger("keyup")}).on("click",".search-suggestion li",function(){var e=$(this),i=e.data("url");i?window.location.href=i:(e.addClass("active").siblings().removeClass("active"),s.find("form input").val(e.text().replace(/^\d+/,"").trim()),s.find("form").trigger("submit"))})});