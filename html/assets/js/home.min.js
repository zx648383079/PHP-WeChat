$(function(){var i=$("footer"),e=$(window).height()-i.offset().top-i.height(),r=(0<e&&i.css("margin-top",e+"px"),$.cookie("c_t")||$(".dialog-cookie-tip").show(),$(".dialog-cookie-tip .btn").on("click",function(){$.cookie("c_t",1),$(this).closest(".dialog-cookie-tip").hide()}),"undefined"==typeof SUGGESTION_URI&&"undefined"!=typeof BASE_URI&&(SUGGESTION_URI=BASE_URI+"suggestion"),$(".dialog-search"));$(".nav-bar .search-icon").on("click",function(){r.show(),r.find("form input").focus()}),r.on("click",".dialog-close",function(){r.hide()}).on("keyup","form input",function(i){var e=$(this),o=e.val();if(r.toggleClass("inputting",0<o.length),"Enter"===i.key)e.closest("form").submit();else{if("ArrowDown"!==i.key&&"ArrowUp"!==i.key)return o=o,t=r.find(".search-suggestion"),void("undefined"==typeof SUGGESTION_URI?t.hide():!o||o.length<1?t.html("").hide():$.getJSON(SUGGESTION_URI,{keywords:o},function(i){var n;200==i.code&&(n="",i.data.forEach(function(i,e){e+=1;var o=void 0,t=i;"object"==typeof i&&(o=i.url,t=i.title||i.name),n+=(o?'<li data-url="'.concat(o,'"><span>'):"<li><span>").concat(e,"</span> ").concat(t,"</li>")}),t.html(n).show())}));var t,n=r.find(".search-suggestion li");if(!(n.length<0)){for(var a=-1,c=0;c<n.length;c++){var s=$(n[c]);if(s.hasClass("active")){a=c,s.removeClass("active");break}}"ArrowDown"===i.key?a=a<n.length-1?a+1:0:"ArrowUp"===i.key&&(a=(a<1?n.length:a)-1);o=n.eq(a);o.addClass("active"),e.val(o.text().replace(/^\d+/,"").trim())}}}).on("click",".input-clear",function(){$(this).prev("input").val("").trigger("keyup")}).on("click",".search-suggestion li",function(){var i=$(this),e=i.data("url");e?window.location.href=e:(i.addClass("active").siblings().removeClass("active"),r.find("form input").val(i.text().replace(/^\d+/,"").trim()),r.find("form").submit())})});