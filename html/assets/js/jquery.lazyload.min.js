var LazyMode;!function(t){t[t.once=0]="once",t[t.every=1]="every"}(LazyMode||(LazyMode={}));var LazyItem=function(){function t(t,o,i,e){void 0===i&&(i=LazyMode.once),void 0===e&&(e=0),this.element=t,this.callback=o,this.mode=i,this.diff=e}return t.prototype.refresh=function(){this._lastHeight=void 0},t.prototype.canRun=function(t,o){if(this.mode==LazyMode.once&&this._lastHeight)return!1;var i=this.element.offset().top;return i+this.diff>=t&&i<o},t.prototype.run=function(t,o){if(this.mode==LazyMode.once&&this._lastHeight)return!1;var i=this.element.offset().top;return!(i+this.diff<t||i>=o)&&(this.callback.call(this,this.element),this._lastHeight=t+this.diff,!0)},t}(),Lazy=function(){function t(t,o){this.element=t,this.options=$.extend({},new LazyDefaultOptions,o);var i=$(window),e=this;this._init(),i.scroll(function(){e.scrollInvote()}),this.scrollInvote()}return t.prototype.scrollInvote=function(){var t=$(window),o=t.scrollTop(),i=t.height()+o;this.run(o,i)},t.prototype.run=function(t,o){if(this._data)for(var i=this._data.length-1;i>=0;i--){var e=this._data[i];e.run(t,o)&&e.mode==LazyMode.once&&this._data.splice(i,1)}},t.prototype._init=function(){"function"!=typeof this.options.callback&&(this.options.callback=t.getMethod(this.options.callback)),this._data=[];var o=this;this.element.each(function(t,i){var e=new LazyItem($(i),o.options.callback,o.options.mode,o.options.diff);o._data.push(e)})},t.addMethod=function(t,o){this.methods[t]=o},t.getMethod=function(t){return this.methods[t]},t.methods={},t}();Lazy.addMethod("img",function(t){var o=t.attr("data-original");$("<img />").bind("load",function(){t.attr("src",o)}).attr("src",o)}),Lazy.addMethod("tpl",function(t){var o=t.attr("data-url"),i=t.attr("data-tpl");$.getJSON(o,function(o){0==o.code&&("string"!=typeof o.data&&(o.data=template(i,o.data)),t.html(o.data))})});var LazyDefaultOptions=function(){return function(){this.mode=LazyMode.once,this.diff=0}}();jQuery.fn.lazyload=function(t){return new Lazy(this,t)};