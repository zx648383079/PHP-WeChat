!function(t){t[t.once=0]="once",t[t.every=1]="every"}(LazyMode=LazyMode||{});var LazyMode,LazyItem=function(){function t(t,a,e,o){var n=this;void 0===e&&(e=LazyMode.once),void 0===o&&(o=0),this.element=t,this.callback=a,this.mode=e,this.diff=o,t.on("lazy-refresh",function(){n.refresh()})}return t.prototype.refresh=function(){this._lastHeight=void 0},t.prototype.canRun=function(t,a){var e;return!(this.mode==LazyMode.once&&null!=this._lastHeight||this.element.parent().length<1)&&("function"==typeof this.diff?this.diff.call(this,t,a):(e=this.element.offset().top)+this.diff>=t&&e<a)},t.prototype.run=function(t,a,e){return this.callback.call(this,this.element,t,a,e=void 0===e?0:e),this._lastHeight=t,!0},t}(),Lazy=function(){function n(t,a){this.element=t,this.options=$.extend({},new LazyDefaultOptions,a);var t=$(window),e=this;this._init(),t.on("scroll",function(){e.scrollInvote()}),this.scrollInvote()}return n.prototype.scrollInvote=function(){var t=$(window),a=t.scrollTop(),t=t.height()+a;this.run(a,t)},n.prototype.run=function(t,a){if(this._data)for(var e=0,o=0,n=this._data.length;o<n;o++){var i=this._data[o];i.canRun(t,a)&&i.run(t,a,e++)}},n.prototype._init=function(){var a=this,o=(this._data=[],this);this.element.each(function(t,a){a=new LazyItem($(a),"function"!=typeof o.options.callback?n.getMethod(o.options.callback):o.options.callback,o.options.mode,o.options.diff);o._data.push(a)}),$.each(this.options.data,function(t,e){e instanceof LazyItem?a._data.push(e):("string"==typeof t&&(e.tag=t),$(e.tag).each(function(t,a){a=new LazyItem($(a),"function"!=typeof e.callback?n.getMethod(e.callback):e.callback,e.mode||LazyMode.once,e.diff||0);o._data.push(a)}))})},n.addMethod=function(t,a){this.methods[t]=a},n.getMethod=function(t){return this.methods[t]},n.methods={},n}(),LazyDefaultOptions=(Lazy.addMethod("img",function(t){var a=t.attr("data-src");$("<img />").on("load",function(){t.is("img")||t.is("video")?t.attr("src",a):t.css("background-image","url("+a+")")}).attr("src",a)}),Lazy.addMethod("tpl",function(e){var t=e.attr("data-url"),o=(e.addClass("lazy-loading"),e.attr("data-tpl"));$.get(t,function(t){var a="";if("object"==typeof t){if(200!=t.code)return;a="string"!=typeof t.data?template(o,t.data):t.data}else a=t;e.removeClass("lazy-loading"),e.html(a),e.trigger("lazyLoaded")},void 0===o?null:"json")}),Lazy.addMethod("scroll",function(a){var e=parseInt(a.attr("data-page")||"0")+1,t=a.attr("data-url"),o=a.attr("data-tpl"),n=a.attr("data-target");$.getJSON(t,{page:e},function(t){200==t.code&&("string"!=typeof t.data&&(t.data=template(o,t.data)),$(n).html(t.data),a.attr("data-page",e))})}),function(){this.mode=LazyMode.once,this.diff=0});jQuery.fn.lazyload=function(t){return new Lazy(this,t)};