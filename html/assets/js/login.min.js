$(document).ready(function(){if($(window.parent.document.body).hasClass("login-page")){$(".login-form").submit(function(){var e=$(this);return $.post(e.attr("action"),e.serialize(),function(e){parseAjax(e)},"json"),!1}),$(".register-form").validate({rules:{mobile:{required:!0,isMobile:!0,remote:"/login/check?register=1"},password:{required:!0,minlength:5},password_confirmation:{required:!0,minlength:5,equalTo:"#password"}},messages:{mobile:{required:"请输入手机号",isMobile:"手机号格式不正确",remote:"此手机号已注册"},password:{required:"请输入密码",minlength:"密码长度不能小于 5 个字母"},password_confirmation:{required:"请输入密码",minlength:"密码长度不能小于 5 个字母",equalTo:"两次密码输入不一致"}},errorPlacement:function(e,i){i.after(e)},submitHandler:function(e){var i=Dialog.loading();return $(e).ajaxSubmit({success:function(e){"object"!=typeof e&&(e=JSON.parse(e)),i.close(),0==e.code&&(e.msg="注册成功！"),e.msg||(e.msg="注册失败，请验证您的注册信息是否正确！"),Dialog.tip(e.msg),e.data&&setTimeout(function(){e.data.url?window.location.href=e.data.url:window.location.href="/"},1e3)}}),!1}}),$(".sendCode").click(function(){var o=$(this),t=$(this).attr("data-type")||"register";if(!o.hasClass("disable"))if($(".ziphone").hasClass("error"))Dialog.tip("请输入有效的手机号码！");else{var a=$(".ziphone").val();!a||a.length<11?Dialog.tip("请输入有效的手机号码！"):$.post("/sms/send/"+t,{_token:$('meta[name="csrf-token"]').attr("content"),mobile:a},function(t){if(0==t.code)return Dialog.tip("验证码已发送至 "+a+" ，请注意查收"),o.addClass("disable").addClass("sent"),e=60,void i();Dialog.tip(t.msg)},"json")}});var e=60,i=function(){--e<1?$(".sendCode").val("重新发送验证码").removeClass("disable"):($(".sendCode").val(e),setTimeout(i,1e3))}}else window.parent.location.href=window.location.href});