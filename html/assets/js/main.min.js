function postJson(t,a,e){"function"==typeof a&&(e=a,a={}),$.post(t,a,e||parseAjax,"json")}function ajaxForm(t,a,e){postJson(t,a,function(t){(e||parseAjax)(t)})}function formData(t){var a=[];return t.find("input,textarea,select").each(function(){this.type&&0<=["radio","checkbox"].indexOf(this.type)&&!this.checked||a.push(encodeURIComponent(this.name)+"="+encodeURIComponent($(this).val().toString()))}),a.join("&")}function parseAjax(t){302===t.code||401===t.code&&t.url?window.location.href=t.url:200!==t.code?Dialog.tip(t.message||"操作执行失败！"):(Dialog.tip(t.message||"操作执行完成！"),t.data&&t.data.refresh&&setTimeout(function(){"function"==typeof parseAjaxUri?parseAjaxUri(window.location.href):window.location.reload()},500),t.data&&t.data.url&&setTimeout(function(){-1===t.data.url?history.go(-1):"function"==typeof parseAjaxUri?parseAjaxUri(t.data.url):window.location.href=t.data.url},500))}var toFloat=function(t){return(t=t&&t.toString().replace(",","").match(/[\d\.]+/))?parseFloat(t):0},toInt=function(t){return(t=t&&t.toString().replace(",","").match(/[\d]+/))?parseInt(t,10):0},strFormat=function(t){for(var e=[],a=1;a<arguments.length;a++)e[a-1]=arguments[a];return t.replace(/\{(\d+)\}/g,function(t,a){return e[a]})};$(function(){var file_upload,autoRedirct=("function"==typeof Upload&&"string"==typeof UPLOAD_URI&&(file_upload=new Upload(null,{url:UPLOAD_URI,name:"upfile",template:"{url}",onafter:function(t,a){return"SUCCESS"==t.state?a.prev("input").val(t.url):302===t.code&&(location.href=t.url),!1}})),$(document).on("click","a[data-type=refresh]",function(){window.location.reload()}).on("click","a[data-type=del]",function(t){t.preventDefault();var a,t=$(this).attr("data-tip")||"确定删除这条数据？";confirm(t)&&(a=Dialog.loading(),postJson($(this).attr("href"),function(t){a.close(),200!=t.code||t.msg||(t.msg="删除成功！"),parseAjax(t)}))}).on("click","a[data-type=ajax]",function(e){e.preventDefault();var $this=$(this),successTip=$this.attr("data-success")||"提交成功！",errorTip=$this.attr("data-error")||"提交失败！",callback=$this.attr("data-callback"),loading=Dialog.loading();postJson($this.attr("href"),function(data){loading.close(),200!=data.code||data.msg||(data.msg=successTip),200==data.code&&callback&&eval(callback+"($this, data);"),parseAjax(data)})}).on("submit","form[data-type=ajax]",function(){var t=$(this),a=Dialog.loading();return ajaxForm(t.attr("action"),t.serialize(),function(t){a.close(),parseAjax(t)}),!1}).on("click","a[data-type=post]",function(t){t.preventDefault();t=$('<form action="'+$(this).attr("href")+'" method="post"></form');$(document.body).append(t),t.submit()}).on("click",".file-input [data-type=upload]",function(){var t=$(this);file_upload.options.filter=t.data("allow")||"",file_upload.start(t)}).on("click",".file-input [data-type=preview]",function(){var t=$(this).parents(".file-input").find("input").val();t?Dialog.box({title:"预览",content:'<img src="'+t+'">'}):Dialog.tip("请上传图片！")}).on("click",".zd-tab .zd-tab-head .zd-tab-item",function(){var t=$(this),a=(t.addClass("active").siblings().removeClass("active"),t.closest(".zd-tab").find(".zd-tab-body .zd-tab-item").eq(t.index()).addClass("active"));a.siblings().removeClass("active"),a.trigger("tabActived",t.index())}).on("click",".tab-box .tab-header .tab-item",function(){var t=$(this),a=(t.addClass("active").siblings().removeClass("active"),t.closest(".tab-box").find(".tab-body .tab-item").eq(t.index()).addClass("active"));a.siblings().removeClass("active"),a.trigger("tabActived",t.index())}).on("click",".page-tip .toggle",function(){$(this).closest(".page-tip").toggleClass("min")}),$(".sidebar-container .sidebar-container-toggle").click(function(){var t=$(this).closest(".app-wrapper").toggleClass("wrapper-min");t.find("ul").height()<$(window).height()-100&&t.toggleClass("sidebar-fixed",t.hasClass("wrapper-min")),$(window).trigger("resize")}),$(".sidebar-container li a").click(function(){var t=$(this),a=t.closest("li");0<a.find("ul").length?a.toggleClass("expand"):($(".sidebar-container li").removeClass("active"),a.addClass("active"),t.closest(".app-wrapper").removeClass("wrapper-min"))}),function(){var t,a,e,i,o=$(".autoRedirct");o.length<1||(t=o.attr("href")||o.attr("data-url"),a=o.text(),(e=toInt(o.attr("data-time")))<1&&(e=3),o.text(a+"("+e+" 秒)"),i=setInterval(function(){e--,o.text(a+"("+e+" 秒)"),e<=0&&(clearInterval(i),o.text(a+"(正在跳转...)"),window.location.href=t)},1e3))});autoRedirct()});