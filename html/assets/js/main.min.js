var parseAjax=function(t){200!=t.code||t.message||(t.message="执行成功！"),Dialog.tip(t.message),t.data&&setTimeout(function(){t.data.url?window.location.href=t.data.url:(t.data.refresh&&window.location.reload(),t.data.back&&window.history.back())},1e3)},toFoat=function(t){return t&&(t=t.replace(",","").match(/[\d\.]+/))?parseFloat(t):0},toInt=function(t){return t&&(t=t.replace(",","").match(/[\d]+/))?parseInt(t):0},Uri=function(){function t(t,a){void 0===t&&(t=""),void 0===a&&(a={}),this._path=t,this._data=a,t.indexOf("?")>=0&&(e=this._parseUrl(t),this._path=e[0],this._data=e[1]);var e}return t.prototype.setData=function(t,a){return"object"==typeof t?this._data=$.extend(this._data,t):this._data[t]=a,this},t.prototype.removeKey=function(){for(var t=this,a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];return a.forEach(function(a){delete t._data[a]}),this},t.prototype.clearData=function(){return this._data={},this},t.prototype.get=function(t,a){$.get(this.toString(),t,a)},t.prototype.getJson=function(t){$.getJSON(this.toString(),t)},t.prototype.post=function(t,a,e){$.post(this.toString(),t,a,e)},t.parse=function(a){return"object"==typeof a?a:new t(a)},t.prototype.toString=function(){var a=t.getData(this._data);return""==a?this._path:this._path+"?"+a},t.getData=function(a){if("object"!=typeof a)return a;var e="";return $.each(a,function(a,n){e+=t._filterValue(n,a)}),e.substring(0,e.length-1)},t._filterValue=function(a,e){if("object"!=typeof a)return e+"="+a+"&";var n="",r=a instanceof Array;return $.each(a,function(a,o){n+=t._filterValue(o,e+(r?"[]":"["+a+"]"))}),n},t.prototype._parseUrl=function(t){var a=t.split("?",2),e=a[0],n=a[1];if(!n)return[e,{}];for(var r,o={},i=n.split("&"),c=i.length,s=0;s<c;s++)i[s]&&(o[(r=i[s].split("="))[0]]=r[1]);return[e,o]},t.remove=function(){for(var t=[],a=0;a<arguments.length;a++)t[a]=arguments[a];window.location.replace((e=this.parse(window.location.href)).removeKey.apply(e,t).toString());var e},t.replace=function(t,a){window.location.replace(this.parse(window.location.href).setData(t,a).toString())},t}();$(document).ready(function(){$(".exportA").click(function(t){t.preventDefault();var a=$(this).attr("href")||Uri.parse(window.location.href).setData("export",1).toString();window.open(a,"_blank")}),$(".refreshA").click(function(){window.location.reload()}),$(".postA").click(function(t){t.preventDefault();var a=$('<form action="'+$(this).attr("href")+'" method="post"></form');a.append('<input type="hidden" name="_token" value="'+$('meta[name="csrf-token"]').attr("content")+'">'),$(document.body).append(a),a.submit()}),$(".delA").click(function(t){t.preventDefault();var a=$(this).attr("data-tip")||"确定删除这条数据？";confirm(a)&&$.post($(this).attr("href"),{_token:$('meta[name="csrf-token"]').attr("content")},function(t){0!=t.code||t.msg||(t.msg="删除成功！"),parseAjax(t)},"json")}),$(".ajaxA").click(function(e){e.preventDefault();var successTip=$(this).attr("data-success")||"提交成功！",errorTip=$(this).attr("data-error")||"提交失败！",callback=$(this).attr("data-callback");$.post($(this).attr("href"),{_token:$('meta[name="csrf-token"]').attr("content")},function(data){0!=data.code||data.msg||(data.msg=successTip),0==data.code&&callback&&eval(callback+"();"),parseAjax(data)},"json")}),$(".number-box .number-minus").click(function(){var t=$(this).parents(".number-box").find(".number"),a=toInt(t.val());t.val(Math.max(a-1,toInt(t.attr("min")))),t.trigger("change")}),$(".number-box .number-plus").click(function(){var t=$(this).parents(".number-box").find(".number"),a=toInt(t.val())+1,e=t.attr("max");e&&(a=Math.min(a,toInt(e))),t.val(a),t.trigger("change")}),$(".ajax-form").submit(function(){return $.post($(this).attr("action"),$(this).serialize(),function(t){parseAjax(t)},"json"),!1});var autoRedirct=function(){var t=$(".autoRedirct");if(!(t.length<1)){var a=t.attr("href")||t.attr("data-url"),e=t.text(),n=toInt(t.attr("data-time"));n<1&&(n=3),t.text(e+"("+n+" 秒)");var r=setInterval(function(){n--,t.text(e+"("+n+" 秒)"),n<=0&&(clearInterval(r),t.text(e+"(正在跳转...)"),window.location.href=a)},1e3)}};autoRedirct()});