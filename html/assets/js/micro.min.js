function bindMicroPage(){$(".micro-publish").on("submit","form",function(){var t=$(this);return postJson(t.attr("action"),t.serialize(),function(t){200!=t.code?302!=t.code?parseAjax(t):window.location.href=t.url:window.location.reload()}),!1}).on("input propertychange","textarea",function(){var t=$(this),n=t.closest(".micro-publish").find(".tip"),e=t.val().length;n.toggle(0<e).find("em").text(e)}),$(".micro-item").on("click","[data-action=comment]",function(){var t=$(this).closest(".micro-item"),n=t.find(".comment-box").toggle();n.is(":hidden")||$.get(BASE_URI+"comment",{id:t.data("id")},function(t){n.html(t)})}).on("click","[data-action=recommend]",function(){var n=$(this),t=n.closest(".micro-item");$.getJSON(BASE_URI+"recommend",{id:t.data("id")},function(t){200==t.code&&n.text("赞"+(t.data&&0<t.data.recommend_count?t.data.recommend_count:"")).toggleClass("active",t.data.is_recommended),302!=t.code||(window.location.href=t.url)})}).on("click",'[data-action="dialog"]',function(t){t.preventDefault();var n=$(this),e=Dialog.box({url:n.attr("href"),title:"转发微博",hasYes:!1,hasNo:!1,ondone:function(){var t=this.find(".forward-box");postJson(t.attr("action"),t.serialize(),function(t){e.close(),parseAjax(t)})}})}).on("click",".reply-input .btn",function(t){t.preventDefault();var n=$(this),e=n.attr("href"),i=n.closest(".reply-input");i.find("textarea").val().trim().length<0||postJson(e,formData(i),function(t){200==t.code&&t.data.url&&$.get(t.data.url,function(t){n.closest(".comment-box").html(t)})})}).on("input propertychange",".reply-input textarea",function(){var t=$(this),n=t.val();t.height(18*n.split("\n").length),t.closest(".reply-input").find(".btn").toggleClass("btn-disable",n.length<1)}).on("click",'[data-type="reply"]',function(t){t.preventDefault();var n=$(this),e=n.closest(".actions");if(0<e.next(".reply-input").length)e.next(".reply-input").toggle();else{var i=n.attr("href"),a=n.attr("title");e.after('<div class="reply-input">\n        <div class="input">\n            <textarea name="content">'+a+':</textarea>\n        </div>\n        <div class="input-actions">\n            <div class="tools">\n                <i class="fa fa-smile"></i>\n                <i class="fa fa-image"></i>\n            </div>\n            <a class="btn" href="'+i+'">回复</a>\n        </div>\n    </div>')}})}