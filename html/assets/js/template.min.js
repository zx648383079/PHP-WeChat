var Panel=function(){function t(t,e){this.page=e,this.element=$(t),this._init()}return t.prototype._init=function(){this._bindEvent()},t.prototype._bindEvent=function(){var t=this;this.element.find(".panel .head .fa-close").click(function(){t.element.addClass("min")}),this.element.find(".menu>li>.head").click(function(){$(this).parent().toggleClass("active")})},t.prototype.bindDrag=function(){var o=this;this.element.find(".weight-grid").draggable({connectToSortable:".weight-row",helper:"clone",opacity:.3,revert:"invalid",start:function(){o.page.body.addClass("hover")},stop:function(t,e){o.page.body.removeClass("hover");var i=e.helper,n=i.closest(".weight-row");!n||n.length<1||o.page.addWeight(i,n)}})},t}(),Weight=function(){function t(t){this.box=t}return t.prototype.toggle=function(t){return this.box.toggleClass("weight-edit-mode",t),this},t.prototype.toggleLoading=function(t){return this.box.toggleClass("weight-loading",t),this},t}(),Page=function(){function t(){this.box=$("#page-box"),this.element=$("#mainMobile"),this.body=$("#mainGrid"),this._init()}return t.prototype._init=function(){this._bindEvent(),this.resize()},t.prototype._bindEvent=function(){var e=this;$(window).resize(function(){e.resize()}),this.body.find(".weight-row").sortable({connectWith:".weight-row"}),this.body.on("click",".del",function(){var e=$(this).parent().parent();$.post("/template/weight/destroy?id="+e.attr("data-id"),{},function(t){200==t.code&&e.remove()})}).on("click",".edit",function(t){t.stopPropagation(),e.setWeight($(this).parents(".weight-grid"))})},t.prototype.setWeight=function(t){return this.weight&&this.weight.toggle(!1),this.weight=new Weight(t),this.weight.toggle(!0),this.weight},t.prototype.addWeight=function(e,t){e.width("auto");var i=this.setWeight(e).toggleLoading(!0);$.post("/template/weight/create",{page:PAGE_ID,weight:e.attr("data-weight"),parent_id:t.attr("data-id")},function(t){i.toggleLoading(!1),200==t.code&&e.attr("data-id",t.data.id)},"json")},t.prototype.resize=function(){this.box.height($(window).height()-57)},t.prototype.html=function(){return $.htmlClean($("#mainGrid").html(),{format:!0,allowedAttributes:[["id"],["class"],["data-toggle"],["data-target"],["data-parent"],["role"],["data-dismiss"],["aria-labelledby"],["aria-hidden"],["data-slide-to"],["data-slide"]]})},t}();$(document).ready(function(){var e=new Page,t=new Panel("#weight",e);new Panel("#property",e);t.bindDrag(),$(".mobile-size li").click(function(){$(".mobile-size").parent().removeClass("open");var t=$(this).attr("data-size").split("*");e.element.removeClass().addClass("mobile-"+t[0])}),$(".navbar>li>div").click(function(){$(this).parent().toggleClass("open")}),$(".mobile-size li").click(function(){$(this).addClass("active").siblings().removeClass("active")}),$(".mobile-rotate").click(function(){e.element.toggleClass("rotate")}),$(".expand>.head").click(function(){$(this).parent().toggleClass("open")})});