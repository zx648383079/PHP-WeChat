var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,s=e.length;o<s;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))};function bindPage(n){function o(t,e,i){200==t.code?e&&e(t.data):(i&&i(t.message),Dialog.tip(t.message))}var e=new VisualEditor($("#page-box"));e.on(EditorEventGetWeights,function(e,i){$.getJSON(BASE_URI+"weight?id="+n,function(t){o(t,e,i)})}).on(EditorEventGetPage,function(e,i){$.getJSON(BASE_URI+"page/detail?id="+n,function(t){o(t,e,i)})}).on(EditorEventPageList,function(e,i){$.getJSON(BASE_URI+"page/search?id="+n,function(t){o(t,e,i)})}).on(EditorEventPageSetting,function(e,i){$.getJSON(BASE_URI+"page/setting?id="+n,function(t){o(t,e,i)})}).on(EditorEventSavePageSetting,function(t,e,i){postJson(BASE_URI+"page/save_setting","object"!=typeof t?t:__assign({id:n},t),function(t){o(t,e,i)})}).on(EditorEventWeightTree,function(e,i){$.getJSON(BASE_URI+"weight/search?id="+n,function(t){o(t,e,i)})}).on(EditorEventGetWeightProperty,function(t,e,i){$.getJSON(BASE_URI+"weight/setting?id="+t,function(t){o(t,e,i)})}).on(EditorEventWeightForm,function(t,e,i){$.getJSON(BASE_URI+"weight/form?id="+t,function(t){o(t,e,i)})}).on(EditorEventSaveWeightProperty,function(t,e,i,n){postJson(BASE_URI+"weight/save","object"!=typeof e?e:__assign({id:t},e),function(t){o(t,i,n)})}).on(EditorEventRefreshWeight,function(t,e,i){$.getJSON(BASE_URI+"weight/refresh?id="+t,function(t){o(t,e,i)})}).on(EditorEventAddWeight,function(t,e,i){postJson(BASE_URI+"weight/create",__assign({page_id:n},t),function(t){o(t,e,i)})}).on(EditorEventMoveWeight,function(t,e,i){postJson(BASE_URI+"weight/move",__assign({page_id:n},t),function(t){o(t,e,i)})}).on(EditorEventRemoveWeight,function(t,e,i){postJson(BASE_URI+"weight/destroy",{id:t},function(t){o(t,e,i)})}).on(EditorEventSavePage,function(t,e,i){postJson(BASE_URI+"weight/batch_save",{id:n,weights:t},function(t){o(t,function(t){e&&e(t),Dialog.tip("保存成功！")},i)})}),e.run(),$("body").addClass("full-edit-mode"),$(".mobile-size li").on("click",function(){var t=$(this),t=(t.addClass("active").siblings().removeClass("active"),t.closest(".mobile-size").parent().removeClass("open"),t.attr("data-size").split("*"));t.length<2||!t[0]||!t[1]?e.normal():e.mobile(parseInt(t[0]),parseInt(t[1]))}),$(".navbar>li>div").on("click",function(){$(this).parent().toggleClass("open")}),$(".mobile-rotate").on("click",function(){e.rotate()}),769<$(window).width()&&$(".sidebar-container-toggle").trigger("click")}function bindEdit(){$(".theme-select").on("click",".theme-item",function(){$(this).addClass("active").siblings().removeClass("active"),$("input[name=theme_id]").val($(this).data("id"))})}var SearchDailog=function(){function t(t){var e=this;this.selected=[],this._selected=[],this.dialog=$(t).dialog({}),$.get(this.dialog.box.data("url"),{selected:this.selected.join(",")},function(t){e.html(t)}),this.bindEvent()}return t.prototype.bindEvent=function(){var t=this,i=this;this.on("submit",".dialog-search form",function(){var t=$(this);return $.get(t.attr("action"),t.serialize()+"&selected="+i.selected.join(","),function(t){i.html(t)}),!1}).on("click",".dialog-body-box .item",function(){var t=$(this).toggleClass("selected"),e=parseInt(t.data("id"),10);i.toggleItem(e,t.hasClass("selected"))}).on("click",".dialog-pager a",function(t){t.preventDefault(),$.get($(this).attr("href"),function(t){i.html(t)})}),this.dialog.on("done",function(){t.selected=__spreadArray([],t._selected,!0),t.dialog.close(),t._doneCallback&&t._doneCallback.call(t,t.selected)})},t.prototype.toggleItem=function(t,e){var i;t<1||(i=this._selected.indexOf(t),(e=void 0===e?i<0:e)?i<0&&this._selected.push(t):0<=i&&(this._selected=this._selected.splice(i,1)))},t.prototype.html=function(t){return(0<t.indexOf("dialog-body-box")?this.find(".dialog-body"):this.find(".dialog-body .dialog-body-box")).html(t),this.dialog.resize(),this},t.prototype.find=function(t){return this.dialog.find(t)},t.prototype.on=function(t,e,i){return"done"===t?this._doneCallback=e:this.dialog.box.on(t,e,i),this},t.prototype.show=function(){var i=this;this._selected=__spreadArray([],this.selected,!0),this.find(".dialog-body-box .item").each(function(t,e){e=$(e);e.toggleClass("selected",0<=i._selected.indexOf(e.data("id")))}),this.dialog.show()},t}();function bindNewTheme(){var t=new SearchDailog(".theme-dialog");$('*[data-type="add"]').on("click",function(){t.show()}),t.on("done",function(t){})}