var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},__spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},EditorEventGetWeights="editor_get_wegihts",EditorEventGetWeightProperty="editor_get_wegiht_property",EditorEventSaveWeightProperty="editor_save_wegiht_property",EditorEventRefreshWeight="editor_refresh_weight",EditorEventAddWeight="editor_add_weight",EditorEventMoveWeight="editor_move_weight",EditorEventWeightForm="editor_weight_form",EditorEventRemoveWeight="editor_remove_weight",EditorEventSavePage="editor_save_page",EditorEventGetPage="editor_get_page",EditorEventPageList="editor_get_page_list",EditorEventWeightTree="editor_get_page_weight",EditorEventPageSetting="editor_get_page_setting",EditorEventSavePageSetting="editor_save_page_setting",EditorEventWindowResize="editor_Window_resize",EditorEventResize="editor_resize",EditorEventOuterWidthChange="editor_outer_width_change",EditorEventViewInit="editor_view_init",EditorEventGetStyleSuccess="editor_get_style_success",EditorEventAfterViewInit="editor_after_view_init",EditorEventBrowserResize="editor_browser_resize",EditorEventScroll="editor_scroll",EditorEventPositionChange="editor_position_change",EditorEventDragStart="editor_drag_start",EditorEventBrowserReady="editor_browser_ready",EditorEventOpenEditDialog="editor_open_edit_dialog",EditorEventOpenProperty="editor_open_property",EditorEventDrag="editor_drag",EditorEventDrog="editor_drog",EditorEventOperateWeight="editor_operate_weight",EditorEventMouseMove="editor_mouse_move",EditorEventMouseUp="editor_mouse_up",EditorEventTimeLoop="editor_time_loop",EditorMobileStyle="mobile-style",EditorEventInputChange="value:change",EditorEventInputReset="value:reset",EditorEventTabToggle="tab:toggle",EditorEventListEdit="list:edit",EditorEventFlipToggle="flip:toggle",EditorEventFlipFinish="flip:finish",EditorToolBar=(()=>{function t(t){var n=this;this.editor=t,this.scaleValue=100,this.editor.on(EditorEventViewInit,function(){var t=n.editor.find(".panel-tool-bar");n.scaleBar=t.find(".scale-text"),n.bindEvent(t)}).on(EditorEventPositionChange,function(t,e,i){n.scaleValue=i,n.scaleBar.text(i+"%")})}return t.prototype.bindEvent=function(t){var e=this;t.on("click",".fa-minus-circle",function(){e.scaleValue<30||e.editor.scale(e.scaleValue-10)}).on("click",".fa-plus-circle",function(){300<e.scaleValue||e.editor.scale(e.scaleValue+10)}).on("click",".fa-undo",function(){e.editor.rotate()}).on("click",".fa-expand",function(){e.editor.normal()}).on("click",".fa-expand-arrows-alt",function(){e.editor.reset()})},t})(),EditorWeightSoul=(()=>{function t(t){var l=this;this.editor=t,this.isNew=!1,this.editor.on(EditorEventViewInit,function(){l.box=l.editor.find(".await-widget-box")}).on(EditorEventDrag,function(t,e,i){var n=t.offset(),o=i.x-n.left,r=i.y-n.top,a=t.width(),s=t.height();l.target=t,l.isNew=e,l.box.html(t.prop("outerHTML")),l.editor.onMouse(function(t){l.target&&l.setBound(t.x-o,t.y-r,a,s)},function(t){var e;l.target&&((t=l.editor.browser.getElementByPoint(t))&&t[0]?(e=l.editor).emit.apply(e,__spreadArray([EditorEventDrog],t,!1)):l.reset())})}).on(EditorEventDrog,function(t,e){l.target&&(l.editor.emit(EditorEventOperateWeight,l.isNew,l.target,t,e),l.reset())})}return t.prototype.setBound=function(t,e,i,n){this.box.css({width:i+"px",height:n+"px",left:t+"px",top:e+"px"})},t.prototype.reset=function(){this.target&&(this.target=void 0,this.setBound(0,0,0,0))},t})(),EditorPropertyPanel=(()=>{function t(t){var e=this;this.editor=t,this.lastAt=0,this.isAsync=!1,this.editor.on(EditorEventAfterViewInit,function(){e.bindEvent()}).on(EditorEventGetStyleSuccess,function(t){e.renderStyle(t)}).on(EditorEventOpenProperty,function(t){e.saveSync(),e.box.find(".panel-header").trigger("click"),e.target=t,e.editor.emit(EditorEventGetWeightProperty,t.id(),function(t){e.editor.emit(EditorEventGetStyleSuccess,t.styles),e.lastAt=(new Date).getTime(),e.applyForm(t)})}).on(EditorEventTimeLoop,function(t){e.isAsync&&2e4<(t=t.getTime())-e.lastAt&&(e.saveSync(),e.lastAt=t)})}return t.prototype.bindEvent=function(){var t,e=this;this.box&&(EditorHtmlHelper.bindInputEvent((t=this).box,this),this.box.on(EditorEventInputChange,".control-inline-group,.control-line-group",function(){t.autoSave()}).on("click",".style-item",function(){$(this).addClass("active").siblings().removeClass("active"),t.autoSave()}).on("click",".reset-btn",function(){e.applyForm({}),e.autoSave()}))},t.prototype.saveSync=function(){var t,e=this;this.isAsync=!1,this.target&&((t=EditorHtmlHelper.formData(this.box)).style_id=EditorHelper.parseNumber(this.box.find(".style-item.active").attr("data-id")),t.id=this.target.id(),this.editor.emit(EditorEventSaveWeightProperty,this.target.id(),t,function(t){e.target.html(t.html)}))},t.prototype.autoSave=function(){this.isAsync=!0,this.lastAt=(new Date).getTime()},t.prototype.notify=function(t){this.autoSave()},t.prototype.render=function(){return this.box=$('<div class="panel-item min" data-panel="property"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">属性</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body">\n            <div class="tab-box">\n                    <div class="tab-header"><div class="tab-item active">\n                            普通\n                        </div><div class="tab-item">\n                            高级\n                        </div><div class="tab-item">\n                            样式\n                        </div></div>\n                    <div class="tab-body">\n                        <div class="tab-item active">\n                        </div>\n                        <div class="tab-item">\n                        <div class="expand-box open">\n                                <div class="expand-header">整体<span class="fa fa-chevron-right"></span></div>\n                                <div class="expand-body">\n                                    \n                                </div>\n                            </div>\n                            <div class="expand-box">\n                                <div class="expand-header">标题<span class="fa fa-chevron-right"></span></div>\n                                <div class="expand-body">\n                                    \n                                </div>\n                            </div>\n                            <div class="expand-box">\n                                <div class="expand-header">内容<span class="fa fa-chevron-right"></span></div>\n                                <div class="expand-body">\n                                    \n                                </div>\n                            </div>\n                        </div>\n                        <div class="tab-item style-panel">\n                            <div class="style-item" data-id="0">\n                                无\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '),this.box},t.prototype.renderStyle=function(t){t=EditorHtmlHelper.mapJoinHtml(t,function(t){return'<div class="style-item" data-id="'.concat(t.id,'">\n            <img src="').concat(t.thumb,'" alt="').concat(t.name,'">\n        </div>')});this.box.find(".style-panel").html('<div class="style-item" data-id="0">无</div>'.concat(t))},t.prototype.show=function(){this.box.removeClass("min")},t.prototype.hide=function(){this.box.addClass("min")},t.prototype.applyForm=function(e){var t=this.box.find(".tab-body .tab-item");t[0].innerHTML=EditorHtmlHelper.render(e.form.basic)+EditorHtmlHelper.buttonGroup(EditorHtmlHelper.button("重置","reset-btn")),t[1].innerHTML=EditorHtmlHelper.render(e.form.style),this.box.find(".style-item").each(function(){var t=$(this);t.toggleClass("active",t.attr("data-id")==e.style_id)}),EditorHtmlHelper.readyControl(t,this)},t})(),EditorBrowser=(()=>{function t(t){var o=this;this.editor=t,this.frameScale=100,this.shellVisbile=!1,this.editor.on(EditorEventViewInit,function(){o.shellTimeBar=o.editor.find(".shell-bar .time"),o.shell=o.editor.find(".work-container"),o.frame=o.editor.find(".panel-main"),o.bindEvent()}).on(EditorEventScroll,function(t,e){e?o.bound.left=-t:o.bound.top=-t,o.renderTransform(),o.editor.emit(EditorEventPositionChange,o.bound.left,o.bound.top,o.frameScale)}).on(EditorEventResize,function(){o.bound&&o.resize(o.bound.width,o.bound.height)}).on(EditorEventDragStart,function(t){o.dragWeight=t}).on(EditorEventTimeLoop,function(t){o.shellVisbile&&o.shellTimeBar.text([t.getHours(),t.getMinutes()].map(EditorHelper.twoPad).join(":"))}).on(EditorEventOperateWeight,function(t,e,i,n){o.dragWeight=void 0,t?(o.selectedWeight=new EditorWeight(o.editor,e.clone()),o.selectedWeight.appendTo(i,n)):(o.selectedWeight=new EditorWeight(o.editor,e),o.selectedWeight.moveTo(i,n))})}return t.prototype.bindEvent=function(){var e=this;this.frame.on("load",function(){var t=e.frame.contents();e.frameBody=t.find("body"),e.editor.emit(EditorEventBrowserReady,t),e.bindFrameEvent()})},t.prototype.bindFrameEvent=function(){function e(t,e){i.dragWeight?(i.selectedWeight=new EditorWeight(i.editor,i.dragWeight.clone()),i.selectedWeight.appendTo(t,e)):i.selectedWeight&&i.selectedWeight.moveTo(t,e)}var i=this;this.frameBody.on("dragover",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault()}).on("drop",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault(),e($(this))}).on("mouseup",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault(),i.editor.emit(EditorEventDrog,$(this))}).on("mouseup",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault();t=$(this);i.editor.emit(EditorEventDrog,t.closest(".visual-edit-row"),t)}).on("touchend",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault(),i.editor.emit(EditorEventDrog,$(this))}).on("touchend",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault();t=$(this);i.editor.emit(EditorEventDrog,t.closest(".visual-edit-row"),t)}).on("dragover",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault()}).on("drop",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault();t=$(this);e(t.closest(".visual-edit-row"),t)}).on("dragstart",".visual-edit-control",function(t){t.originalEvent.dataTransfer.setData("Text",t.target.id),i.selectedWeight=new EditorWeight(i.editor,$(this))}).on("dragend",".visual-edit-control",function(){$(this).attr("draggable","false")}).on("mousedown",".visual-action .drag",function(t){t.stopPropagation(),i.dragWeight=void 0;var e=$(this).closest(".visual-edit-control");i.editor.emit(EditorEventDrag,e,!1,{x:t.clientX,y:t.clientY})}).on("touchstart",".visual-action .drag",function(t){t.stopPropagation(),t.preventDefault(),i.dragWeight=void 0;var e=$(this).closest(".visual-edit-control");i.editor.emit(EditorEventDrag,e,!1,{x:t.touches[0].clientX,y:t.touches[0].clientY})}).on("click",".visual-action .del",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapRemove()}).on("click",".visual-action .edit",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapEdit()}).on("click",".visual-action .refresh",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapRefresh()}).on("click",".visual-action .property",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapProperty()}).on("click","a",function(t){t.preventDefault()})},t.prototype.globePosition=function(t){var e=this.frame.offset();return{x:t.x+e.left,y:t.y+e.top}},t.prototype.framePosition=function(t){var e=this.frame.offset();return{x:t.x-e.left,y:t.y-e.top}},t.prototype.getElementByPoint=function(t){var i=this.framePosition(t);if(i.x<0||i.y<0||i.x>this.frame.width()||i.y>this.frame.height())return[void 0,void 0];for(var e,n=function(t){var e=t.offset();return!(e.left>i.x||e.top>i.y)&&e.left+t.width()>i.x&&e.top+t.height()>i.y},o=void 0,r=this.frameBody;"break"!==(()=>{var e=!1;if(r.find(".visual-edit-row").each(function(){var t=$(this);if(n(t))return r=o=t,!(e=!0)}),!e)return"break"})(););return o?(e=void 0,o.find(".visual-edit-control").each(function(){var t=$(this);if(n(t))return e=t,!1}),[o,e]):[void 0,void 0]},t.prototype.toggleShell=function(t){this.shellVisbile=t,this.shell.toggleClass(EditorMobileStyle,t)},t.prototype.rotate=function(){this.resize(this.bound.height,this.bound.width)},t.prototype.scale=function(t){this.frameScale=t,this.renderTransform(),this.emitRealSize(),this.editor.emit(EditorEventPositionChange,this.bound.left,this.bound.top,this.frameScale)},t.prototype.renderTransform=function(){var t=[];100!==this.frameScale&&t.push("scale("+this.frameScale/100+")"),0===this.bound.left&&0===this.bound.top||t.push("translate(".concat(this.bound.left,"px, ").concat(this.bound.top,"px)")),this.shell.css("transform",t.join(" "))},t.prototype.resize=function(t,e,i,n,o){var r=this.editor.innerWidth,a=this.editor.innerHeight;i||n||(t=r<=(i=t)?0:(r-i)/2,e=a<=(n=e)?0:(a-n)/2),this.shell.css({width:i+"px",height:n+"px",transform:"translate(".concat(t,"px, ").concat(e,"px)")}),this.bound={left:t,top:e,height:n,width:i},o&&(this.frameScale=o,this.renderTransform()),this.emitRealSize(),this.editor.emit(EditorEventPositionChange,t,e,this.frameScale)},t.prototype.emitRealSize=function(){var t=this.editor.innerWidth,e=this.editor.innerHeight,i=this.frameScale/100;this.editor.emit(EditorEventBrowserResize,this.bound.left*i,this.bound.top*i,this.bound.width*i,this.bound.height*i,t,e)},t.prototype.reset=function(){this.resize(this.bound.width,this.bound.height,0,0,100)},t.prototype.navigate=function(t){this.frame.attr("src",t)},t.prototype.reload=function(){this.frame[0].contentWindow.location.reload()},t.prototype.navigateString=function(t){this.frame.attr("src","data:text/html;charset=utf-8,"+encodeURI(t))},t.prototype.serialize=function(){var o;return this.frameBody?(o=[],this.frameBody.find(".visual-edit-row").each(function(){var t=$(this),i=t.attr("data-id"),n=t.attr("data-index");t.children(".visual-edit-control").each(function(t){var e=$(this);o.push({id:e.attr("data-id"),parent_id:i,parent_index:n,position:t+1})})}),o):[]},t})(),EditorDialog=(()=>{function t(t){var i=this,n=(this.editor=t,this);this.editor.on(EditorEventViewInit,function(){var t=i.editor.find(".editor-dialog");i.innerForm=t.find(".dialog-body"),i.box=t.dialog(),i.bindEvent(),i.box.on("done",function(){i.editor.emit(EditorEventSaveWeightProperty,i.target.id(),EditorHtmlHelper.formData(t.find(".dialog-body")),function(t){n.editor.emit(EditorEventOpenProperty,n.target),n.target.html(t.html)}),i.box.close()})}).on(EditorEventOpenEditDialog,function(t){i.target=t,i.editor.emit(EditorEventWeightForm,t.id(),function(t){var e=i.box.find(".dialog-body");e.html(EditorHtmlHelper.render(t.form)),i.box.showCenter(),EditorHtmlHelper.readyControl(e,n)})})}return t.prototype.bindEvent=function(){EditorHtmlHelper.bindInputEvent(this.box.box,this)},t.prototype.notify=function(t){},t})(),EditorPanelGroup=(()=>{function t(t){var n=this;this.editor=t,this.children=[new EditorWeightPanel(this.editor),new EditorPropertyPanel(this.editor),new EditorLayerPanel(this.editor),new EditorPagePanel(this.editor),new EditorSettingPanel(this.editor)],this.renderedChildren=[],this.visible=!0,this.editor.on(EditorEventViewInit,function(){n.box=n.editor.find(".panel-group");for(var t=0,e=n.children;t<e.length;t++){var i=e[t];n.onRender(i)}}).on(EditorEventAfterViewInit,function(){n.bindEvent()}).on(EditorEventResize,function(){for(var t=n.box.height(),e=0,i=n.renderedChildren;e<i.length;e++)i[e].target.find(".panel-body").height(t-36)})}return t.prototype.bindEvent=function(){var r=this;this.box.on("click",".panel-item .panel-header .fa-close",function(t){t.stopPropagation();for(var e=$(this).closest(".panel-item"),i=0,n=r.renderedChildren;i<n.length;i++){var o=n[i];r.isSame(o.target,e)&&o.control.hide()}r.toggle(!1)}).on("click",".panel-header",function(){var t=$(this).closest(".panel-item");if(t.hasClass("min")){for(var e=0,i=r.renderedChildren;e<i.length;e++){var n=i[e];r.isSame(n.target,t)?n.control.show():n.control.hide()}r.toggle(!0)}}).on("click",".expand-box .expand-header",function(){$(this).closest(".expand-box").toggleClass("open")})},t.prototype.toggle=function(t){this.visible!==t&&(this.box.toggleClass("min",!t),this.visible=t,this.editor.emit(EditorEventResize,this.editor.innerWidth,this.editor.innerHeight))},t.prototype.add=function(t){this.children.push(t),this.onRender(t)},t.prototype.onRender=function(t){var e;this.box&&(this.children.indexOf(t),e=t.render(),this.box.append(e),e.addClass("panel-item"),0<this.renderedChildren.length?t.hide():t.show(),this.renderedChildren.push({target:e,control:t}))},t.prototype.isSame=function(t,e){return t.is(e)},t})(),EditorHelper=(()=>{function n(){}return n.twoPad=function(t){return t<10&&0<=t?"0"+t:t.toString()},n.parseNumber=function(t){return!t||isNaN(t)?0:"number"==typeof t?t:"boolean"==typeof t?t?1:0:(t=0<(t=0<(t="string"!=typeof t?t.toString():t).indexOf(",")?t.replace(/,/g,""):t).indexOf(".")?parseFloat(t):parseInt(t,10),isNaN(t)?0:t)},n.checkRange=function(t,e,i){return void 0===i&&(i=100),t<(e=void 0===e?0:e)?e:e<i&&i<t?i:t},n.cloneObject=function(t){if("object"!=typeof t)return t;if(t instanceof Array)return t.map(function(t){return n.cloneObject(t)});var e,i={};for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=n.cloneObject(t[e]));return i},n.eachObject=function(t,e){if("object"!=typeof t)return e(t,void 0);if(t instanceof Array){for(var i=0;i<t.length;i++)if(!1===e(t[i],i))return!1}else for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!1===e(t[n],n))return!1},n})(),EditorHtmlHelper=(()=>{function t(){}return t.guid=function(){return this._guid++},t.shimmed=function(t){return t=t||this.guid(),'_zreinput="'.concat(t,'"')},t.getShimmed=function(t){return t instanceof HTMLElement?t.getAttribute("_zreinput"):t.attr("_zreinput")},t.selector=function(){return'[_zreinput^=""]'},t.clear=function(){this._cacheData={}},t.set=function(t,e){return this._cacheData[t]=e,t},t.get=function(t){return this._cacheData[t]},t.value=function(t,e){return void 0===e&&(e=""),null==t?e:t},t.join=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.map(function(t){return e.value(t)}).join("")},t.mapJoinHtml=function(t,i){var n="";return EditorHelper.eachObject(t,function(t,e){n+=i(t,e)}),n},t.buttonGroup=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.join.apply(this,__spreadArray(__spreadArray(['<div class="btn-group control-offset">'],t,!1),["</div>"],!1))},t.button=function(t,e){return'<button type="button" class="btn '.concat(e,'">').concat(t,"</button>")},t.nameToId=function(t){return t.replace(/\[/g,"_").replace(/\]/g,"")},t.renderAttribute=function(t){var i;if(t&&t.option)return i=[],EditorHelper.eachObject(t.option,function(t,e){"string"==typeof e&&0===e.indexOf("data-")&&i.push("".concat(e,'="').concat(t,'"'))}),i.join(" ")},t.renderClass=function(t,e){var i,n;if(void 0===e&&(e=!0),t)return i=[],t.class&&i.push(t.class),null!=(n=t.option)&&n.tab&&i.push(t.option.tab),t.hidden&&i.push("hidden"),0===i.length?"":(n=i.join(" "),e?' class="'.concat(n,'"'):n)},t.isHiddenTab=function(t,e){for(var i=0,n=e;i<n.length;i++){var o=n[i];if(0===t.indexOf(o.tab))return t!==o.match}return!1},t.render=function(t){return this.renderControlItems(t).map(function(t){return t.render()}).join("")},t.renderControlItems=function(t){for(var e,i=[],n=0,o=t;n<o.length;n++){var r=o[n];r.option&&(r.option["data-tab"]?i.push({tab:r.option["data-tab"],match:r.option["data-tab"]+"-"+(null!=(e=r.value)?e:r.items[0].value)}):r.option.tab&&(r.hidden=this.isHiddenTab(r.option.tab,i)))}return t.map(this.renderControl.bind(this))},t.formData=function(t,e){function i(t){t.children().each(function(){var t=this.nodeName.toLowerCase();if(["input","textarea","select"].indexOf(t))return(!(this.type&&0<=["radio","checkbox"].indexOf(this.type))||this.checked)&&this.name?(t=o&&0===this.name.indexOf(o)?this.name.substring(o.length):this.name,e?void(r[t]=$(this).val()):void r.push(encodeURIComponent(t)+"="+encodeURIComponent($(this).val().toString()))):void 0;this.classList.contains("panel-item")?i($(this).find(".tab-body .tab-item")):this.classList.contains("expand-box")?i($(this).children(".expand-body")):(t=n.getShimmed(this))&&(t=n.get(t),e?r[t.name]=t.value:r.push(encodeURIComponent(t.name)+"="+encodeURIComponent("object"==typeof t.value?JSON.stringify(t.value):n.value(t.value))))})}var n=this,o="string"==typeof(e=void 0===e?!0:e)?e:"",r=(e="string"==typeof e||e)?{}:[];return i(t),e?r:r.join("&")},t.renderForm=function(t,e){var i=this;return this.render(t.map(function(t){return __assign(__assign({},t),{value:i.inputValue(e,t.name)})}))},t.inputValue=function(t,e){return"object"==typeof t&&e&&(Object.prototype.hasOwnProperty.call(t,e)||0===e.indexOf("item_")&&(e=e.substring(5),Object.prototype.hasOwnProperty.call(t,e)))?t[e]:void 0},t.renderControl=function(t){var e=this.guid(),i=t.name+"_"+e,n={group:EditorGroupControl,align:EditorAlignControl,border:EditorBorderControl,textAlign:EditorTextAlignControl,color:EditorColorControl,background:EditorBackgroundControl,icon:EditorIconControl,number:EditorNumberControl,textarea:EditorTextareaControl,code:EditorTextareaControl,size:EditorSizeControl,range:EditorRangeControl,position:EditorPositionControl,bound:EditorBoundControl,switch:EditorSwitchControl,image:EditorImageControl,images:EditorImagesControl,multiple:EditorMultipleControl,tree:EditorTreeControl,html:EditorHtmlControl,text:EditorTextControl,select:EditorSelectControl,shadow:EditorShadowControl,typography:EditorTypographyControl,mask:EditorMaskControl,animation:EditorAnimationControl,radio:EditorRadioControl};return(n=n[t.type]?new n[t.type](t):"function"==typeof(n=this[t.type+"Execute"])?n.call(this,t,i):new EditorTextControl(t)).shimmed=t.type+e,n.label=t.label,n.tooltip=t.tip,n.value||(n.value=t.value),n.name=t.name,this.set(n.shimmed,n),n},t.readyControl=function(t,i){this.controlNodes(t,function(t,e){e.ready(t,i)})},t.controlNodes=function(t,e){function i(t){t.children().each(function(){var t;this.classList.contains("panel-item")?i($(this).find(".tab-body .tab-item")):this.classList.contains("expand-box")?i($(this).children(".expand-body")):(t=n.getShimmed(this))&&(t=n.get(t))&&e($(this),t)})}var n=this;i(t)},t.bindInputEvent=function(t,e){var r=this;t.on("click",".number-control-container .action-plus",function(){var t=$(this).closest(".number-control-container").find("input");t.val(EditorHelper.parseNumber(t.val())+1).trigger("change")}).on("click",".number-control-container .action-minus",function(){var t=$(this).closest(".number-control-container").find("input");t.val(EditorHelper.parseNumber(t.val())-1).trigger("change")}).on("click",".control-popup-target",function(){var t=$(this),e=t.next(".control-popup");0<t.closest(".dialog-box").length&&e.toggleClass("popup-top",t.offset().top+t.height()>window.innerHeight-e.height()),e.toggleClass("open")}).on(EditorEventInputChange,".control-popup-target",function(t,e){t.stopPropagation(),$(this).closest(".control-inline-group").trigger(EditorEventInputChange,e),$(this).find("input").val(e)}).on(EditorEventInputChange,".control-popup",function(t,e){t.stopPropagation(),$(this).prev(".control-popup-target").trigger(EditorEventInputChange,e)}).on(EditorEventInputReset,".control-popup-target",function(t){t.stopPropagation(),$(this).find("input").val("")}).on(EditorEventInputReset,".control-popup",function(t){t.stopPropagation(),t.target===this&&("color"===(t=$(this)).data("popup")?t.find(".tab-bar-target input").val(""):t.children(".control-inline-group,.control-line-group").children("label").next().trigger(EditorEventInputReset))}).on("click",".control-popup .popup-action .btn",function(){var t=$(this);t.hasClass("btn-danger")&&t.closest(".control-popup").siblings(".control-updated-tag").trigger("click")}).on("click",".tab-bar .item",function(){var t=$(this);t.addClass("active").siblings().removeClass("active"),t.closest(".tab-bar").siblings(".tab-bar-target").removeClass("active").eq(t.index()).addClass("active")}).on(EditorEventInputReset,".control-row",function(t){$(t.target).hasClass("control-row")&&$(this).children().trigger(EditorEventInputReset)}).on("change","select",function(){var t=$(this),e=t.val(),i=t.closest(".control-inline-group");i.trigger(EditorEventInputChange,e),t.data("tab")&&i.trigger(EditorEventTabToggle,[t.data("tab"),e])}).on(EditorEventInputReset,"select",function(t){t.stopPropagation(),$(this).val("")}).on(EditorEventTabToggle,".control-inline-group,.control-line-group",function(t,i,e){var n="".concat(i,"-").concat(e);$(this).siblings().each(function(){for(var t=0;t<this.classList.length;t++){var e=this.classList[t];if(0===e.indexOf(i)){$(this).toggleClass("hidden",e!==n);break}}})}).on(EditorEventInputChange,".control-inline-group,.control-line-group",function(t){t.stopPropagation();var t=$(this),e=r.get(r.getShimmed(this));t.find(".control-updated-tag:first").toggleClass("hidden",!e.isUpdated)}).on("click",".control-updated-tag",function(){var t=$(this);r.get(r.getShimmed(t.parent())).reset(),t.addClass("hidden")}).on("click",".multiple-container .multiple-control-header",function(){$(this).closest(".multiple-control-item").toggleClass("open").siblings().removeClass("open")}).on("click",".flip-container .flip-back-btn",function(){$(this).closest(".flip-container").trigger(EditorEventFlipFinish,!1)}).on("click",".flip-container .flip-save-btn",function(){$(this).closest(".flip-container").trigger(EditorEventFlipFinish,!0)}).on(EditorEventFlipToggle,".flip-container",function(t,i){var n=$(this),o=(n.addClass("flip-toggle"),n.find(".flip-body"));n.one(EditorEventFlipFinish,function(t,e){n.removeClass("flip-toggle"),e&&i(r.formData(o,"item_")),o.empty()})})},t._guid=0,t._cacheData={},t})(),EditorSwitchElement=(()=>{function t(t,e,i){void 0===e&&(e="开启"),void 0===i&&(i="关闭"),this._value=t=void 0===t?0:t,this.onLabel=e,this.offLabel=i}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.element)&&this.element.toggleClass("checked",0<this._value)},enumerable:!1,configurable:!0}),t.prototype.render=function(){return EditorHtmlHelper.join('<div class="switch-input',0<this.value?" checked":"",'"><span class="switch-control"></span><span class="switch-label">',0<this.value?this.onLabel:this.offLabel,"</span></div>")},t.prototype.ready=function(t,i){var n=this;(this.element=t).on("click",function(){var t=$(this),e=!t.hasClass("checked");t.toggleClass("checked",e),t.find(".switch-label").text(e?n.onLabel:n.offLabel),n.value=e?1:0,i.notify(n)})},t})(),EditorNumberElement=(()=>{function t(t,e,i,n){void 0===n&&(n=1),this._value=t,this.min=e,this.max=i,this.step=n}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){void 0!==t&&(t=EditorHelper.parseNumber(t)),this._value!==t&&(this._value=t,this.element)&&this.element.find("input").val(void 0===this._value?"":this._value)},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){return EditorNumberControl.numberInput(void 0===this._value?"":this._value)},t.prototype.ready=function(t,e){var i=this;(this.element=t).on("click",".action-plus",function(){i.value=EditorHelper.parseNumber(this._value)+i.step,e.notify(i)}).on("click",".action-minus",function(){i.value=EditorHelper.parseNumber(this._value)-i.step,e.notify(i)}).on("change","input",function(){var t=this.value;i._value=void 0===t||""===t?void 0:EditorHelper.parseNumber(t),e.notify(i)})},t})(),EditorSizeElement=(()=>{function t(t,e){void 0===t&&(t=""),this.label=e,this._unit="px",this.format(t)}return Object.defineProperty(t.prototype,"value",{get:function(){return{value:this._value,unit:this._unit}},set:function(t){this.format(t),this.element&&(this.element.find(".control-body .number-control-container input").val(void 0===this._value?"":this._value),this.element.find(".control-body .extra-control").val(this._unit))},enumerable:!1,configurable:!0}),t.prototype.format=function(t){var e;t?"object"==typeof t?(t.value||t.unit)&&(this._value=t.value,this._unit=t.unit):(e=(t=t.toString().trim()).match(/[\d\.]+/))?(this._value=EditorHelper.parseNumber(e[0]),(t=t.substring(e.index+e[0].length))&&(this._unit=t)):this._value=void 0:this._value=void 0},t.prototype.render=function(){var t=EditorNumberControl.numberInput(void 0===this._value?"":this._value);return'<div class="select-with-control">'+(this.label?'<div class="control-body">\n        <label for="">'.concat(this.label,"</label>\n        ").concat(t,'\n        <input class="extra-control" value="').concat(this._unit,'" spellcheck="false">\n    </div>'):'<div class="control-body">\n    <input class="extra-control" value="'.concat(this._unit,'" spellcheck="false">\n    ').concat(t,"\n</div>"))+EditorSelectControl.selectOptionBar(["px","em","rem","vh","vw","%","auto","none"])+"</div>"},t.prototype.ready=function(t,i){var n=this;(this.element=t).on("change",".control-body .number-control-container input",function(){var t=this.value;n._value=void 0===t||""===t?void 0:EditorHelper.parseNumber(t),i.notify(n)}).on("click",".control-body .extra-control",function(){$(this).closest(".select-with-control").toggleClass("select-focus")}).on("select:change",".select-option-bar",function(t,e){e=$(e);n._unit=e.text(),e.closest(".select-with-control").removeClass("select-focus").find(".control-body .extra-control").val(n._unit),i.notify(n)}).on("click",".select-option-bar .option-item",function(){var t=$(this);t.addClass("selected").siblings().removeClass("selected"),t.closest(".select-option-bar").trigger("select:change",this)})},t})(),EditorBoundElement=(()=>{function t(t,e){void 0===e&&(e=["上","右","下","左"]),this._value=t=void 0===t?[]:t,this.columns=e,this.items=[]}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(i){this._value!==i&&(this._value=i,this.items.forEach(function(t,e){t.value=i[e]}))},enumerable:!1,configurable:!0}),t.prototype.render=function(){var i=this,t=(this.items=this.columns.map(function(t,e){return new EditorSizeElement(i.value[e],t)}),this.items.map(function(t){return t.render()}).join(""));return'<div class="control-row">'.concat(t,"</div>")},t.prototype.ready=function(t,e){var i=this,n=(this.manager=e,t.find(".select-with-control"));this.items.forEach(function(t,e){t.ready(n.eq(e),i)})},t.prototype.notify=function(t){this._value=this.items.map(function(t){return t.value}),this.manager.notify(this)},t})(),EditorCheckElement=(()=>{function t(t,e,i){void 0===i&&(i=!1),this._value=t,this.items=e,this.multiple=i}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){var e;this._value!==t&&(this._value=t,this.element)&&(e=this.selectedIndex,this.element.children(".radio-control-item").each(function(t){$(this).toggleClass("checked",0<=e.indexOf(t))}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedIndex",{get:function(){for(var t=[],e=0;e<this.items.length;e++){var i=this.items[e];this.isSelected(i)&&t.push(e)}return t},enumerable:!1,configurable:!0}),t.prototype.isSelected=function(t){return this.multiple?t.value===this._value||this._value instanceof Array&&0<=this._value.indexOf(t.value):t.value===this._value},t.prototype.render=function(){var n=this;return EditorHtmlHelper.join.apply(EditorHtmlHelper,__spreadArray(__spreadArray(['<div class="control-row">'],this.items.map(function(t,e){var i=n.isSelected(t)?" checked":"";return'<span class="radio-control-item'.concat(i,'" data-value="').concat(t.value,'">').concat(t.name,"</span>")}),!1),["</div>"],!1))},t.prototype.ready=function(t,i){this.element=t;var n=this;t.on("click",".radio-control-item",function(){var t=$(this),e=!t.hasClass("checked");(n.multiple||e)&&(t.toggleClass("checked",e),!n.multiple&&e&&t.siblings().removeClass("checked"),n.tapItem(t.index()),i.notify(n))})},t.prototype.tapItem=function(t){var e,t=this.items[t].value;this.multiple?this._value?0<=(e=this._value.indexOf(t))?this._value.splice(e,1):this._value.push(t):this._value=[t]:this._value=t},t})(),EditorSelectElement=(()=>{function o(t,e,i,n,o,r,a){void 0===e&&(e=[]),void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===o&&(o="fa-angle-down"),void 0===r&&(r=!1),this._value=t,this.items=e,this.editable=i,this.searchable=n,this.arrow=o,this.multiple=r,this.placeholder=a}return Object.defineProperty(o.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.element)&&(this.element[0]instanceof HTMLInputElement?this.element.val(t):this.element.text(t))},enumerable:!1,configurable:!0}),o.prototype.render=function(){var t=this.multiple?"":this.value,t=this.editable?'<input type="text" class="input-body"  value="'.concat(t,'">'):'<span class="input-body">'.concat(t,"</span>");return this.multiple?t='<div class="selected-container"></div>'+t:t+='<div class="input-clear">\n            <i class="fa fa-close"></i>\n        </div>',EditorHtmlHelper.join('<div class="select-control-container">','<div class="select-input-container">\n            '.concat(t,'\n            <div class="input-arrow">\n                <i class="fa ').concat(this.arrow,'"></i>\n            </div>\n        </div>'),EditorSelectControl.selectOptionBar(this.items,this.value,this.searchable),"</div>")},o.prototype.ready=function(t,i){var n=this;this.element=t.find(".input-body"),t.on("change",".input-body",function(){var t=$(this),e=this instanceof HTMLInputElement?this.value:t.text();t.next(".input-clear").toggle(!!e),t.closest(".select-control-container").find(".select-option-bar .option-item").each(function(){var t=$(this);t.toggleClass("selected",e===t.data("value"))}),n.value=e,i.notify(n)}).on("click",".selected-container .item-close",function(){$(this).closest(".selected-item").remove()}).on("click",".input-clear",function(){var t=$(this).prev(".input-body");t[0]instanceof HTMLInputElement?t.val(""):t.text(""),t.trigger("change")}).on("click",".input-arrow",function(){$(this).closest(".select-control-container").toggleClass("select-focus")}).on("select:change",".select-option-bar",function(t,e){var e=$(e),i=e.closest(".select-control-container").removeClass("select-focus"),e=e.data("value");n.multiple?i.find(".selected-container").append(o.multipleSelectedItem(e)):((i=i.find(".input-body"))[0]instanceof HTMLInputElement?i.val(e):i.text(e),i.trigger("change"))}).on("click",".select-option-bar .option-item",function(){var t=$(this);t.addClass("selected").siblings().removeClass("selected"),t.closest(".select-option-bar").trigger("select:change",this)})},o.multipleSelectedItem=function(t){return'<div class="selected-item"><span class="item-close">&times;</span><div class="item-label">'.concat(t,"</div></div>")},o})(),EditorInputElement=(()=>{function t(t,e,i){void 0===i&&(i=!0),this.shimmed=t,this.label=e,this.inline=i}return t.prototype.render=function(){return t.inputGroup(this,"",this.inline)},t.prototype.ready=function(t,e){(this.element=t).on("click",".control-updated-tag",function(){var t=$(this);t.next().next().trigger(EditorEventInputReset).next(".control-popup").trigger(EditorEventInputReset),t.addClass("hidden")})},t.inputGroup=function(t,e,i){void 0===i&&(i=!0);var n='<label for="'.concat(t.shimmed,'">').concat(t.label,"</label>\n        ").concat(e);return i?(i=t.label?"":" control-inline-not-label",0<e.indexOf("control-popup-target")&&(i+=" control-inline-popup-group"),this.inputOutline(t,'<div class="control-inline-group'.concat(i,'">\n        ').concat(n,"\n    </div>"))):this.inputOutline(t,n)},t.inputSideGroup=function(t,e,i){return void 0===i&&(i=""),this.inputOutline(t,'<div class="control-inline-group">\n        <div class="side-label"><label for="'.concat(t.shimmed,'">').concat(t.label,"</label>").concat(i,"</div>\n        ").concat(e,"\n    </div>"))},t.inputOutline=function(t,e){var i="object"==typeof t&&t.isUpdated?"":" hidden";return"<div ".concat(EditorHtmlHelper.shimmed(t.shimmed),' class="control-line-group"><i class="control-updated-tag').concat(i,'"></i>\n        ').concat(e,"\n        ").concat(this.inputTooltip(t.tooltip),"\n        </div>")},t.inputTooltip=function(t){return t?'<div class="control-tooltip">'.concat(t,"</div>"):""},t})(),EditorTextControl=(()=>{function t(t){this.items=[],this._value="",t.items&&(this.items=t.items)}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=void 0===t?"":t,this.control?this.control.value=this._value:this.element&&this.element.find("input").val(this._value))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!!this._value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=""},t.prototype.render=function(){var t=0<this.items.length?(this.control=new EditorSelectElement(this.value,this.items,!0,!1,"fa-bolt"),this.control.render()):'<input class="form-control" value="'.concat(this.value,'">');return EditorInputElement.inputGroup(this,t,!1)},t.prototype.ready=function(t,e){var i;this.manager=e,this.element=t,this.control?this.control.ready(t.find(".select-control-container"),this):(i=this,t.on("change","input",function(){i._value=this.value,e.notify(i)}))},t.prototype.notify=function(t){this._value=this.control.value,this.element.trigger(EditorEventInputChange),this.manager.notify(this)},t})(),EditorTextAlignControl=(()=>{function t(){}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.control)&&(this.control.value=this._value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!!this.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=""},t.prototype.render=function(){return this.control=EditorAlignControl.horizontalAlign(this.value,!0),EditorInputElement.inputGroup(this,this.control.render(),!1)},t.prototype.ready=function(t,e){this.element=t,this.manager=e,this.control.ready(t.find(".control-row"),this)},t.prototype.notify=function(t){this._value=this.control.value,this.element.trigger(EditorEventInputChange),this.manager.notify(this)},t})(),EditorRangeControl=(()=>{function t(t){this.input=t,this.default=null!=(t=this.input.default)?t:this.input.min}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.element)&&this.element.find("select").val(this.value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return this.value&&this.value!==this.default},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=this.default},t.prototype.render=function(){for(var t=[],e=this.input.min;e<=this.input.max;e+=this.input.step)t.push({name:e,value:e});return EditorInputElement.inputGroup(this,EditorSelectControl.selectControl(this.shimmed,this.name,t,this.value,this.input))},t.prototype.ready=function(t,e){this.element=t;var i=this;t.on("change","select",function(){i._value=$(this).val(),e.notify(this),t.trigger(EditorEventInputChange)})},t})(),EditorHtmlControl=(()=>{function t(){}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=void 0===t?"":t,this.element)&&(this.element.container.value=this._value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!!this.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this._value=""},t.prototype.render=function(){return EditorInputElement.inputGroup(this,"<textarea>".concat(this.value,"</textarea>"),!1)},t.prototype.ready=function(t,e){var i=this;this.element=t.find("textarea").editor(),this.element.container.on("change",function(){i._value=i.element.container.value})},t})(),EditorSelectControl=(()=>{function e(t){this.input=t}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.control?this.control.value=this.value:this.element&&this.element.find("select").val(this.value))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUpdated",{get:function(){return this.value&&this.value!==this.input.items[0].value},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.value=this.input.items[0].value},e.prototype.render=function(){var t=this.input.search||this.input.multiple||!this.input.items?(this.control=new EditorSelectElement(this.value,this.input.items,!1,this.input.search,void 0,this.input.multiple),this.control.render()):e.selectControl(this.shimmed,this.input.name,this.input.items,this.input.value,this.input);return EditorInputElement.inputGroup(this,t,!this.input.multiple)},e.prototype.ready=function(t,e){var i;this.manager=e,this.element=t,this.control?this.control.ready(t.find(".select-control-container"),this):(i=this,t.on("change","select",function(){i._value=$(this).val(),e.notify(this),t.trigger(EditorEventInputChange)}))},e.prototype.notify=function(t){this._value=this.control.value,this.manager.notify(this),this.element.trigger(EditorEventInputChange)},e.selectControl=function(t,e,i,n,o){return'<select class="form-control" name="'.concat(e,'" id="').concat(t,'"').concat(EditorHtmlHelper.renderAttribute(o),">\n        ").concat(this.selectOption(i,n),"\n        </select>")},e.selectOption=function(t,i){return t.map(function(t){var e=i==t.value?" selected":"";return'<option value="'.concat(t.value,'"').concat(e,">").concat(t.name,"</option>")}).join("")},e.selectOptionBar=function(t,i,e){e=(e=void 0===e?!1:e)?'<div class="search-option-item">\n        <input type="text">\n        <i class="fa fa-search"></i>\n    </div>':"";return e+=t.map(function(t){var e="object"==typeof t?t.name:t,t="object"==typeof t?t.value:t;return'<div class="option-item'.concat(t===i?" selected":"",'" data-value="').concat(t,'">').concat(e,"</div>")}).join(""),'<div class="select-option-bar">'.concat(e,"</div>")},e})(),EditorImageControl=(()=>{function r(){}return Object.defineProperty(r.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t||"",this.element)&&this.element.find(".control-body").html(this.value?r.imageItem(this.value):r.imageUpload(this.shimmed))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isUpdated",{get:function(){return!!this.value},enumerable:!1,configurable:!0}),r.prototype.reset=function(){this.value=""},r.prototype.render=function(){var t=this.value?r.imageItem(this.value):r.imageUpload(this.shimmed);return EditorInputElement.inputGroup(this,'<div class="control-body">'.concat(t,"</div>"),!1)},r.prototype.ready=function(i,n){this.element=i;var o=this;i.on("change",".drag-control-container input[type=file]",function(){var e=$(this).closest(".drag-control-container");e.addClass("is-uploading"),r.upload(this.files[0],function(t){t?(o._value=t,i.find(".control-body").html(r.imageItem(t)),i.trigger(EditorEventInputChange),n.notify(o)):e.removeClass("is-uploading")})}).on("click",".image-control-item .fa-trash",function(){o.reset(),i.trigger(EditorEventInputChange),n.notify(o)})},r.upload=function(t,e){var i=new FormData;i.append("upfile",t),$.ajax({url:UPLOAD_URI,type:"POST",data:i,cache:!1,contentType:!1,processData:!1,success:function(t){e(t&&"SUCCESS"===t.state?t.url:void 0)},error:function(t){e()}})},r.imageUpload=function(t){return'<div class="drag-control-container"><label for="'.concat(t,'">\n            拖放文件\n            <p>(或点击)</p>\n            <input type="file" id="').concat(t,'" accept="image/*">\n            </label>\n            <div class="loading">\n                <span></span>\n                <span></span>\n                <span></span>\n                <span></span>\n                <span></span>\n            </div>\n        </div>\n            ')},r.imageItem=function(t){return'<div class="image-control-item">\n        <div class="control-body">\n            <img src="'.concat(t,'">\n        </div>\n        <div class="control-action">\n            <i class="fa fa-edit"></i>\n            <i class="fa fa-trash"></i>\n        </div>\n    </div>')},r})(),EditorSwitchControl=(()=>{function t(){this.target=new EditorSwitchElement}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=EditorHelper.parseNumber(t),this.target)&&(this.target.value=this._value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return 0<this.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=0},t.prototype.render=function(){return this.target.value=EditorHelper.parseNumber(this.value),EditorInputElement.inputGroup(this,this.target.render())},t.prototype.ready=function(t,e){this.manager=e,this.element=t,this.target.ready(t.children(".switch-input"),this)},t.prototype.notify=function(t){this._value=t.value,this.element.trigger(EditorEventInputChange),this.manager.notify(this)},t})(),EditorTextareaControl=(()=>{function t(){this._value=""}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=void 0===t?"":t,this.element)&&this.element.find("textarea").val(this.value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!!this.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=""},t.prototype.render=function(){return EditorInputElement.inputGroup(this,'<textarea class="form-control" id="'.concat(this.shimmed,'" name="').concat(this.name,'">').concat(this.value,"</textarea>"),!1)},t.prototype.ready=function(t,e){this.element=t;var i=this;t.on("change","textarea",function(){i._value=this.value,e.notify(i)})},t})(),EditorNumberControl=(()=>{function t(){this._value=0}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=EditorHelper.parseNumber(t),this.element)&&this.element.find("input").val(this.value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!!this.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=0},t.prototype.render=function(){return EditorInputElement.inputSideGroup(this,t.numberInput(this.value),'<input type="range" value="'.concat(EditorHelper.parseNumber(this.value),'">'))},t.prototype.ready=function(t,e){this.element=t;var i=this;t.on("change","input",function(){i.value=this.value,e.notify(i)})},t.numberInput=function(t){return'<div class="number-control-container">\n        <input type="text" value="'.concat(t=void 0===t?"":t,'">\n        <div class="control-action-bar">\n            <i class="fa fa-angle-up action-plus"></i>\n            <i class="fa fa-angle-down action-minus"></i>\n        </div>\n    </div>')},t})(),EditorSizeControl=(()=>{function t(){this.control=new EditorSizeElement}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this.control.value=t,this._value=this.control.value,this.element)&&this.element.find(".side-label input").val(this._value.value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return this._value&&this._value.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){return EditorInputElement.inputSideGroup(this,this.control.render(),'<input type="range" value="'.concat(EditorHelper.parseNumber(this.control.value.value),'">'))},t.prototype.ready=function(e,i){var n=this;this.element=e,this.manager=i,this.control.ready(e.find(".select-with-control"),this),e.on("change",".side-label input",function(){var t=n.value;t.value=EditorHelper.parseNumber(this.value),n.control.value=n._value=t,e.trigger(EditorEventInputChange),i.notify(n)})},t.prototype.notify=function(t){this._value=this.control.value,this.element.find(".side-label input").val(this._value.value),this.manager.notify(this),this.element.trigger(EditorEventInputChange)},t})(),EditorRadioControl=(()=>{function t(t){this.items=[],this.items=t.items}return Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!this._value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.control)&&(this.control.value=t)},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){return this.control=new EditorCheckElement(this.value,this.items),EditorInputElement.inputGroup(this,this.control.render(),!1)},t.prototype.ready=function(t,e){this.manager=e},t.prototype.notify=function(t){this._value=this.control.value,this.manager.notify(this)},t})(),EditorBoundControl=(()=>{function t(t){this.columns=["上","右","下","左"],this.control=new EditorBoundElement,t.items&&(this.columns=t.items)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.control.value},set:function(t){this.control.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return this.value&&0<this.value.filter(function(t){return!!t.value}).length},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=[]},t.prototype.render=function(){return this.control.columns=this.columns,EditorInputElement.inputGroup(this,this.control.render(),!1)},t.prototype.ready=function(t,e){this.manager=e,this.element=t,this.control.ready(t.find(".control-row"),this)},t.prototype.notify=function(t){this.manager.notify(this),this.element.trigger(EditorEventInputChange)},t})(),EditorColorControl=(()=>{function r(){}return Object.defineProperty(r.prototype,"isUpdated",{get:function(){return!!this.value},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.element)&&this.setColor(this._value)},enumerable:!1,configurable:!0}),r.prototype.reset=function(){this.value=""},r.prototype.render=function(){return EditorInputElement.inputGroup(this,'<div class="control-popup-target">\n        <div class="color-icon">\n            <i class="fa fa-edit"></i>\n        </div>\n    </div>\n    <div class="control-popup" data-popup="color">\n        <div class="popup-action">\n            <div class="btn btn-danger">清除</div>\n        </div>\n        <div class="control-line-group mt-0">\n            <label for="">Hue</label>\n            <input type="range" class="hue-bar" min="0" max="360" step="1" value="0">\n        </div>\n        <div class="control-line-group mt-0">\n            <label for="">Saturation</label>\n            <input type="range" class="saturation-bar" min="0" max="100" step="1" value="0">\n        </div>\n        <div class="control-line-group mt-0">\n            <label for="">Lightness</label>\n            <input type="range" class="lightness-bar" min="0" max="100" step="1" value="0">\n        </div>\n        <div class="control-line-group alpha-ouline-bar mt-0">\n            <label for="">Transparency</label>\n            <input type="range" class="alpha-bar" min="0" max="100" step="1" value="1">\n        </div>\n    \n        <div class="control-row tab-bar-target active">\n            <div class="control-half-group">\n                <input type="text">\n                <label for="">HEX</label>\n            </div>\n        </div>\n        <div class="control-row tab-bar-target">\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">R</label>\n            </div>\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">G</label>\n            </div>\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">B</label>\n            </div>\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">A</label>\n            </div>\n        </div>\n        <div class="control-row tab-bar-target">\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">H</label>\n            </div>\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">S</label>\n            </div>\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">L</label>\n            </div>\n            <div class="control-half-group">\n                <input type="number">\n                <label for="">A</label>\n            </div>\n        </div>\n        <div class="tab-bar">\n            <a class="item active">HEX</a>\n            <a class="item">RGB</a>\n            <a class="item">HSL</a>\n        </div>\n    </div>')},r.prototype.ready=function(e,i){var n=this;this.element=e,this.value&&this.setColor(this.value),e.on("change",".hue-bar,.saturation-bar,.lightness-bar,.alpha-bar",function(){var t=n.getColor();n.applyColor(n.getColor()),n._value=r.rgbaToHex(r.hslToRgba(t)),e.trigger(EditorEventInputChange),i.notify(n)})},r.prototype.setColor=function(t){var e,i,n,o;this.element&&(e=this.element.find(".hue-bar"),i=this.element.find(".saturation-bar"),n=this.element.find(".lightness-bar"),o=this.element.find(".alpha-bar"),t=r.colorToRgba(t),t=r.rgbaToHsl(t),e.val(t.h),i.val(t.s),n.val(t.l),o.val(100*t.a),this.applyColor(t))},r.prototype.applyColor=function(n){var o,t;this.element&&(o=r.hslToRgba(n),t="rgba(".concat(o.r,", ").concat(o.g,", ").concat(o.b,", ").concat(o.a,")"),this.element.find(".saturation-bar").css("background-image","linear-gradient(to right, gray, ".concat(t,")")),this.element.find(".lightness-bar").css("background-image","linear-gradient(to right, black, ".concat(t,")")),this.element.find(".alpha-bar").css("background-image","linear-gradient(to right, transparent, ".concat(t,")")),this.element.find(".tab-bar-target").each(function(t){var e,i=$(this);0===t?i.find("input").val(r.rgbaToHex(o)):(e=1===t?[o.r,o.g,o.b,o.a]:[n.h,n.s,n.l,n.a],i.find("input").each(function(t){this.value=e[t].toString()}))}))},r.prototype.getColor=function(){var t,e,i,n;return this.element?(t=this.element.find(".hue-bar"),e=this.element.find(".saturation-bar"),i=this.element.find(".lightness-bar"),n=this.element.find(".alpha-bar"),{h:toInt(t.val()),s:toInt(e.val()),l:toInt(i.val()),a:toInt(n.val())/100}):{h:0,s:0,l:0,a:0}},r.colorToRgba=function(t){function e(t){return t.substring(t.indexOf("(")+1,t.indexOf(")")).split(",").map(function(t){return toFloat(t)})}var i,n=t.charAt(0);return"h"===n?(i=e(t),this.hslToRgba({h:i[0],s:i[1],l:i[2],a:1})):"r"===n?3<(i=e(t)).length?{r:i[0],g:i[1],b:i[2],a:i[3]}:{r:i[0],g:i[1],b:i[2],a:1}:this.hexToRgba(t)},r.rgbaToHex=function(t){return["#",t.r.toString(16),t.g.toString(16),t.b.toString(16),0<=t.a&&t.a<1?Math.round(255*t.a).toString(16):""].join("")},r.hexToRgba=function(t){function e(t,e){return void 0===e&&(e=!1),t?(t=parseInt(t,16),e?17*t:t):0}var i=1,n=(t="#"===t.charAt(0)?t.substring(1):t).length<=4?1:2;return{r:e(t.substring(0,n),2==n),g:e(t.substring(n,2*n),2==n),b:e(t.substring(2*n,3*n),2==n),a:i=t.length>3*n?e(t.substring(3*n,4*n),2==n):i}},r.rgbaToHsl=function(t){var e,i=t.r,n=t.g,o=t.b,r=(i/=255,n/=255,o/=255,Math.max(i,n,o)),a=Math.min(i,n,o),s=(r+a)/2;if(r==a)e=c=0;else{var l=r-a,c=.5<s?l/(2-r-a):l/(r+a);switch(r){case i:e=(n-o)/l+(n<o?6:0);break;case n:e=(o-i)/l+2;break;case o:e=(i-n)/l+4}e/=6}return{h:e,s:c,l:s,a:t.a}},r.hslToRgba=function(t){var e,i,n,o,r=t.h/360,a=t.s/100,s=t.l/100;return 0==a?i=n=o=s:(i=(e=function(t,e,i){return i<0&&(i+=1),1<i&&--i,i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t})(a=2*s-(s=s<.5?s*(1+a):s+a-s*a),s,r+1/3),n=e(a,s,r),o=e(a,s,r-1/3)),{r:Math.round(255*i),g:Math.round(255*n),b:Math.round(255*o),a:t.a}},r})(),EditorBackgroundControl=(()=>{function t(){this.items=[EditorHtmlHelper.renderControl({label:"背景色",type:"color",name:"color"}),EditorHtmlHelper.renderControl({label:"背景图片",type:"image",name:"image"})]}return Object.defineProperty(t.prototype,"value",{get:function(){for(var t={},e=0,i=this.items;e<i.length;e++){var n=i[e];t[n.name]=n.value}return t},set:function(e){this.items.forEach(function(t){e?t.value=t[t.name]:t.reset()})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){for(var t=0,e=this.items;t<e.length;t++)if(e[t].isUpdated)return!0;return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){var t=this.items.map(function(t){return t.render()}).join(""),t='<div class="control-popup-target">\n        <div class="color-icon">\n            <i class="fa fa-edit"></i>\n        </div>\n    </div>\n    <div class="control-popup" data-popup="background">\n        '.concat(t,"\n    </div>\n    ");return EditorInputElement.inputGroup(this,t)},t.prototype.ready=function(t,e){var i=this,n=(this.element=t,this.manager=e,t.find(".control-popup").children());this.items.forEach(function(t,e){t.ready(n.eq(e),i)})},t.prototype.notify=function(t){this.manager.notify(this)},t})(),EditorBorderControl=(()=>{function t(){this.items=[EditorHtmlHelper.renderControl({label:"Width",type:"bound",name:"width"}),EditorHtmlHelper.renderControl({label:"Style",type:"select",name:"style",items:[{name:"无",value:""},{name:"横线",value:"solid"},{name:"点线",value:"dotted"},{name:"虚线",value:"double"}]}),EditorHtmlHelper.renderControl({label:"Color",type:"color",name:"color"}),EditorHtmlHelper.renderControl({label:"Radius",type:"bound",name:"radius",items:["左上","右上","右下","左下"]}),EditorHtmlHelper.renderControl({label:"Shadow",type:"shadow",name:"shadow"})]}return Object.defineProperty(t.prototype,"value",{get:function(){for(var t={},e=0,i=this.items;e<i.length;e++){var n=i[e];t[n.name]=n.value}return t},set:function(e){this.items.forEach(function(t){e?t.value=t[t.name]:t.reset()})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){for(var t=0,e=this.items;t<e.length;t++)if(e[t].isUpdated)return!0;return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){var t=this.items.map(function(t){return t.render()}).join(""),t='<div class="control-popup-target">\n        <div class="color-icon">\n            <i class="fa fa-edit"></i>\n        </div>\n    </div>\n    <div class="control-popup" data-popup="border">\n        '.concat(t,"\n    </div>");return EditorInputElement.inputGroup(this,t)},t.prototype.ready=function(t,e){var i=this,n=(this.element=t,this.manager=e,t.find(".control-popup").children());this.items.forEach(function(t,e){t.ready(n.eq(e),i)})},t.prototype.notify=function(t){this.manager.notify(this)},t})(),EditorShadowControl=(()=>{function t(){this.items=[EditorHtmlHelper.renderControl({label:"",type:"bound",name:"bound",items:["X","Y","BLUR","SPREAD"]}),EditorHtmlHelper.renderControl({label:"Color",type:"color",name:"color"}),EditorHtmlHelper.renderControl({label:"Inset",type:"switch",name:"inset",items:["内","外"]})]}return Object.defineProperty(t.prototype,"isUpdated",{get:function(){for(var t=0,e=this.items;t<e.length;t++){var i=e[t];if(Object.prototype.hasOwnProperty.call(i,"isUpdated")&&i.isUpdated)return!0}return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0,this.items.forEach(function(t){t.reset&&t.reset()})},t.prototype.render=function(){var t=this.items.map(function(t){return t.render()}).join(""),t='<div class="control-popup-target">\n        <div class="color-icon">\n            <i class="fa fa-edit"></i>\n        </div>\n    </div>\n    <div class="control-popup" data-popup="shadow">\n        '.concat(t,"\n    </div>");return EditorInputElement.inputGroup(this,t)},t.prototype.ready=function(t,e){this.element=t,this.manager=e;var i=t.find(".control-popup").children(),n=this;this.items.forEach(function(t,e){t.ready(i.eq(e),n)})},t.prototype.notify=function(t){this.value={};for(var e=0,i=this.items;e<i.length;e++){var n=i[e];n.reset&&(this.value[n.name]=n.value)}this.manager.notify(this)},t})(),EditorTypographyControl=(()=>{function t(){this.items=[EditorHtmlHelper.renderControl({label:"Color",type:"color",name:"color"}),EditorHtmlHelper.renderControl({label:"Font Size",type:"size",name:"font-size"}),EditorHtmlHelper.renderControl({label:"Text Align",type:"textAlign",name:"text-align"}),EditorHtmlHelper.renderControl({label:"Text Transform",type:"radio",name:"text-transform",items:[{name:"Aa",value:"capitalize"},{name:"aa",value:"lowercase"},{name:"AA",value:"uppercase"},{name:"x",value:"none"}]}),EditorHtmlHelper.renderControl({label:"",type:"select",name:"font-family",items:[{name:"默认",value:""},{name:"微软雅黑",value:"微软雅黑"},{name:"黑体",value:"黑体"},{name:"宋体",value:"宋体"}]}),EditorHtmlHelper.renderControl({label:"",type:"range",name:"font-weight",step:100,min:100,max:900}),EditorHtmlHelper.renderControl({label:"",type:"select",name:"font-style",items:[{name:"Normal",value:"normal"},{name:"Italic",value:"italic"},{name:"Oblique",value:"oblique"}]}),EditorHtmlHelper.renderControl({label:"Line Height",type:"size",name:"line-height"}),EditorHtmlHelper.renderControl({label:"Letter Spacing",type:"size",name:"letter-spacing"}),EditorHtmlHelper.renderControl({label:"Text Shadow",type:"shadow",name:"text-shadow"}),EditorHtmlHelper.renderControl({label:"Text Decoration",type:"radio",name:"text-decoration",items:[{name:'<span style="text-decoration:line-through">Aa</span>',value:"line-through"},{name:'<span style="text-decoration:underline">Aa</span>',value:"underline"},{name:'<span style="text-decoration:overline">Aa</span>',value:"overline"},{name:"x",value:"none"}]})]}return Object.defineProperty(t.prototype,"value",{get:function(){for(var t={},e=0,i=this.items;e<i.length;e++){var n=i[e];t[n.name]=n.value}return t},set:function(e){this.items.forEach(function(t){e?t.value=t[t.name]:t.reset()})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){for(var t=0,e=this.items;t<e.length;t++)if(e[t].isUpdated)return!0;return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){var t=this.items.map(function(t){return t.render()}).join(""),t='<div class="control-popup-target">\n        <div class="color-icon">\n            <i class="fa fa-edit"></i>\n        </div>\n    </div>\n    <div class="control-popup" data-popup="border">\n        '.concat(t,"\n    </div>");return EditorInputElement.inputGroup(this,t)},t.prototype.ready=function(t,e){var i=this,n=(this.element=t,this.manager=e,t.find(".control-popup").children());this.items.forEach(function(t,e){t.ready(n.eq(e),i)})},t.prototype.notify=function(t){this.manager.notify(this)},t})(),EditorTreeControl=(()=>{function s(t){this.items=[],this.value=t.items,this.form=t.input}return Object.defineProperty(s.prototype,"isUpdated",{get:function(){return this.value&&0<this.value.length},enumerable:!1,configurable:!0}),s.prototype.reset=function(){this.value=[],this.element.find(".tree-container").children(".tree-item").remove()},s.prototype.render=function(){return this.items=EditorHtmlHelper.renderControlItems(this.form),EditorInputElement.inputGroup(this,s.flipPanel('<div class="tree-container">'.concat(this.treeInput(this.form,this.value),"</div>"),this.items.map(function(t){return t.render()}).join("")),!1)},s.prototype.notify=function(t){},s.prototype.ready=function(i,t){var n=this,a=(this.element=i,this),o=i.find(".flip-back-body .flip-body").children();this.items.forEach(function(t,e){t.ready(o.eq(e),n)}),i.on("click",".tree-add-btn",function(){var t=$(this),e=t.closest(".tree-container"),i=$(a.renderTreeItem(a.form));t.before(i),e.trigger(EditorEventListEdit,i)}).on("click",".item-body",function(){$(this)}).on("click",".item-action-bar .fa-arrow-up",function(t){t.stopPropagation();var e,i,n,t=$(this),o=t.closest(".tree-container"),t=t.closest(".tree-item"),r=t.prev();0!==r.length&&(e=t.index(),i=$(this).parents(".tree-item").map(function(t,e){return $(e).index()}).toArray(),n=a.value,s.moveItem(n,__spreadArray([e],i,!0),__spreadArray([e-1],i,!0)),r.before(t),o.closest(".control-line-group").trigger(EditorEventInputChange,n))}).on("click",".item-action-bar .fa-arrow-down",function(t){t.stopPropagation();var e,i,n,t=$(this),o=t.closest(".tree-container"),t=t.closest(".tree-item"),r=t.next();0!==r.length&&(e=t.index(),i=$(this).parents(".tree-item").map(function(t,e){return $(e).index()}).toArray(),n=a.value,s.moveItem(n,__spreadArray([e],i,!0),__spreadArray([e+1],i,!0)),r.after(t),o.closest(".control-line-group").trigger(EditorEventInputChange,n))}).on("click",".item-action-bar .fa-edit",function(t){t.stopPropagation();t=$(this).closest(".tree-item");t.closest(".tree-container").trigger(EditorEventListEdit,t)}).on("click",".item-action-bar .fa-plus",function(t){t.stopPropagation();var t=$(this).closest(".item-body"),e=t.next(".item-children"),t=(0===e.length&&(e=$('<div class="item-children"></div>'),t.after(e),t.prepend('<div class="item-open-icon"><i class="fa fa-chevron-right"></i></div>')),$(a.renderTreeItem(a.form)));e.append(t),i.trigger(EditorEventListEdit,t)}).on("click",".item-action-bar .fa-trash",function(t){t.stopPropagation();var t=$(this),e=t.closest(".tree-container"),t=t.closest(".tree-item"),i=__spreadArray([t.index()],$(this).parents(".tree-item").map(function(t,e){return $(e).index()}).toArray(),!0),t=(t.remove(),a.value);s.removeItem(t,i),e.closest(".control-line-group").trigger(EditorEventInputChange,t)}).on("click",".item-open-icon",function(t){t.stopPropagation(),$(this).closest(".tree-item").toggleClass("open")}).on(EditorEventListEdit,function(t,e){e instanceof HTMLElement&&(e=$(e));var i=__spreadArray([e.index()],$(this).parents(".tree-item").map(function(t,e){return $(e).index()}).toArray(),!0),n=s.getData(a.value,i);a.items.forEach(function(t){t.value=n&&n[t.name]?n[t.name]:void 0}),e.closest(".flip-container").trigger(EditorEventFlipToggle,function(t){e.replaceWith(a.renderTreeItem(a.form,t)),s.setData(a.value,i,t)})})},s.prototype.treeInput=function(t,e){var i="";if(e)for(var n=0,o=e;n<o.length;n++){var r=o[n];i+=this.renderTreeItem(t,r)}return"".concat(i,'<div class="tree-add-btn">\n        <i class="fa fa-plus"></i>\n    </div>')},s.prototype.renderTreeItem=function(t,e){var i="",n="",t=(e&&e.children&&(i='<div class="item-children">'+this.treeInput(t,e.children)+"</div>",n='<div class="item-open-icon"><i class="fa fa-chevron-right"></i></div>'),e&&e.icon&&(n='<i class="item-icon fa '+e.icon+'"></i>'),e?e.title:"");return'<div class="tree-item">\n        <div class="item-body">\n            '.concat(n,'\n            <span class="item-title">').concat(t,'</span>\n            <div class="item-action-icon">\n                <i class="fa fa-ellipsis-h"></i>\n                <div class="item-action-bar">\n                    <i class="fa fa-trash"></i>\n                    <i class="fa fa-plus"></i>\n                    <i class="fa fa-edit"></i>\n                    <i class="fa fa-arrow-up"></i>\n                    <i class="fa fa-arrow-down"></i>\n                </div>\n            </div>\n        </div>\n        ').concat(i,"\n    </div>")},s.flipPanel=function(t,e){return void 0===e&&(e=""),'<div class="flip-container"><div class="flip-front-body">'.concat(t,'</div><div class="flip-back-body">\n            <div class="flip-action-bar">\n                <i class="fa fa-arrow-left flip-back-btn"></i>\n                <i class="fa fa-save flip-save-btn"></i>\n            </div>\n            <div class="flip-body">').concat(e,"</div>\n        </div></div>")},s.getData=function(t,e){for(var i=e.length-1;0<=i;){var n=e[i];if(n>=t.length)return;n=t[n];if(0===i)return n;t=n.children,i--}},s.setData=function(t,e,i){for(var n=e.length-1;0<=n;){var o=e[n];0===n&&(o>=t.length?t.push(__assign({},i)):t[o]=__assign({},i)),t[o].children||(t[o].children=[]),t=t[o].children,n--}},s.moveItem=function(t,e,i){for(var n,o=t,r=e.length-1;0<=r;){var a=e[r];if(0===r){a<o.length&&(n=o[a],o.splice(a,1));break}o[a].children||(o[a].children=[]),o=o[a].children,r--}if(n)for(o=t,r=i.length-1;0<=r;){a=i[r];if(0===r){a<o.length?o.splice(a,0,n):o.push(n);break}o[a].children||(o[a].children=[]),o=o[a].children,r--}},s.removeItem=function(t,e){for(var i=e.length-1;0<=i;){var n=e[i];if(0===i)return void(n<t.length&&t.splice(n,1));t[n].children||(t[n].children=[]),t=t[n].children,i--}},s})(),EditorMultipleControl=(()=>{function t(t){this.items=[],this.value=t.items,this.form=t.input}return Object.defineProperty(t.prototype,"isUpdated",{get:function(){return this.value&&0<this.value.length},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=[],this.element.find(".multiple-container .list-item").remove()},t.prototype.render=function(){var t=[];if(this.value)for(var e=0,i=this.value;e<i.length;e++){var n=i[e];t.push(this.renderMultipleItem(this.form,n))}return this.items=EditorHtmlHelper.renderControlItems(this.form),t.push('<div class="multiple-add-btn">\n            <i class="fa fa-plus"></i>\n        </div>'),EditorInputElement.inputGroup(this,EditorTreeControl.flipPanel('<div class="multiple-container">'.concat(t.join(""),"</div>"),this.items.map(function(t){return t.render()}).join("")),!1)},t.prototype.notify=function(t){},t.prototype.ready=function(t,e){var i=this,a=(this.element=t,this),n=t.find(".flip-back-body .flip-body").children();this.items.forEach(function(t,e){t.ready(n.eq(e),i)}),t.on("click",".multiple-add-btn",function(){var t=$(this),e=t.closest(".multiple-container"),i=$(a.renderMultipleItem(a.form));t.before(i),e.trigger(EditorEventListEdit,i)}).on("click",".item-action-bar .fa-arrow-up",function(t){t.stopPropagation();var e,i,n,t=$(this),o=t.closest(".multiple-container"),t=t.closest(".list-item"),r=t.prev();0!==r.length&&(e=t.index(),n=a.value,EditorTreeControl.moveItem(n,__spreadArray([e],i=[],!0),__spreadArray([e-1],i,!0)),r.before(t),o.closest(".control-line-group").trigger(EditorEventInputChange,n))}).on("click",".item-action-bar .fa-arrow-down",function(t){t.stopPropagation();var e,i,n,t=$(this),o=t.closest(".multiple-container"),t=t.closest(".list-item"),r=t.next();0!==r.length&&(e=t.index(),n=a.value,EditorTreeControl.moveItem(n,__spreadArray([e],i=[],!0),__spreadArray([e+1],i,!0)),r.after(t),o.closest(".control-line-group").trigger(EditorEventInputChange,n))}).on("click",".item-action-bar .fa-edit",function(t){t.stopPropagation();t=$(this).closest(".list-item");t.closest(".multiple-container").trigger(EditorEventListEdit,t)}).on("click",".item-action-bar .fa-trash",function(t){t.stopPropagation();var t=$(this),e=t.closest(".multiple-container"),t=t.closest(".list-item"),i=[t.index()],t=(t.remove(),a.value);EditorTreeControl.removeItem(t,i),e.closest(".control-line-group").trigger(EditorEventInputChange,t)}).on(EditorEventListEdit,".multiple-container",function(t,e){var i=[(e=e instanceof HTMLElement?$(e):e).index()],n=EditorTreeControl.getData(a.value,i);a.items.forEach(function(t){t.value=n&&n[t.name]?n[t.name]:void 0}),e.closest(".flip-container").trigger(EditorEventFlipToggle,function(t){e.replaceWith(a.renderMultipleItem(a.form,t)),EditorTreeControl.setData(a.value,i,t)})})},t.prototype.renderMultipleItem=function(t,e){var i="",e=(e&&e.icon&&(i='<i class="item-icon fa '+e.icon+'"></i>'),e?e.title:"");return'<div class="list-item">\n        '.concat(i,'\n            <span class="item-title">').concat(e,'</span>\n            <div class="item-action-icon">\n                <i class="fa fa-ellipsis-h"></i>\n                <div class="item-action-bar">\n                    <i class="fa fa-trash"></i>\n                    <i class="fa fa-edit"></i>\n                    <i class="fa fa-arrow-up"></i>\n                    <i class="fa fa-arrow-down"></i>\n                </div>\n            </div>\n        </div>')},t})(),EditorImagesControl=(()=>{function t(t){this._value=[],this.value=t.items}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t instanceof Array?t:[],this.element)&&((t=this.element.find(".image-container")).find(".image-control-item").remove(),this._value.length<1||t.prepend(this._value.map(function(t){return EditorImageControl.imageItem(t)}).join("")))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return this.value&&0<this.value.length},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=[]},t.prototype.render=function(){var t=[];if(this._value)for(var e=0,i=this._value;e<i.length;e++){var n=i[e];t.push(EditorImageControl.imageItem(n))}return t.push(EditorImageControl.imageUpload(this.shimmed)),EditorInputElement.inputGroup(this,EditorHtmlHelper.join.apply(EditorHtmlHelper,__spreadArray(__spreadArray(['<div class="image-container">'],t,!1),["</div>"],!1)),!1)},t.prototype.ready=function(i,n){this.element=i;var o=this;i.on("change",".drag-control-container input[type=file]",function(){var e=$(this).closest(".drag-control-container");e.addClass("is-uploading"),o.upload(this.files,function(t){o.value.push(t),e.before(EditorImageControl.imageItem(t))},function(){i.trigger(EditorEventInputChange),n.notify(o),e.removeClass("is-uploading")})}).on("click",".image-control-item .fa-trash",function(){var t=$(this).closest(".image-control-item");o.value.splice(t.index(),1),t.remove(),i.trigger(EditorEventInputChange),n.notify(o)})},t.prototype.upload=function(t,e,i){var n=0;n>=t.length?i():EditorImageControl.upload(t[n],function(t){t&&e(t),n++})},t})(),EditorIconControl=(()=>{function t(){this.iconItems=[{name:"Home",value:"fa-home"},{name:"Edit",value:"fa-edit"},{name:"close",value:"fa-times"},{name:"trash",value:"fa-trash"}]}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.element)&&this.element.find(".icon-option-item").eq(this.indexOf(t)).addClass("selected").removeClass("hidden").siblings().removeClass("selected")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!this.value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=""},t.prototype.render=function(){var t=this.iconItems.map(function(t){return'<div class="icon-option-item">\n        <i class="fa '.concat(t.value,'"></i>\n        <span>').concat(t.name,"</span>\n        </div>")}).join(""),t='<div class="control-popup-target">\n        <div class="color-icon">\n            <i class="fa fa-edit"></i>\n        </div>\n    </div>\n    <div class="control-popup" data-popup="icon">\n        <div class="search-header-bar">\n            <input>\n            <i class="fa fa-search"></i>\n        </div>\n        <div class="search-body">\n            '.concat(t,"\n        </div>\n    </div>");return EditorInputElement.inputGroup(this,t)},t.prototype.ready=function(e,i){this.element=e;var n=this;e.on("click",".icon-option-item",function(){var t=$(this);t.addClass("selected").siblings().removeClass("selected"),n._value=n.iconItems[t.index()].value,e.trigger(EditorEventInputChange),i.notify(n)}).on("change",".control-popup .search-header-bar input",function(){var t=$(this),i=t.val();t.closest(".search-header-bar").next(".search-body").find(".icon-option-item").each(function(){var t=$(this),e=t.find("span").text();t.toggleClass("hidden",i&&e.indexOf(i)<0)})})},t.prototype.indexOf=function(t){for(var e=0;e<this.iconItems.length;e++)if(this.iconItems[e].value===t)return e;return-1},t})(),EditorMaskControl=(()=>{function t(){this.items=["inset(10%)","circle(45% at 50% 50%)","ellipse(30% 45% at 50% 50%)","polygon(50% 0%, 0% 100%, 100% 100%)","polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%)","polygon(25% 0%, 100% 0%, 75% 100%, 0% 100%)","polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)","polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%)","polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%)"]}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.element)&&this.element.find(".clip-path-box .shape").removeClass("selected").eq(this.items.indexOf(t)).addClass("selected")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!!this._value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){var t=this.items.map(function(t){return'<div class="shape" style="clip-path: '.concat(t,';"></div>')}).join("");return'<div class="mark-container" '.concat(EditorHtmlHelper.shimmed(this.shimmed),'>\n        <div class="clip-path-box">\n            ').concat(t,'\n        </div>\n        <button class="btn btn-primary">一键取消</button>\n    </div>\n    ')},t.prototype.ready=function(t,e){this.element=t;var i=this;t.on("click",".btn",function(){i.reset(),e.notify(i)}).on("click",".clip-path-box .shape",function(){var t=$(this);t.addClass("selected").siblings().removeClass("selected"),i._value=i.items[t.index()],e.notify(i)})},t})(),EditorPositionControl=(()=>{function t(){this._type="static",this._value=[],this.control=new EditorBoundElement,this.typeItems=[{name:"无",value:"static"},{name:"相对定位",value:"relative"},{name:"绝对定位",value:"absolute"},{name:"固定定位",value:"fixed"}]}return Object.defineProperty(t.prototype,"value",{get:function(){return"static"===this._type?{type:this._type}:{type:this._type,value:this._value}},set:function(t){t?(this._type=t.type,this._value="static"===t.type?[]:t.value,this.element&&(this.element.find("select").val(this._type),this.element.next().toggleClass("hidden",this._type===this.typeItems[0].value),this.control.value=this._value)):(this._type="static",this._value=[])},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){return this._type!==this.typeItems[0].value},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value={type:"static"}},t.prototype.render=function(){var t=this._type!==this.typeItems[0].value?"":" hidden",e=(this.control.value=this._value,this.control.render()),i=EditorInputElement.inputGroup(this,EditorSelectControl.selectControl(this.shimmed,this.name+"[type]",this.typeItems,this._type));return"<div ".concat(EditorHtmlHelper.shimmed(this.shimmed),' class="position-container">\n        ').concat(i,'\n        <div class="').concat(t,'">').concat(e,"</div>\n    </div>")},t.prototype.ready=function(t,e){var i=this;this.manager=e,this.control.ready(t.find(".control-row"),this),this.element=t.find(".control-inline-group"),t.on("change","select",function(){var t=$(this);i._type=t.val(),t.closest(".control-inline-group").next().toggleClass("hidden",i._type===i.typeItems[0].value)})},t.prototype.notify=function(t){this._value=this.control.value,this.manager.notify(this)},t})(),EditorGroupControl=(()=>{function t(t){this.input=t}return Object.defineProperty(t.prototype,"isUpdated",{get:function(){return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){},t.prototype.render=function(){var t=EditorHtmlHelper.render(this.input.items);return this.label?"<div ".concat(EditorHtmlHelper.shimmed(this.shimmed),' class="expand-box">\n        <div class="expand-header">').concat(this.label,'<span class="fa fa-chevron-right"></span></div>\n        <div class="expand-body">\n        ').concat(t,"\n        </div>\n    </div>"):"<div".concat(EditorHtmlHelper.renderClass(this.input),">").concat(t,"</div>")},t.prototype.ready=function(t,e){EditorHtmlHelper.readyControl(t.find(".expand-body"),e)},t})(),EditorAlignControl=(()=>{function t(){this.items=[t.horizontalAlign(),t.verticalAlign()]}return Object.defineProperty(t.prototype,"value",{get:function(){return this.items.map(function(t){return t.value})},set:function(i){this.items.forEach(function(t,e){t.value=i?i[e]:void 0})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){for(var t=0,e=this.items;t<e.length;t++)if(e[t].value)return!0;return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=[]},t.prototype.render=function(){return EditorHtmlHelper.join("<div ",EditorHtmlHelper.shimmed(this.shimmed),">",this.items.map(function(t){return t.render()}).join(""),"</div>")},t.prototype.ready=function(t,e){var i=this,n=(this.manager=e,t.children(".control-row"));this.items.forEach(function(t,e){t.ready(n.eq(e),i)})},t.prototype.notify=function(t){this.manager.notify(this)},t.horizontalAlign=function(t,e){var i=[{name:'<i class="fa fa-align-left" title="左对齐"></i>',value:"left"},{name:'<i class="fa fa-align-center" title="水平居中"></i>',value:"center"},{name:'<i class="fa fa-align-right" title="右对齐"></i>',value:"right"}];return(e=void 0===e?!1:e)||i.push({name:'<i class="fa fa-align-justify" title="水平等间距"></i>',value:"stretch"}),new EditorCheckElement(t,i)},t.verticalAlign=function(t){return new EditorCheckElement(t,[{name:'<i class="fa fa-align-left fa-vertical" title="上对齐"></i>',value:"top"},{name:'<i class="fa fa-align-center fa-vertical" title="垂直居中"></i>',value:"center"},{name:'<i class="fa fa-align-right fa-vertical" title="下对齐"></i>',value:"bottom"},{name:'<i class="fa fa-align-justify fa-vertical" title="垂直等间距"></i>',value:"stretch"}])},t})(),EditorAnimationControl=(()=>{function t(){this.items=[EditorHtmlHelper.renderControl({label:"动效",type:"select",name:"type",items:[{value:"",name:"无"},{value:"bounce",name:"弹跳"},{value:"fadeIn",name:"渐现"},{value:"fadeOut",name:"渐出"},{value:"flash",name:"闪烁"},{value:"pulse",name:"跳动"},{value:"rubberBand",name:"橡皮筋"},{value:"shake",name:"抖动"},{value:"swing",name:"摆动"},{value:"tada",name:"哒嘟"},{value:"wobble",name:"摇晃"},{value:"jello",name:"扭曲抖动"},{value:"bounceIn",name:"弹入"},{value:"bounceInDown",name:"上弹入"},{value:"bounceInLeft",name:"左弹入"},{value:"bounceInRight",name:"右弹入"},{value:"bounceInUp",name:"下弹入"},{value:"flipInX",name:"水平翻转"},{value:"flipInY",name:"垂直翻转"},{value:"spinning",name:"旋转（顺时针）"},{value:"spinning-reverse",name:"旋转（逆时针）"},{value:"rotateIn",name:"旋入"},{value:"rotateInDownLeft",name:"左下旋转"},{value:"rotateInDownRight",name:"右下旋转"},{value:"rotateInUpLeft",name:"左上旋转"},{value:"rotateInUpRight",name:"右上旋转"},{value:"slideInDown",name:"上滑入"},{value:"slideInLeft",name:"左滑入"},{value:"slideInRight",name:"右滑入"},{value:"slideInUp",name:"下滑入"},{value:"zoomIn",name:"逐渐放大"},{value:"zoomInDown",name:"从下放大"},{value:"zoomInLeft",name:"从左放大"},{value:"zoomInRight",name:"从右放大"},{value:"zoomInUp",name:"从上放大"},{value:"rollIn",name:"滚入"},{value:"lightSpeedIn",name:"闪入"}]}),EditorHtmlHelper.renderControl({label:"延时",type:"select",name:"delay",items:[{value:"",name:"无"},{value:"0.1s",name:"100ms"},{value:"0.2s",name:"200ms"},{value:"0.3s",name:"300ms"},{value:"0.5s",name:"500ms"},{value:"1s",name:"1s"},{value:"2s",name:"2s"},{value:"3s",name:"3s"},{value:"4s",name:"4s"},{value:"5s",name:"5s"},{value:"6s",name:"6s"},{value:"7s",name:"7s"},{value:"8s",name:"8s"},{value:"9s",name:"9s"},{value:"10s",name:"10s"}]}),EditorHtmlHelper.renderControl({label:"时长",type:"select",name:"duration",items:[{value:"0.25s",name:"250ms"},{value:"0.5s",name:"500ms"},{value:"0.75s",name:"750ms"},{value:"1s",name:"1s"},{value:"2s",name:"2s"},{value:"3s",name:"3s"},{value:"4s",name:"4s"},{value:"5s",name:"5s"}]}),EditorHtmlHelper.renderControl({label:"重复",type:"select",name:"count",items:[{value:"1",name:"1"},{value:"2",name:"2"},{value:"3",name:"3"},{value:"4",name:"4"},{value:"5",name:"5"},{value:"6",name:"6"},{value:"7",name:"7"},{value:"8",name:"8"},{value:"9",name:"9"},{value:"10",name:"10"},{value:"infinite",name:"无限循环"}]}),EditorHtmlHelper.renderControl({label:"缓动函数",type:"select",name:"func",items:[{value:"linear",name:"线性"},{value:"ease",name:"ease"},{value:"ease-in",name:"ease-in"},{value:"ease-out",name:"ease-out"},{value:"ease-in-out",name:"ease-in-out"}]})]}return Object.defineProperty(t.prototype,"value",{get:function(){for(var t={},e=0,i=this.items;e<i.length;e++){var n=i[e];t[n.name]=n.value}return t},set:function(e){this.items.forEach(function(t){e?t.value=t[t.name]:t.reset()})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUpdated",{get:function(){for(var t=0,e=this.items;t<e.length;t++)if(e[t].isUpdated)return!0;return!1},enumerable:!1,configurable:!0}),t.prototype.reset=function(){this.value=void 0},t.prototype.render=function(){var t=this.items.map(function(t){return t.render()}).join("");return'<div class="animation-container" '.concat(EditorHtmlHelper.shimmed(this.shimmed),'>\n        <div class="effect-show">效果展示</div>\n       <div class="control-body">').concat(t,"</div>\n    </div>")},t.prototype.ready=function(t,e){var i=this,n=(this.element=t,this.manager=e,t.find(".control-body").children());this.items.forEach(function(t,e){t.ready(n.eq(e),i)})},t.prototype.notify=function(t){this.manager.notify(this)},t})(),EditorLayerPanel=(()=>{function t(t){var e=this;this.editor=t,this.booted=!1,this.editor.on(EditorEventAfterViewInit,function(){e.bindEvent()})}return t.prototype.bindEvent=function(){this.editor;this.box.on("click",".tree-item .item-open-icon",function(){$(this).closest(".tree-item").toggleClass("open")})},t.prototype.render=function(){return this.box=$('<div class="panel-item" data-panel="layer"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">组件层</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body tree-container">\n            </div>\n        '),this.box},t.prototype.show=function(){var e=this;this.box.removeClass("min"),this.booted||(this.booted=!0,this.editor.emit(EditorEventWeightTree,function(t){e.box.find(".panel-body").html(e.renderItems(t))}))},t.prototype.hide=function(){this.box.addClass("min")},t.prototype.renderItems=function(n){var o=this,r="";return EditorHelper.eachObject(n,function(t){var e="",i="";t.children&&0<t.children.length&&(e='<div class="item-children">'.concat(o.renderItems(n),"</div>"),i='<div class="item-open-icon">\n                <i class="fa fa-chevron-right"></i>\n            </div>'),r+='<div class="tree-item">\n            <div class="item-body">\n                '.concat(i,'\n                <div class="item-icon">\n                    <i class="fa fa-chain"></i>\n                </div>\n                <input type="text" class="item-title" value="').concat(t.title,'" placeholder="ID: ').concat(t.weight_id,'">\n                <div class="item-action-icon">\n                    <i class="fa fa-ellipsis-h"></i>\n                    <div class="item-action-bar">\n                        <i class="fa fa-trash"></i>\n                        <i class="fa fa-copy"></i>\n                        <i class="fa fa-plus"></i>\n                        <i class="fa fa-edit"></i>\n                    </div>\n                </div>\n            </div>\n            ').concat(e,"\n        </div>")}),r},t})(),EditorPagePanel=(()=>{function t(t){var e=this;this.editor=t,this.booted=!1,this.editor.on(EditorEventAfterViewInit,function(){e.bindEvent()})}return t.prototype.bindEvent=function(){this.editor;this.box.on("click",".list-item .item-title",function(){$(this).closest(".list-item").addClass("active").siblings().removeClass("active")})},t.prototype.render=function(){return this.box=$('<div class="panel-item" data-panel="layer"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">页面</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body list-container">\n            </div>\n        '),this.box},t.prototype.show=function(){var e=this;this.box.removeClass("min"),this.booted||(this.booted=!0,this.editor.emit(EditorEventPageList,function(t){e.box.find(".panel-body").html(t.map(e.renderItem.bind(e)).join(""))}))},t.prototype.hide=function(){this.box.addClass("min")},t.prototype.renderItem=function(t){return'<div class="list-item">\n        <span class="item-title">'.concat(t.title,'</span>\n        <div class="item-action-icon">\n            <i class="fa fa-ellipsis-h"></i>\n            <div class="item-action-bar">\n                <i class="fa fa-trash"></i>\n                <i class="fa fa-copy"></i>\n                <i class="fa fa-edit"></i>\n            </div>\n        </div>\n    </div>')},t})(),EditorRuler=(()=>{function t(t,e){void 0===e&&(e=!0);var n=this;this.editor=t,this.horizontal=e,this.offset=0,this.gap=10,this.scale=1,this.foreground="#333",this.background="#ccc",this.baseWidth=0,this.baseX=0,this.baseSize=16,this.editor.on(EditorEventViewInit,function(){n.element=n.editor.find(n.horizontal?".h-rule-bar":".v-rule-bar"),n.baseSize=n.horizontal?n.element.height():n.element.width()}).on(EditorEventResize,function(t,e){n.refresh(),n.onAfterViewInit()}).on(EditorEventPositionChange,function(t,e,i){n.offset=n.horizontal?t:e,n.scale=i/100,n.onRender(n.element[0].getContext("2d"))})}return Object.defineProperty(t.prototype,"barSize",{get:function(){return this.baseSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.barSize-this.offset},enumerable:!1,configurable:!0}),t.prototype.refresh=function(){this.baseWidth=this.horizontal?this.editor.innerWidth:this.editor.innerHeight},t.prototype.onAfterViewInit=function(){var t;this.element.length<1||(t=this.element[0],this.horizontal?(t.width=this.baseWidth,t.height=this.barSize):(t.width=this.barSize,t.height=this.baseWidth),this.onRender(t.getContext("2d")))},t.prototype.createLine=function(t){t=(this.horizontal?t.clientX:t.clientY)-this.baseX;return{value:t,label:Math.floor((t+this.offsetX)/this.scale),horizontal:this.horizontal}},t.prototype.onRender=function(t){t.fillStyle=this.background,t.lineWidth=2;for(var e=this.barSize,i=(this.horizontal?t.fillRect(0,0,this.baseWidth,e):t.fillRect(0,0,e,this.baseWidth),this.gap*this.scale),n=Math.ceil(this.baseWidth/i),o=Math.ceil(this.offsetX/i),r=.3*e,a=0;a<n;a++){var s=o+a,l=s%5==0,c=s*i-this.offsetX,d=e*(l?.6:.4);this.horizontal?(this.drawLine(t,{x:c,y:0},{x:c,y:d},this.foreground),l&&this.drawText(t,(s*this.gap).toString(),r,this.foreground,{x:c,y:d})):(this.drawLine(t,{x:0,y:c},{x:d,y:c},this.foreground),l&&this.drawText(t,(s*this.gap).toString(),r,this.foreground,{x:d-2*r,y:c}))}},t.prototype.drawText=function(t,e,i,n,o){t.font="normal normal bold ".concat(i,"px"),t.fillStyle=n,t.fillText(e,o.x,o.y+i)},t.prototype.drawLine=function(t,e,i,n){t.beginPath(),t.strokeStyle=n,t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.stroke()},t})(),EditorScrollBar=(()=>{function t(t,e){void 0===e&&(e=!0);var a=this;this.editor=t,this.horizontal=e,this.baseSize=8,this.left=0,this.maxLeft=0,this.pxScale=1,this.editor.on(EditorEventViewInit,function(){a.element=a.editor.find(a.horizontal?".h-scroll-bar":".v-scroll-bar"),a.innerBar=a.element.find(".inner-bar"),a.baseSize=a.horizontal?a.element.height():a.element.width(),a.innerBar.on("mousedown",function(t){var i={x:t.clientX,y:t.clientY};a.editor.onMouse(function(t){var e=a.horizontal?t.x-i.x:t.y-i.y;a.scroll(a.left+e),i=t})})}).on(EditorEventBrowserResize,function(t,e,i,n,o,r){a.horizontal?a.onRender(t,o,i,a.element.width()):a.onRender(e,r,n,a.element.height())})}return Object.defineProperty(t.prototype,"barSize",{get:function(){return this.baseSize},enumerable:!1,configurable:!0}),t.prototype.move=function(t){this.scroll(t/this.pxScale)},t.prototype.scroll=function(t){this.left=Math.max(0,Math.min(t,this.maxLeft)),this.innerBar.css(this.horizontal?"left":"top",this.left+"px"),this.output()},t.prototype.scrollTo=function(t){this.scroll(t*this.maxLeft/100)},t.prototype.output=function(){this.editor.emit(EditorEventScroll,this.converter(this.left),this.horizontal)},t.prototype.converter=function(t){return t*this.pxScale},t.prototype.onRender=function(t,e,i,n){var o;i<=e?(this.maxLeft=0,this.applySize(0,n)):(o=Math.min(6*this.baseSize,this.baseSize/2),this.maxLeft=n-(e=(i=n-(n=i-e))<=o?o:i),this.pxScale=n/this.maxLeft,this.applySize(t/this.pxScale,e))},t.prototype.applySize=function(t,e){var i;this.left=Math.max(0,Math.min(t,this.maxLeft)),this.innerBar.css(((i={})[this.horizontal?"left":"top"]=t+"px",i[this.horizontal?"width":"height"]=e+"px",i))},t})(),EditorSettingPanel=(()=>{function t(t){var e=this;this.editor=t,this.lastAt=0,this.booted=!1,this.isAsync=!1,this.editor.on(EditorEventAfterViewInit,function(){e.bindEvent()}).on(EditorEventTimeLoop,function(t){e.isAsync&&2e4<(t=t.getTime())-e.lastAt&&(e.saveSync(),e.lastAt=t)})}return t.prototype.saveSync=function(){this.isAsync=!1;var t=EditorHtmlHelper.formData(this.box);this.editor.emit(EditorEventSavePageSetting,t,function(t){})},t.prototype.autoSave=function(){this.isAsync=!0,this.lastAt=(new Date).getTime()},t.prototype.notify=function(t){this.autoSave()},t.prototype.bindEvent=function(){EditorHtmlHelper.bindInputEvent(this.box,this),this.box.on("click",".tree-item .item-open-icon",function(){$(this).closest(".tree-item").toggleClass("open")})},t.prototype.render=function(){return this.box=$('<div class="panel-item" data-panel="layer"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">配置</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body">\n                <div class="tab-box">\n                    <div class="tab-header"><div class="tab-item active">\n                            页面配置\n                        </div><div class="tab-item">\n                            主题配置\n                        </div></div>\n                    <div class="tab-body">\n                        <div class="tab-item active">\n                        </div>\n                        <div class="tab-item">\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '),this.box},t.prototype.show=function(){var e=this;this.box.removeClass("min"),this.booted||(this.booted=!0,this.editor.emit(EditorEventPageSetting,function(t){e.applyForm(t)}))},t.prototype.hide=function(){this.box.addClass("min")},t.prototype.applyForm=function(t){var e=this.box.find(".tab-body .tab-item");e[0].innerHTML=EditorHtmlHelper.render(t.page),e[1].innerHTML=EditorHtmlHelper.render(t.theme),EditorHtmlHelper.readyControl(e,this)},t})(),EditorWeightPanel=(()=>{function t(t){var e=this;this.editor=t,this.editor.on(EditorEventAfterViewInit,function(){e.editor.emit(EditorEventGetWeights,function(t){e.renderWeight(t.weights)}),e.bindEvent()})}return t.prototype.bindEvent=function(){var i=this.editor;this.box.on("mousedown",".visual-edit-control",function(t){var e=$(this);"true"!==e.attr("draggable")&&(t.stopPropagation(),t.preventDefault(),i.emit(EditorEventDrag,e,!0,{x:t.clientX,y:t.clientY}))}).on("touchstart",".visual-edit-control",function(t){var e=$(this);t.stopPropagation(),t.preventDefault(),i.emit(EditorEventDrag,e,!0,{x:t.touches[0].clientX,y:t.touches[0].clientY})}).on("dragstart",".visual-edit-control",function(t){t.originalEvent.dataTransfer.setData("Text",t.target.id),i.emit(EditorEventDragStart,$(this))})},t.prototype.render=function(){return this.box=$('<div class="panel-item" data-panel="weight"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">部件</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body">\n            </div>\n        '),this.box},t.prototype.renderWeight=function(t){t=EditorHtmlHelper.mapJoinHtml(t,function(i){var t=EditorHtmlHelper.mapJoinHtml(i.items,function(t){var e;return t?(e=t.editable?'<a class="edit">编辑</a>':"",'<div class="visual-edit-control" data-type="weight" data-weight="'.concat(t.id,'" data-group="').concat(i.id,'">\n                <div class="visual-preview">\n                    <div class="thumb">\n                        <img src="').concat(t.thumb,'" alt="').concat(t.name,'" title="').concat(t.description,'">\n                    </div>\n                    <p class="title">').concat(t.name,'</p>\n                </div>\n                <div class="visual-action">\n                    <a class="refresh">刷新</a>\n                    ').concat(e,'\n                    <a class="property">属性</a>\n                    <a class="drag">拖拽</a>\n                    <a class="del">删除</a>\n                </div>\n                <div class="visual-view">\n                    <img src="/assets/images/ajax.gif" alt="">\n                </div>\n            </div>')):""});return'\n            <ul class="menu">\n                <li class="expand-box open">\n                    <div class="expand-header">\n                        '.concat(i.name,'\n                        <span class="fa fa-chevron-right"></span>\n                    </div>\n                    <div class="expand-body list-view">\n                    ').concat(t,"\n                    </div>\n                    </li>\n                </ul>\n            ")});this.box.find(".panel-body").html(t)},t.prototype.show=function(){this.box.removeClass("min")},t.prototype.hide=function(){this.box.addClass("min")},t})(),EditorWeight=(()=>{function t(t,e){this.editor=t,this.box=e}return t.prototype.toggle=function(t){return this.box.toggleClass("visual-edit-mode",t),this},t.prototype.toggleLoading=function(t){return this.box.toggleClass("visual-loading",t),this},t.prototype.html=function(t){t=$(t);return this.box=this.box.replaceWith(t),this.box=t,this},t.prototype.id=function(){return EditorHelper.parseNumber(this.box.attr("data-id"))},t.prototype.weightId=function(){return EditorHelper.parseNumber(this.box.attr("data-weight"))},t.prototype.tapRefresh=function(){var e=this;this.toggleLoading(!0),this.editor.emit(EditorEventRefreshWeight,this.id(),function(t){e.toggleLoading(!1),e.html(t.html)},function(){e.toggleLoading(!1)})},t.prototype.tapEdit=function(){this.editor.emit(EditorEventOpenEditDialog,this)},t.prototype.tapProperty=function(){this.editor.emit(EditorEventOpenProperty,this)},t.prototype.tapRemove=function(){var t=this;this.editor.emit(EditorEventRemoveWeight,this.id(),function(){t.remove()})},t.prototype.moveTo=function(t,e){e=this.appendToPosition(t,e);this.editor.emit(EditorEventMoveWeight,{id:this.id(),parent_id:t.attr("data-id"),parent_index:t.attr("data-index"),position:e},function(){})},t.prototype.appendTo=function(t,e){var i=this,e=this.appendToPosition(t,e);this.box.width("auto"),this.toggleLoading(!0),this.editor.emit(EditorEventAddWeight,{weight_id:this.weightId(),weight_group:this.box.attr("data-group"),parent_id:t.attr("data-id"),parent_index:t.attr("data-index"),position:e},function(t){i.toggleLoading(!1),i.html(t.html)},function(){i.toggleLoading(!1)})},t.prototype.appendToPosition=function(t,e){var i;return!e||(i=t.children().index(e))<0?(t.append(this.box),t.children().length):(this.box.insertBefore(e),i+1)},t.prototype.remove=function(){this.box.remove()},t})(),VisualEditor=(()=>{function t(t){this.box=t,this.listeners={},this.mouseListener={move:void 0,finish:void 0},this.hScrollBar=new EditorScrollBar(this,!0),this.vScrollBar=new EditorScrollBar(this,!1),this.toolBar=new EditorToolBar(this),this.hRuleBar=new EditorRuler(this,!0),this.vRuleBar=new EditorRuler(this,!1),this.browser=new EditorBrowser(this),this.panelGroup=new EditorPanelGroup(this),this.weightSoul=new EditorWeightSoul(this),this.dialog=new EditorDialog(this),this.viewInited=!1,this.browserAdaptive=!1}return Object.defineProperty(t.prototype,"outerWidth",{get:function(){return this.box.width()},set:function(t){this.box.width(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outerHeight",{get:function(){return this.box.height()},set:function(t){this.box.height(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerWidth",{get:function(){return this.viewInited?this.workspace.width()-this.vScrollBar.barSize-this.vRuleBar.barSize:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerHeight",{get:function(){return this.viewInited?this.workspace.height()-this.hRuleBar.barSize-this.hScrollBar.barSize:0},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e){return Object.prototype.hasOwnProperty.call(this.listeners,t)||(this.listeners[t]=[]),this.listeners[t].push(e),this},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(Object.prototype.hasOwnProperty.call(this.listeners,t))for(var n=this.listeners[t],o=n.length-1;0<=o;o--)if(!1===n[o].apply(void 0,e))break;return this},Object.defineProperty(t.prototype,"hasMouseListener",{get:function(){return void 0!==this.mouseListener.move},enumerable:!1,configurable:!0}),t.prototype.onMouse=function(t,e){var i=this;this.mouseListener={move:t,finish:t||e?function(t){i.mouseListener={move:void 0,finish:void 0},e&&e(t)}:void 0}},t.prototype.mobile=function(t,e){this.browserAdaptive=!1,this.browser.toggleShell(!0),this.resize(t,e)},t.prototype.normal=function(t,e){this.browser.toggleShell(!1),t&&e?(this.browserAdaptive=!1,this.resize(t,e)):(this.browserAdaptive=!0,this.resize(this.innerWidth,this.innerHeight))},t.prototype.resize=function(t,e){this.browser.resize(t,e)},t.prototype.reset=function(){this.browser.reset()},t.prototype.reload=function(){this.browser.reload()},t.prototype.serialize=function(){return this.browser.serialize()},t.prototype.rotate=function(){this.browser.rotate()},t.prototype.scale=function(t){this.browser.scale(t)},t.prototype.find=function(t){return this.box.find(t)},t.prototype.run=function(){var e=this;this.viewInited=!1,this.bindEvent(),this.viewInit(),this.emit(EditorEventGetPage,function(t){e.browser.navigate(t.editable_url)},function(t){})},t.prototype.bindEvent=function(){function e(t,e){void 0===e&&(e=!1),t.on("keydown",function(t){t.ctrlKey&&"KeyS"==t.code&&(t.preventDefault(),n.emit(EditorEventSavePage,n.serialize(),function(){}))}).on("paste",function(t){!t.clipboardData&&!t.originalEvent||null!=(t=t.clipboardData||window.clipboardData)&&t.getData("text")}).on("mousemove",function(t){t={x:t.clientX,y:t.clientY};n.emit(EditorEventMouseMove,e?n.browser.globePosition(t):t)}).on("mouseup",function(t){t={x:t.clientX,y:t.clientY};n.emit(EditorEventMouseUp,e?n.browser.globePosition(t):t)}).on("touchmove",function(t){t={x:t.touches[0].clientX,y:t.touches[0].clientY};n.emit(EditorEventMouseMove,e?n.browser.globePosition(t):t)}).on("touchend",function(t){t={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};n.emit(EditorEventMouseUp,e?n.browser.globePosition(t):t)})}var n=this,t=$(window);t.on("resize",function(){n.emit(EditorEventWindowResize,t.width(),t.height())});this.on(EditorEventResize,function(t,e){n.browserAdaptive&&n.resize(t,e)}).on(EditorEventOuterWidthChange,function(){n.viewInited&&n.emit(EditorEventResize,n.innerWidth,n.innerHeight)}).on(EditorEventAfterViewInit,function(){n.emit(EditorEventResize,n.innerWidth,n.innerHeight),n.normal()}).on(EditorEventWindowResize,function(t,e){var i=e-n.box.offset().top-(0<n.box.closest(".only-editor").length?2:20);n.box.toggleClass("visual-mobile-editor",t<780&&t<e),n.outerHeight=i,n.viewInited&&n.emit(EditorEventResize,n.innerWidth,n.innerHeight)}).on(EditorEventMouseMove,function(t){n.mouseListener.move&&n.mouseListener.move(t)}).on(EditorEventMouseUp,function(t){n.mouseListener.finish&&n.mouseListener.finish(t)}).on(EditorEventBrowserReady,function(t){t.find("body").addClass("visual-editor-editable"),e(t,!0)}),e($(document)),this.emit(EditorEventWindowResize,t.width(),t.height()),this.loopCheckBox()},t.prototype.loopCheckBox=function(){var e=this,i=this.box.width(),n=500,o=function(){var t=new Date,t=(e.emit(EditorEventTimeLoop,t),e.box.width());i!==t&&(i=t,e.emit(EditorEventOuterWidthChange,t)),setTimeout(o,n)};setTimeout(o,n)},t.prototype.viewInit=function(){this.box.addClass("visual-editor"),this.box.html('\n        <div class="panel-group"></div>\n        <div class="editor-container">\n            <div class="work-container">\n                <div class="shell-box">\n                    <div class="shell-bar">\n                        <div>\n                            <i class="fa fa-ellipsis-h"></i>\n                            <i class="fa fa-signal"></i>\n                            <i class="fa fa-wifi"></i>\n                        </div>\n                        <div class="time">\n                        </div>\n                        <div class="pull-right">\n                            100%\n                            <i class="fa fa-battery-full"></i>\n                        </div>\n                    </div>\n                </div>\n                <iframe class="panel-main"></iframe>\n            </div>\n            <div class="rule-box">\n                <canvas class="h-rule-bar"></canvas>\n                <canvas class="v-rule-bar"></canvas>\n                <div class="rule-line-bar"></div>\n            </div>\n            <div class="h-scroll-bar">\n                <div class="inner-bar"></div>\n            </div>\n            <div class="v-scroll-bar">\n                <div class="inner-bar"></div>\n            </div>\n            <div class="panel-tool-bar">\n                <i class="fa fa-minus-circle" title="缩小"></i>\n                <i class="scale-text">100%</i>\n                <i class="fa fa-plus-circle" title="放大"></i>\n                <i class="fa fa-expand-arrows-alt" title="重置"></i>\n                <i class="fa fa-expand" title="全屏"></i>\n                <i class="fa fa-undo" title="翻转"></i>\n            </div>\n        </div>\n        <div class="await-widget-box">\n        </div>\n        <div class="dialog dialog-box editor-dialog" data-type="dialog" >\n            <div class="dialog-header">\n                <div class="dialog-title">编辑</div>\n                <i class="fa fa-close dialog-close"></i>\n            </div>\n            <form class="dialog-body control-dialog-body">\n                \n            </form>\n            <div class="dialog-footer">\n                <button type="button" class="dialog-yes">确认</button>\n                <button type="button" class="dialog-close">取消</button>\n            </div>\n        </div>\n        '),this.emit(EditorEventViewInit),this.workspace=this.find(".editor-container"),this.viewInited=!0,this.emit(EditorEventAfterViewInit)},t})();