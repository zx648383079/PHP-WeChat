var __spreadArray=this&&this.__spreadArray||function(t,e,i){if(i||2===arguments.length)for(var n,o=0,r=e.length;o<r;o++)!n&&o in e||((n=n||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(n||Array.prototype.slice.call(e))},EditorEventGetWeights="editor_get_wegihts",EditorEventGetWeightProperty="editor_get_wegiht_property",EditorEventSaveWeightProperty="editor_save_wegiht_property",EditorEventRefreshWeight="editor_refresh_weight",EditorEventAddWeight="editor_add_weight",EditorEventMoveWeight="editor_move_weight",EditorEventWeightForm="editor_weight_form",EditorEventRemoveWeight="editor_remove_weight",EditorEventSavePage="editor_save_page",EditorEventGetPage="editor_get_page",EditorEventWindowResize="editor_Window_resize",EditorEventResize="editor_resize",EditorEventOuterWidthChange="editor_outer_width_change",EditorEventViewInit="editor_view_init",EditorEventGetStyleSuccess="editor_get_style_success",EditorEventAfterViewInit="editor_after_view_init",EditorEventBrowserResize="editor_browser_resize",EditorEventScroll="editor_scroll",EditorEventPositionChange="editor_position_change",EditorEventDragStart="editor_drag_start",EditorEventBrowserReady="editor_browser_ready",EditorEventOpenEditDialog="editor_open_edit_dialog",EditorEventOpenProperty="editor_open_property",EditorEventDrag="editor_drag",EditorEventDrog="editor_drog",EditorEventOperateWeight="editor_operate_weight",EditorEventMouseMove="editor_mouse_move",EditorEventMouseUp="editor_mouse_up",EditorEventTimeLoop="editor_time_loop",EditorMobileStyle="mobile-style",VisualEditor=function(){function t(t){this.box=t,this.listeners={},this.mouseListener={move:void 0,finish:void 0},this.hScrollBar=new EditorScrollBar(this,!0),this.vScrollBar=new EditorScrollBar(this,!1),this.toolBar=new EditorToolBar(this),this.hRuleBar=new EditorRuler(this,!0),this.vRuleBar=new EditorRuler(this,!1),this.browser=new EditorBrowser(this),this.panelGroup=new EditorPanelGroup(this),this.weightSoul=new EditorWeightSoul(this),this.dialog=new EditorDialog(this),this.viewInited=!1,this.browserAdaptive=!1}return Object.defineProperty(t.prototype,"outerWidth",{get:function(){return this.box.width()},set:function(t){this.box.width(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"outerHeight",{get:function(){return this.box.height()},set:function(t){this.box.height(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerWidth",{get:function(){return this.viewInited?this.workspace.width()-this.vScrollBar.barSize-this.vRuleBar.barSize:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"innerHeight",{get:function(){return this.viewInited?this.workspace.height()-this.hRuleBar.barSize-this.hScrollBar.barSize:0},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e){return Object.prototype.hasOwnProperty.call(this.listeners,t)||(this.listeners[t]=[]),this.listeners[t].push(e),this},t.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];if(Object.prototype.hasOwnProperty.call(this.listeners,t))for(var n=this.listeners[t],o=n.length-1;0<=o;o--)if(!1===n[o].apply(void 0,e))break;return this},Object.defineProperty(t.prototype,"hasMouseListener",{get:function(){return void 0!==this.mouseListener.move},enumerable:!1,configurable:!0}),t.prototype.onMouse=function(t,e){var i=this;this.mouseListener={move:t,finish:t||e?function(t){i.mouseListener={move:void 0,finish:void 0},e&&e(t)}:void 0}},t.prototype.mobile=function(t,e){this.browserAdaptive=!1,this.browser.toggleShell(!0),this.resize(t,e)},t.prototype.normal=function(t,e){this.browser.toggleShell(!1),t&&e?(this.browserAdaptive=!1,this.resize(t,e)):(this.browserAdaptive=!0,this.resize(this.innerWidth,this.innerHeight))},t.prototype.resize=function(t,e){this.browser.resize(t,e)},t.prototype.reset=function(){this.browser.reset()},t.prototype.reload=function(){this.browser.reload()},t.prototype.serialize=function(){return this.browser.serialize()},t.prototype.rotate=function(){this.browser.rotate()},t.prototype.scale=function(t){this.browser.scale(t)},t.prototype.find=function(t){return this.box.find(t)},t.prototype.run=function(){var e=this;this.viewInited=!1,this.bindEvent(),this.viewInit(),this.emit(EditorEventGetPage,function(t){e.browser.navigate(t.editable_url)},function(t){})},t.prototype.bindEvent=function(){function e(t,e){void 0===e&&(e=!1),t.on("keydown",function(t){t.ctrlKey&&"KeyS"==t.code&&(t.preventDefault(),n.emit(EditorEventSavePage,n.serialize(),function(){}))}).on("paste",function(t){!t.clipboardData&&!t.originalEvent||null!=(t=t.clipboardData||window.clipboardData)&&t.getData("text")}).on("mousemove",function(t){t={x:t.clientX,y:t.clientY};n.emit(EditorEventMouseMove,e?n.browser.globePosition(t):t)}).on("mouseup",function(t){t={x:t.clientX,y:t.clientY};n.emit(EditorEventMouseUp,e?n.browser.globePosition(t):t)}).on("touchmove",function(t){t={x:t.touches[0].clientX,y:t.touches[0].clientY};n.emit(EditorEventMouseMove,e?n.browser.globePosition(t):t)}).on("touchend",function(t){t={x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY};n.emit(EditorEventMouseUp,e?n.browser.globePosition(t):t)})}var n=this,t=$(window);t.on("resize",function(){n.emit(EditorEventWindowResize,t.width(),t.height())});this.on(EditorEventResize,function(t,e){n.browserAdaptive&&n.resize(t,e)}).on(EditorEventOuterWidthChange,function(){n.viewInited&&n.emit(EditorEventResize,n.innerWidth,n.innerHeight)}).on(EditorEventAfterViewInit,function(){n.emit(EditorEventResize,n.innerWidth,n.innerHeight),n.normal()}).on(EditorEventWindowResize,function(t,e){var i=e-n.box.offset().top-(0<n.box.closest(".only-editor").length?2:20);n.box.toggleClass("visual-mobile-editor",t<780&&t<e),n.outerHeight=i,n.viewInited&&n.emit(EditorEventResize,n.innerWidth,n.innerHeight)}).on(EditorEventMouseMove,function(t){n.mouseListener.move&&n.mouseListener.move(t)}).on(EditorEventMouseUp,function(t){n.mouseListener.finish&&n.mouseListener.finish(t)}).on(EditorEventBrowserReady,function(t){t.find("body").addClass("visual-editor-editable"),e(t,!0)}),e($(document)),this.emit(EditorEventWindowResize,t.width(),t.height()),this.loopCheckBox()},t.prototype.loopCheckBox=function(){var e=this,i=this.box.width(),n=500,o=function(){var t=new Date,t=(e.emit(EditorEventTimeLoop,t),e.box.width());i!==t&&(i=t,e.emit(EditorEventOuterWidthChange,t)),setTimeout(o,n)};setTimeout(o,n)},t.prototype.viewInit=function(){this.box.addClass("visual-editor"),this.box.html('\n        <div class="panel-group"></div>\n        <div class="editor-container">\n            <div class="work-container">\n                <div class="shell-box">\n                    <div class="shell-bar">\n                        <div>\n                            <i class="fa fa-ellipsis-h"></i>\n                            <i class="fa fa-signal"></i>\n                            <i class="fa fa-wifi"></i>\n                        </div>\n                        <div class="time">\n                        </div>\n                        <div class="pull-right">\n                            100%\n                            <i class="fa fa-battery-full"></i>\n                        </div>\n                    </div>\n                </div>\n                <iframe class="panel-main"></iframe>\n            </div>\n            <div class="rule-box">\n                <canvas class="h-rule-bar"></canvas>\n                <canvas class="v-rule-bar"></canvas>\n                <div class="rule-line-bar"></div>\n            </div>\n            <div class="h-scroll-bar">\n                <div class="inner-bar"></div>\n            </div>\n            <div class="v-scroll-bar">\n                <div class="inner-bar"></div>\n            </div>\n            <div class="panel-tool-bar">\n                <i class="fa fa-minus-circle" title="缩小"></i>\n                <i class="scale-text">100%</i>\n                <i class="fa fa-plus-circle" title="放大"></i>\n                <i class="fa fa-expand-arrows-alt" title="重置"></i>\n                <i class="fa fa-expand" title="全屏"></i>\n                <i class="fa fa-undo" title="翻转"></i>\n            </div>\n        </div>\n        <div class="await-widget-box">\n        </div>\n        <div class="dialog dialog-box editor-dialog" data-type="dialog" >\n            <div class="dialog-header">\n                <div class="dialog-title">编辑</div>\n                <i class="fa fa-close dialog-close"></i>\n            </div>\n            <form class="dialog-body form-table custom-config-view">\n                \n            </form>\n            <div class="dialog-footer">\n                <button type="button" class="dialog-yes">确认</button>\n                <button type="button" class="dialog-close">取消</button>\n            </div>\n        </div>\n        '),this.emit(EditorEventViewInit),this.workspace=this.find(".editor-container"),this.viewInited=!0,this.emit(EditorEventAfterViewInit)},t}(),EditorToolBar=function(){function t(t){var n=this;this.editor=t,this.scaleValue=100,this.editor.on(EditorEventViewInit,function(){var t=n.editor.find(".panel-tool-bar");n.scaleBar=t.find(".scale-text"),n.bindEvent(t)}).on(EditorEventPositionChange,function(t,e,i){n.scaleValue=i,n.scaleBar.text(i+"%")})}return t.prototype.bindEvent=function(t){var e=this;t.on("click",".fa-minus-circle",function(){e.scaleValue<30||e.editor.scale(e.scaleValue-10)}).on("click",".fa-plus-circle",function(){300<e.scaleValue||e.editor.scale(e.scaleValue+10)}).on("click",".fa-undo",function(){e.editor.rotate()}).on("click",".fa-expand",function(){e.editor.normal()}).on("click",".fa-expand-arrows-alt",function(){e.editor.reset()})},t}(),EditorWeightSoul=function(){function t(t){var l=this;this.editor=t,this.isNew=!1,this.editor.on(EditorEventViewInit,function(){l.box=l.editor.find(".await-widget-box")}).on(EditorEventDrag,function(t,e,i){var n=t.offset(),o=i.x-n.left,r=i.y-n.top,a=t.width(),s=t.height();l.target=t,l.isNew=e,l.box.html(t.prop("outerHTML")),l.editor.onMouse(function(t){l.target&&l.setBound(t.x-o,t.y-r,a,s)},function(t){var e;l.target&&((t=l.editor.browser.getElementByPoint(t))[0]?(e=l.editor).emit.apply(e,__spreadArray([EditorEventDrog],t,!1)):l.reset())})}).on(EditorEventDrog,function(t,e){l.target&&(l.editor.emit(EditorEventOperateWeight,l.isNew,l.target,t,e),l.reset())})}return t.prototype.setBound=function(t,e,i,n){this.box.css({width:i+"px",height:n+"px",left:t+"px",top:e+"px"})},t.prototype.reset=function(){this.target&&(this.target=void 0,this.setBound(0,0,0,0))},t}(),EditorPanelGroup=function(){function t(t){var n=this;this.editor=t,this.children=[new EditorWeightPanel(this.editor),new EditorPropertyPanel(this.editor)],this.renderedChildren=[],this.visible=!0,this.editor.on(EditorEventViewInit,function(){n.box=n.editor.find(".panel-group");for(var t=0,e=n.children;t<e.length;t++){var i=e[t];n.onRender(i)}}).on(EditorEventAfterViewInit,function(){n.bindEvent()}).on(EditorEventResize,function(){for(var t=n.box.height(),e=0,i=n.renderedChildren;e<i.length;e++)i[e].target.find(".panel-body").height(t-36)})}return t.prototype.bindEvent=function(){var r=this;this.box.on("click",".panel-item .panel-header .fa-close",function(t){t.stopPropagation();for(var e=$(this).closest(".panel-item"),i=0,n=r.renderedChildren;i<n.length;i++){var o=n[i];r.isSame(o.target,e)&&o.control.hide()}r.toggle(!1)}).on("click",".panel-header",function(){var t=$(this).closest(".panel-item");if(t.hasClass("min")){for(var e=0,i=r.renderedChildren;e<i.length;e++){var n=i[e];r.isSame(n.target,t)?n.control.show():n.control.hide()}r.toggle(!0)}}).on("click",".expand-box .expand-header",function(){$(this).closest(".expand-box").toggleClass("open")})},t.prototype.toggle=function(t){this.visible!==t&&(this.box.toggleClass("min",!t),this.visible=t,this.editor.emit(EditorEventResize,this.editor.innerWidth,this.editor.innerHeight))},t.prototype.add=function(t){this.children.push(t),this.onRender(t)},t.prototype.onRender=function(t){var e;this.box&&(this.children.indexOf(t),e=t.render(),this.box.append(e),e.addClass("panel-item"),0<this.renderedChildren.length?t.hide():t.show(),this.renderedChildren.push({target:e,control:t}))},t.prototype.isSame=function(t,e){return t.is(e)},t}(),EditorPropertyPanel=function(){function t(t){var e=this;this.editor=t,this.lastAt=0,this.isAsync=!1,this.editor.on(EditorEventAfterViewInit,function(){e.bindEvent()}).on(EditorEventGetStyleSuccess,function(t){e.renderStyle(t)}).on(EditorEventOpenProperty,function(t){e.saveSync(),e.box.find(".panel-header").trigger("click"),e.target=t,e.editor.emit(EditorEventGetWeightProperty,t.id(),function(t){e.editor.emit(EditorEventGetStyleSuccess,t.styles),e.lastAt=(new Date).getTime(),e.applyForm(t)})}).on(EditorEventTimeLoop,function(t){e.isAsync&&2e4<(t=t.getTime())-e.lastAt&&(e.saveSync(),e.lastAt=t)})}return t.prototype.bindEvent=function(){var t,e=this;this.box&&(t=this).box.on("change",".position-input select",function(){var t=$(this);t.next().html(EditorHtmlHelper.positionSide(t.val()))}).on("click",'.background-input input[type="radio"]',function(){var t=$(this);t.closest(".background-input").find(".value-input").html(EditorHtmlHelper.backgroundValue(t.attr("name").replace("[type]",""),t.val()))}).on("click",".switch-input",function(){var t=$(this),e=!t.hasClass("checked");t.toggleClass("checked",e),t.find(".switch-label").text(e?t.data("on"):t.data("off")),t.find("input").val(e?1:0).trigger("change")}).on("change","input,textarea",function(){t.autoSave()}).on("click",".style-item",function(){$(this).addClass("active").siblings().removeClass("active"),t.autoSave()}).on("click",".reset-btn",function(){e.applyForm({}),e.autoSave()})},t.prototype.saveSync=function(){var t,e=this;this.isAsync=!1,this.target&&(t=formData(this.box.find(".form-table"))+"&style_id="+EditorHelper.parseNumber(this.box.find(".style-item.active").attr("data-id"))+"&id="+this.target.id(),this.editor.emit(EditorEventSaveWeightProperty,this.target.id(),t,function(t){e.target.html(t.html)}))},t.prototype.autoSave=function(){this.isAsync=!0,this.lastAt=(new Date).getTime()},t.prototype.render=function(){return this.box=$('<div class="panel-item min" data-panel="property"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">属性</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body">\n            <div class="tab-box">\n                    <div class="tab-header"><div class="tab-item active">\n                            普通\n                        </div><div class="tab-item">\n                            高级\n                        </div><div class="tab-item">\n                            样式\n                        </div></div>\n                    <div class="tab-body form-table">\n                        <div class="tab-item active">\n                        </div>\n                        <div class="tab-item">\n                        <div class="expand-box open">\n                                <div class="expand-header">整体<span class="fa fa-chevron-down"></span></div>\n                                <div class="expand-body">\n                                    \n                                </div>\n                            </div>\n                            <div class="expand-box">\n                                <div class="expand-header">标题<span class="fa fa-chevron-down"></span></div>\n                                <div class="expand-body">\n                                    \n                                </div>\n                            </div>\n                            <div class="expand-box">\n                                <div class="expand-header">内容<span class="fa fa-chevron-down"></span></div>\n                                <div class="expand-body">\n                                    \n                                </div>\n                            </div>\n                        </div>\n                        <div class="tab-item style-panel">\n                            <div class="style-item" data-id="0">\n                                无\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        '),this.box},t.prototype.renderStyle=function(t){t=EditorHtmlHelper.mapJoinHtml(t,function(t){return'<div class="style-item" data-id="'.concat(t.id,'">\n            <img src="').concat(t.thumb,'" alt="').concat(t.name,'">\n        </div>')});this.box.find(".style-panel").html('<div class="style-item" data-id="0">无</div>'.concat(t))},t.prototype.show=function(){this.box.removeClass("min")},t.prototype.hide=function(){this.box.addClass("min")},t.prototype.applyForm=function(e){var t=null==(t=e.settings)?void 0:t.style,i=this.box.find(".form-table .tab-item"),n=(i[0].innerHTML=EditorHtmlHelper.title(e.title)+EditorHtmlHelper.lazy(null==(n=e.settings)?void 0:n.lazy)+EditorHtmlHelper.share(e.is_share)+EditorHtmlHelper.button("重置","reset-btn"),$(i[1]).find(".expand-body"));n[0].innerHTML=EditorHtmlHelper.margin(null==t?void 0:t.margin)+EditorHtmlHelper.position(null==t?void 0:t.position)+EditorHtmlHelper.border(null,null==t?void 0:t.border)+EditorHtmlHelper.radius(null,e.settings?e.settings["border-radius"]:null)+EditorHtmlHelper.color(null,null==(i=e.settings)?void 0:i.color)+EditorHtmlHelper.background(null,null==(i=e.settings)?void 0:i.background),n[1].innerHTML=EditorHtmlHelper.visibility("title",null==(i=null==t?void 0:t.title)?void 0:i.visibility)+EditorHtmlHelper.padding("title",null==(i=null==t?void 0:t.title)?void 0:i.padding)+EditorHtmlHelper.border("title",null==(i=null==t?void 0:t.title)?void 0:i.border)+EditorHtmlHelper.radius("title",null==t?void 0:t.title["border-radius"])+EditorHtmlHelper.color("title",null==(i=null==t?void 0:t.title)?void 0:i.color)+EditorHtmlHelper.fontSize("title",null==t?void 0:t.title["font-size"])+EditorHtmlHelper.fontWeight("title",null==t?void 0:t.title["font-weight"])+EditorHtmlHelper.textAlign("title",null==t?void 0:t.title["text-align"])+EditorHtmlHelper.background("title",null==(i=null==t?void 0:t.title)?void 0:i.background),n[2].innerHTML=EditorHtmlHelper.visibility("content",null==(i=null==t?void 0:t.content)?void 0:i.visibility)+EditorHtmlHelper.padding("content",null==(n=null==t?void 0:t.content)?void 0:n.padding)+EditorHtmlHelper.border("content",null==(i=null==t?void 0:t.content)?void 0:i.border)+EditorHtmlHelper.radius("content",null==t?void 0:t.content["border-radius"])+EditorHtmlHelper.color("content",null==(n=null==t?void 0:t.content)?void 0:n.color)+EditorHtmlHelper.fontSize("content",null==t?void 0:t.content["font-size"])+EditorHtmlHelper.fontWeight("content",null==t?void 0:t.content["font-weight"])+EditorHtmlHelper.textAlign("content",null==t?void 0:t.content["text-align"])+EditorHtmlHelper.background("content",null==(i=null==t?void 0:t.content)?void 0:i.background),this.box.find(".style-item").each(function(){var t=$(this);t.toggleClass("active",t.attr("data-id")==e.style_id)})},t}(),EditorWeightPanel=function(){function t(t){var e=this;this.editor=t,this.editor.on(EditorEventAfterViewInit,function(){e.editor.emit(EditorEventGetWeights,function(t){e.renderWeight(t.weights)}),e.bindEvent()})}return t.prototype.bindEvent=function(){var i=this.editor;this.box.on("mousedown",".visual-edit-control",function(t){var e=$(this);"true"!==e.attr("draggable")&&(t.stopPropagation(),t.preventDefault(),i.emit(EditorEventDrag,e,!0,{x:t.clientX,y:t.clientY}))}).on("touchstart",".visual-edit-control",function(t){var e=$(this);t.stopPropagation(),t.preventDefault(),i.emit(EditorEventDrag,e,!0,{x:t.touches[0].clientX,y:t.touches[0].clientY})}).on("dragstart",".visual-edit-control",function(t){t.originalEvent.dataTransfer.setData("Text",t.target.id),i.emit(EditorEventDragStart,$(this))})},t.prototype.render=function(){return this.box=$('<div class="panel-item" data-panel="weight"></div'),this.box.html('\n            <div class="panel-header">\n                <span class="title">部件</span>\n                <a class="fa fa-close"></a>\n            </div>\n            <div class="panel-body">\n            </div>\n        '),this.box},t.prototype.renderWeight=function(t){t=EditorHtmlHelper.mapJoinHtml(t,function(i){var t=EditorHtmlHelper.mapJoinHtml(i.items,function(t){var e;return t?(e=t.editable?'<a class="edit">编辑</a>':"",'<div class="visual-edit-control" data-type="weight" data-weight="'.concat(t.id,'" data-group="').concat(i.id,'">\n                <div class="visual-preview">\n                    <div class="thumb">\n                        <img src="').concat(t.thumb,'" alt="').concat(t.name,'" title="').concat(t.description,'">\n                    </div>\n                    <p class="title">').concat(t.name,'</p>\n                </div>\n                <div class="visual-action">\n                    <a class="refresh">刷新</a>\n                    ').concat(e,'\n                    <a class="property">属性</a>\n                    <a class="drag">拖拽</a>\n                    <a class="del">删除</a>\n                </div>\n                <div class="visual-view">\n                    <img src="/assets/images/ajax.gif" alt="">\n                </div>\n            </div>')):""});return'\n            <ul class="menu">\n                <li class="expand-box open">\n                    <div class="expand-header">\n                        '.concat(i.name,'\n                        <span class="fa fa-chevron-down"></span>\n                    </div>\n                    <div class="expand-body list-view">\n                    ').concat(t,"\n                    </div>\n                    </li>\n                </ul>\n            ")});this.box.find(".panel-body").html(t)},t.prototype.show=function(){this.box.removeClass("min")},t.prototype.hide=function(){this.box.addClass("min")},t}(),EditorDialog=function(){function t(t){var i=this,n=(this.editor=t,this);this.editor.on(EditorEventViewInit,function(){var t=i.editor.find(".editor-dialog");i.innerForm=t.find(".dialog-body"),i.box=t.dialog(),t.on("click",".multiple-box .multiple-add-btn",function(){var t=$(this);t.before(t.prev(".item").clone())}).on("click",".multiple-box .multiple-del-btn",function(){var t=$(this);1<t.closest(".multiple-box").find(".item").length&&t.closest(".item").remove()}).on("click",".switch-input",function(){var t=$(this),e=!t.hasClass("checked"),e=(t.toggleClass("checked",e),t.find(".switch-label").text(e?t.data("on"):t.data("off")),e?1:0);t.find("input").val(e).trigger("change"),n.toggleTab(t,e,1)}).on("change",".radio-label input",function(){var t=$(this),e=t.closest(".input-group");n.toggleTab(e,t.closest(".radio-label").index(),e.find(".radio-label").length-1)}).on("change",".check-label",function(){var t=$(this),e=t.closest(".input-group");n.toggleTab(e,t.closest(".check-label").index(),e.find(".check-label").length-1)}).on("change","select",function(){var t=$(this);n.toggleTab(t,t.prop("selectedIndex"),t.find("option").length-1)}),i.box.on("done",function(){i.editor.emit(EditorEventSaveWeightProperty,i.target.id(),t.find(".dialog-body").serialize(),function(t){n.editor.emit(EditorEventOpenProperty,n.target),n.target.html(t.html)}),i.box.close()})}).on(EditorEventOpenEditDialog,function(e){i.target=e,i.editor.emit(EditorEventWeightForm,e.id(),function(t){i.box.find(".dialog-body").html('<input type="hidden" name="id" value="'+e.id()+'">'+t.html),i.box.showCenter()})})}return t.prototype.toggleTab=function(t,e,i){var n=t.attr("data-tab");if(n)for(var o=t.attr("data-panel"),r=o?t.closest(o):this.innerForm,a=0;a<=i;a++)r.find(n+a).toggleClass("hidden",e!==a)},t}(),EditorBrowser=function(){function t(t){var o=this;this.editor=t,this.frameScale=100,this.shellVisbile=!1,this.editor.on(EditorEventViewInit,function(){o.shellTimeBar=o.editor.find(".shell-bar .time"),o.shell=o.editor.find(".work-container"),o.frame=o.editor.find(".panel-main"),o.bindEvent()}).on(EditorEventScroll,function(t,e){e?o.bound.left=-t:o.bound.top=-t,o.renderTransform(),o.editor.emit(EditorEventPositionChange,o.bound.left,o.bound.top,o.frameScale)}).on(EditorEventResize,function(){o.bound&&o.resize(o.bound.width,o.bound.height)}).on(EditorEventDragStart,function(t){o.dragWeight=t}).on(EditorEventTimeLoop,function(t){o.shellVisbile&&o.shellTimeBar.text([t.getHours(),t.getMinutes()].map(EditorHelper.twoPad).join(":"))}).on(EditorEventOperateWeight,function(t,e,i,n){o.dragWeight=void 0,t?(o.selectedWeight=new EditorWeight(o.editor,e.clone()),o.selectedWeight.appendTo(i,n)):(o.selectedWeight=new EditorWeight(o.editor,e),o.selectedWeight.moveTo(i,n))})}return t.prototype.bindEvent=function(){var e=this;this.frame.on("load",function(){var t=e.frame.contents();e.frameBody=t.find("body"),e.editor.emit(EditorEventBrowserReady,t),e.bindFrameEvent()})},t.prototype.bindFrameEvent=function(){function e(t,e){i.dragWeight?(i.selectedWeight=new EditorWeight(i.editor,i.dragWeight.clone()),i.selectedWeight.appendTo(t,e)):i.selectedWeight&&i.selectedWeight.moveTo(t,e)}var i=this;this.frameBody.on("dragover",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault()}).on("drop",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault(),e($(this))}).on("mouseup",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault(),i.editor.emit(EditorEventDrog,$(this))}).on("mouseup",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault();t=$(this);i.editor.emit(EditorEventDrog,t.closest(".visual-edit-row"),t)}).on("touchend",".visual-edit-row",function(t){t.stopPropagation(),t.preventDefault(),i.editor.emit(EditorEventDrog,$(this))}).on("touchend",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault();t=$(this);i.editor.emit(EditorEventDrog,t.closest(".visual-edit-row"),t)}).on("dragover",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault()}).on("drop",".visual-edit-control",function(t){t.stopPropagation(),t.preventDefault();t=$(this);e(t.closest(".visual-edit-row"),t)}).on("dragstart",".visual-edit-control",function(t){t.originalEvent.dataTransfer.setData("Text",t.target.id),i.selectedWeight=new EditorWeight(i.editor,$(this))}).on("dragend",".visual-edit-control",function(){$(this).attr("draggable","false")}).on("mousedown",".visual-action .drag",function(t){t.stopPropagation(),i.dragWeight=void 0;var e=$(this).closest(".visual-edit-control");i.editor.emit(EditorEventDrag,e,!1,{x:t.clientX,y:t.clientY})}).on("touchstart",".visual-action .drag",function(t){t.stopPropagation(),t.preventDefault(),i.dragWeight=void 0;var e=$(this).closest(".visual-edit-control");i.editor.emit(EditorEventDrag,e,!1,{x:t.touches[0].clientX,y:t.touches[0].clientY})}).on("click",".visual-action .del",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapRemove()}).on("click",".visual-action .edit",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapEdit()}).on("click",".visual-action .refresh",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapRefresh()}).on("click",".visual-action .property",function(t){t.stopPropagation(),i.selectedWeight=new EditorWeight(i.editor,$(this).closest(".visual-edit-control")),i.selectedWeight.tapProperty()}).on("click","a",function(t){t.preventDefault()})},t.prototype.globePosition=function(t){var e=this.frame.offset();return{x:t.x+e.left,y:t.y+e.top}},t.prototype.framePosition=function(t){var e=this.frame.offset();return{x:t.x-e.left,y:t.y-e.top}},t.prototype.getElementByPoint=function(t){var i=this.framePosition(t);if(!(i.x<0||i.y<0||i.x>this.frame.width()||i.y>this.frame.height())){for(var e,n=function(t){var e=t.offset();return!(e.left>i.x||e.top>i.y)&&e.left+t.width()>i.x&&e.top+t.height()>i.y},o=void 0,r=this.frameBody;;)if("break"===function(){var e=!1;if(r.find(".visual-edit-row").each(function(){var t=$(this);if(n(t))return r=o=t,!(e=!0)}),!e)return"break"}())break;return o?(e=void 0,o.find(".visual-edit-control").each(function(){var t=$(this);if(n(t))return e=t,!1}),[o,e]):[void 0,void 0]}},t.prototype.toggleShell=function(t){this.shellVisbile=t,this.shell.toggleClass(EditorMobileStyle,t)},t.prototype.rotate=function(){this.resize(this.bound.height,this.bound.width)},t.prototype.scale=function(t){this.frameScale=t,this.renderTransform(),this.emitRealSize(),this.editor.emit(EditorEventPositionChange,this.bound.left,this.bound.top,this.frameScale)},t.prototype.renderTransform=function(){var t=[];100!==this.frameScale&&t.push("scale("+this.frameScale/100+")"),0===this.bound.left&&0===this.bound.top||t.push("translate(".concat(this.bound.left,"px, ").concat(this.bound.top,"px)")),this.shell.css("transform",t.join(" "))},t.prototype.resize=function(t,e,i,n,o){var r=this.editor.innerWidth,a=this.editor.innerHeight;i||n||(t=r<=(i=t)?0:(r-i)/2,e=a<=(n=e)?0:(a-n)/2),this.shell.css({width:i+"px",height:n+"px",transform:"translate(".concat(t,"px, ").concat(e,"px)")}),this.bound={left:t,top:e,height:n,width:i},o&&(this.frameScale=o,this.renderTransform()),this.emitRealSize(),this.editor.emit(EditorEventPositionChange,t,e,this.frameScale)},t.prototype.emitRealSize=function(){var t=this.editor.innerWidth,e=this.editor.innerHeight,i=this.frameScale/100;this.editor.emit(EditorEventBrowserResize,this.bound.left*i,this.bound.top*i,this.bound.width*i,this.bound.height*i,t,e)},t.prototype.reset=function(){this.resize(this.bound.width,this.bound.height,0,0,100)},t.prototype.navigate=function(t){this.frame.attr("src",t)},t.prototype.reload=function(){this.frame[0].contentWindow.location.reload()},t.prototype.navigateString=function(t){this.frame.attr("src","data:text/html;charset=utf-8,"+encodeURI(t))},t.prototype.serialize=function(){var o;return this.frameBody?(o=[],this.frameBody.find(".visual-edit-row").each(function(){var t=$(this),i=t.attr("data-id"),n=t.attr("data-index");t.children(".visual-edit-control").each(function(t){var e=$(this);o.push({id:e.attr("data-id"),parent_id:i,parent_index:n,position:t+1})})}),o):[]},t}(),EditorWeight=function(){function t(t,e){this.editor=t,this.box=e}return t.prototype.toggle=function(t){return this.box.toggleClass("visual-edit-mode",t),this},t.prototype.toggleLoading=function(t){return this.box.toggleClass("visual-loading",t),this},t.prototype.html=function(t){t=$(t);return this.box=this.box.replaceWith(t),this.box=t,this},t.prototype.id=function(){return EditorHelper.parseNumber(this.box.attr("data-id"))},t.prototype.weightId=function(){return EditorHelper.parseNumber(this.box.attr("data-weight"))},t.prototype.tapRefresh=function(){var e=this;this.toggleLoading(!0),this.editor.emit(EditorEventRefreshWeight,this.id(),function(t){e.toggleLoading(!1),e.html(t.html)},function(){e.toggleLoading(!1)})},t.prototype.tapEdit=function(){this.editor.emit(EditorEventOpenEditDialog,this)},t.prototype.tapProperty=function(){this.editor.emit(EditorEventOpenProperty,this)},t.prototype.tapRemove=function(){var t=this;this.editor.emit(EditorEventRemoveWeight,this.id(),function(){t.remove()})},t.prototype.moveTo=function(t,e){e=this.appendToPosition(t,e);this.editor.emit(EditorEventMoveWeight,{id:this.id(),parent_id:t.attr("data-id"),parent_index:t.attr("data-index"),position:e},function(){})},t.prototype.appendTo=function(t,e){var i=this,e=this.appendToPosition(t,e);this.box.width("auto"),this.toggleLoading(!0),this.editor.emit(EditorEventAddWeight,{weight_id:this.weightId(),weight_group:this.box.attr("data-group"),parent_id:t.attr("data-id"),parent_index:t.attr("data-index"),position:e},function(t){i.toggleLoading(!1),i.html(t.html)},function(){i.toggleLoading(!1)})},t.prototype.appendToPosition=function(t,e){var i;return!e||(i=t.children().index(e))<0?(t.append(this.box),t.children().length):(this.box.insertBefore(e),i+1)},t.prototype.remove=function(){this.box.remove()},t}(),EditorScrollBar=function(){function t(t,e){var a=this;void 0===e&&(e=!0),this.editor=t,this.horizontal=e,this.baseSize=8,this.left=0,this.maxLeft=0,this.pxScale=1,this.editor.on(EditorEventViewInit,function(){a.element=a.editor.find(a.horizontal?".h-scroll-bar":".v-scroll-bar"),a.innerBar=a.element.find(".inner-bar"),a.baseSize=a.horizontal?a.element.height():a.element.width(),a.innerBar.on("mousedown",function(t){var i={x:t.clientX,y:t.clientY};a.editor.onMouse(function(t){var e=a.horizontal?t.x-i.x:t.y-i.y;a.scroll(a.left+e),i=t})})}).on(EditorEventBrowserResize,function(t,e,i,n,o,r){a.horizontal?a.onRender(t,o,i,a.element.width()):a.onRender(e,r,n,a.element.height())})}return Object.defineProperty(t.prototype,"barSize",{get:function(){return this.baseSize},enumerable:!1,configurable:!0}),t.prototype.move=function(t){this.scroll(t/this.pxScale)},t.prototype.scroll=function(t){this.left=Math.max(0,Math.min(t,this.maxLeft)),this.innerBar.css(this.horizontal?"left":"top",this.left+"px"),this.output()},t.prototype.scrollTo=function(t){this.scroll(t*this.maxLeft/100)},t.prototype.output=function(){this.editor.emit(EditorEventScroll,this.converter(this.left),this.horizontal)},t.prototype.converter=function(t){return t*this.pxScale},t.prototype.onRender=function(t,e,i,n){var o;i<=e?(this.maxLeft=0,this.applySize(0,n)):(o=Math.min(6*this.baseSize,this.baseSize/2),this.maxLeft=n-(e=(i=n-(n=i-e))<=o?o:i),this.pxScale=n/this.maxLeft,this.applySize(t/this.pxScale,e))},t.prototype.applySize=function(t,e){var i;this.left=Math.max(0,Math.min(t,this.maxLeft)),this.innerBar.css(((i={})[this.horizontal?"left":"top"]=t+"px",i[this.horizontal?"width":"height"]=e+"px",i))},t}(),EditorRuler=function(){function t(t,e){var n=this;void 0===e&&(e=!0),this.editor=t,this.horizontal=e,this.offset=0,this.gap=10,this.scale=1,this.foreground="#333",this.background="#ccc",this.baseWidth=0,this.baseX=0,this.baseSize=16,this.editor.on(EditorEventViewInit,function(){n.element=n.editor.find(n.horizontal?".h-rule-bar":".v-rule-bar"),n.baseSize=n.horizontal?n.element.height():n.element.width()}).on(EditorEventResize,function(t,e){n.refresh(),n.onAfterViewInit()}).on(EditorEventPositionChange,function(t,e,i){n.offset=n.horizontal?t:e,n.scale=i/100,n.onRender(n.element[0].getContext("2d"))})}return Object.defineProperty(t.prototype,"barSize",{get:function(){return this.baseSize},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsetX",{get:function(){return this.barSize-this.offset},enumerable:!1,configurable:!0}),t.prototype.refresh=function(){this.baseWidth=this.horizontal?this.editor.innerWidth:this.editor.innerHeight},t.prototype.onAfterViewInit=function(){var t;this.element.length<1||(t=this.element[0],this.horizontal?(t.width=this.baseWidth,t.height=this.barSize):(t.width=this.barSize,t.height=this.baseWidth),this.onRender(t.getContext("2d")))},t.prototype.createLine=function(t){t=(this.horizontal?t.clientX:t.clientY)-this.baseX;return{value:t,label:Math.floor((t+this.offsetX)/this.scale),horizontal:this.horizontal}},t.prototype.onRender=function(t){t.fillStyle=this.background,t.lineWidth=2;for(var e=this.barSize,i=(this.horizontal?t.fillRect(0,0,this.baseWidth,e):t.fillRect(0,0,e,this.baseWidth),this.gap*this.scale),n=Math.ceil(this.baseWidth/i),o=Math.ceil(this.offsetX/i),r=.3*e,a=0;a<n;a++){var s=o+a,l=s%5==0,d=s*i-this.offsetX,c=e*(l?.6:.4);this.horizontal?(this.drawLine(t,{x:d,y:0},{x:d,y:c},this.foreground),l&&this.drawText(t,(s*this.gap).toString(),r,this.foreground,{x:d,y:c})):(this.drawLine(t,{x:0,y:d},{x:c,y:d},this.foreground),l&&this.drawText(t,(s*this.gap).toString(),r,this.foreground,{x:c-2*r,y:d}))}},t.prototype.drawText=function(t,e,i,n,o){t.font="normal normal bold ".concat(i,"px"),t.fillStyle=n,t.fillText(e,o.x,o.y+i)},t.prototype.drawLine=function(t,e,i,n){t.beginPath(),t.strokeStyle=n,t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.stroke()},t}(),EditorTree=function(){function t(t,e,i,n){void 0===n&&(n={titleKey:"title",childrenKey:"children",iconKey:"icon",inputPrefix:"item_"}),this.box=t,this.itemForm=e,this.dataInput=i,this.option=n,this.items=[];t=this.dataInput.val();t&&(this.items=JSON.parse(t)),this.bindEvent(),this.render()}return t.prototype.bindEvent=function(){var e=this;this.box.on("click",".tree-add",function(){var t=$(this).parent();e.addSource(t)}).on("click",".tree-item-line",function(){e.editSource($(this).closest(".tree-item"))}).on("click",".tree-item-action .fa-arrow-up",function(t){t.stopPropagation(),e.move($(this).closest(".tree-item"),-1)}).on("click",".tree-item-action .fa-arrow-down",function(t){t.stopPropagation(),e.move($(this).closest(".tree-item"),1)}).on("click",".tree-item-action .fa-times",function(t){t.stopPropagation(),e.remove($(this).closest(".tree-item"))}),this.itemForm.on("click",".tree-save-btn",function(){e.saveSource()})},t.prototype.getPath=function(t){for(var e=t.parent(),i=[t.index()];e.hasClass("tree-children");){var n=e.closest(".tree-item");i.push(n.index()),e=n.parent()}return i.reverse()},t.prototype.getSource=function(t){for(var t=this.getPath(t),e=t.pop(),i=this.items,n=0,o=t;n<o.length;n++)i=i[o[n]][this.option.childrenKey];return[i,e]},t.prototype.remove=function(t){var e=this.getSource(t),i=e[0],e=e[1];i.splice(e,1),this.editNode.is(t)&&(this.editData=void 0,this.editNode=void 0),t.remove(),this.output()},t.prototype.move=function(t,e){var i,n,o,r;0===e||0==(i=t.index())&&e<0||i===(n=t.parent().children(".tree-item")).length-1&&0<e||(e<0&&i+e<0?e=-i:0<e&&i+e>=n.length&&(e=n.length-i-1),(o=this.getSource(t)[0]).splice(r=i+e,0,o[i]),o.splice(i+e<0?1:0,1),t.insertBefore(n[r]),this.output())},t.prototype.output=function(){this.dataInput.val(JSON.stringify(this.items))},t.prototype.editSource=function(t){var i=this,t=(this.editNode=t,this.parentNode=t.parent(),this.getSource(t)),e=t[0],t=t[1];this.editData=e[t],this.parentData=e,EditorHelper.eachObject(this.editData,function(t,e){i.itemForm.find("*[name="+i.option.inputPrefix+e+"]").val(t).trigger("change")})},t.prototype.addSource=function(t){var e;this.parentNode=t,this.editData=void 0,this.editNode=void 0,this.itemForm.find("input,textarea").each(function(){var t=$(this),e=t.attr("type");"checkbox"!==e&&"radio"!==e&&"color"!==e&&"hidden"!==e&&t.val("")}),t.hasClass("tree-children")?(e=(t=this.getSource(t.closest(".tree-item")))[0],t=t[1],this.parentData=e[t][this.option.childrenKey]):this.parentData=this.items},t.prototype.saveSource=function(){this.parentData||(this.parentData=this.items,this.parentNode=this.box);var t,e=this.editData||{},i=this;this.itemForm.find("select,input,textarea").each(function(){var t=$(this);0<t.closest(".hidden").length||(e[t.attr("name").substring(i.option.inputPrefix.length)]=t.val())}),e[this.option.titleKey]?("children"===e.type?e[this.option.childrenKey]=[]:delete e[this.option.childrenKey],this.editNode?this.editNode.replaceWith(this.renderTreeItem(e)):(this.editData=e,this.parentData.push(e),(t=this.parentNode.children(".tree-add")).before(this.renderTreeItem(e)),this.editNode=t.prev(),console.log(this.editNode)),this.output()):Dialog.tip("请输入标题")},t.prototype.render=function(){this.box.html(this.renderTree(this.items))},t.prototype.renderTree=function(t){for(var e="",i=0,n=t;i<n.length;i++){var o=n[i];e+=this.renderTreeItem(o)}return e+'<div class="tree-add">\n        <i class="fa fa-plus"></i>\n    </div>'},t.prototype.renderTreeItem=function(t){var e="",i=(t[this.option.childrenKey]&&(e='<div class="tree-children">'+this.renderTree(t[this.option.childrenKey])+"</div>"),""),t=(t[this.option.iconKey]&&(i='<i class="fa '+t[this.option.iconKey]+'"></i>'),t[this.option.titleKey]);return'<div class="tree-item">\n        <div class="tree-item-line">\n            '.concat(i,"\n            <span>").concat(t,'</span>\n            <div class="tree-item-action">\n                <i class="fa fa-arrow-up"></i>\n                <i class="fa fa-arrow-down"></i>\n                <i class="fa fa-times"></i>\n            </div>\n        </div>\n        ').concat(e,"\n    </div>")},t}(),EditorHelper=function(){function n(){}return n.twoPad=function(t){return t<10&&0<=t?"0"+t:t.toString()},n.parseNumber=function(t){return!t||isNaN(t)?0:"number"==typeof t?t:"boolean"==typeof t?t?1:0:(t=0<(t=0<(t="string"!=typeof t?t.toString():t).indexOf(",")?t.replace(/,/g,""):t).indexOf(".")?parseFloat(t):parseInt(t,10),isNaN(t)?0:t)},n.checkRange=function(t,e,i){return void 0===i&&(i=100),t<(e=void 0===e?0:e)?e:e<i&&i<t?i:t},n.cloneObject=function(t){if("object"!=typeof t)return t;if(t instanceof Array)return t.map(function(t){return n.cloneObject(t)});var e,i={};for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i[e]=n.cloneObject(t[e]));return i},n.eachObject=function(t,e){if("object"!=typeof t)return e(t,void 0);if(t instanceof Array){for(var i=0;i<t.length;i++)if(!1===e(t[i],i))return!1}else for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!1===e(t[n],n))return!1},n}(),EditorHtmlHelper=function(){function r(){}return r.guid=function(){return r._guid++},r.value=function(t,e){return void 0===e&&(e=""),null==t?e:t},r.join=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.map(function(t){return r.value(t)}).join("")},r.mapJoinHtml=function(t,i){var n="";return EditorHelper.eachObject(t,function(t,e){n+=i(t,e)}),n},r.title=function(t){void 0===t&&(t="");var e="title_"+r.guid();return r.input(e,"标题",r.text(e,"title",t))},r.lazy=function(t){var e="settings_lazy_"+r.guid();return r.input(e,"懒加载",r.switch(e,"settings[lazy]",t))},r.share=function(t){var e="is_share_"+r.guid();return r.input(e,"共享",r.switch(e,"is_share",t))},r.margin=function(t){return r.sideInput("settings[style][margin]","外边距",t=void 0===t?[]:t)},r.padding=function(t,e){return r.sideInput("settings[style]["+t+"][padding]","内边距",e=void 0===e?[]:e)},r.position=function(t){var e=r.positionSide(null==t?void 0:t.type,null==t?void 0:t.value),t=r.option({static:"无",relative:"相对定位",absolute:"绝对定位",fixed:"固定定位"},null==t?void 0:t.type);return r.input("","悬浮",'<select class="form-control" name="settings[style][position][type]">'.concat(t,'</select><div class="side-input">').concat(e,"</div>"),"position-input")},r.positionSide=function(t,e){return t&&"static"!=t?r.side("settings[style][position][value]","settings[style][position][value]",e):""},r.border=function(t,e){var i=r.nameToId(t="settings[style]"+(t?"["+t+"]":"")+"[border]")+"_"+r.guid(),n=r.checkbox(i,t+"[side][]",["上","右","下","左"],null==e?void 0:e.side),o=r.option(["实线","虚线"],e&&e.value&&1==e.value[1]?1:0);return r.input(i,"边框",r.join('<input type="text" class="form-control" name="',t,'[value][]" value="',null==e?void 0:e.value[0],'" placeholder="粗细" size="4"><select  class="form-control" name="',t,'[value][]">',o,'</select><input type="color"  class="form-control" name="',t,'[value][]" value="',null==e?void 0:e.value[2],'"><div class="side-input">',n,"</div>"))},r.radius=function(t,e){var i=r.nameToId(t="settings[style]"+(t?"["+t+"]":"")+"[border-radius]")+"_"+r.guid();return r.input(i,"圆角",r.join('<input type="text" id="',i,'_0" class="form-control" name="',t,'[]" value="',(e=e||[])[0],'" size="4" placeholder="左上"><input type="text" id="',i,'_1" class="form-control" name="',t,'[]" value="',e[1],'" size="4" placeholder="右上"><br/><input type="text" id="',i,'_2" class="form-control" name="',t,'[]" value="',e[2],'" size="4" placeholder="左下"><input type="text" id="',i,'_3" class="form-control " name="',t,'[]" value="',e[3],'" size="4" placeholder="右下">'))},r.color=function(t,e){var i=r.nameToId(t="settings[style]"+(t?"["+t+"]":"")+"[color]")+"_"+r.guid();return r.input(i,"字体颜色",r.join(r.radio(i,t+"[type]",["无","有"],null==e?void 0:e.type),'<input type="color"  class="form-control" name="',t,'[value]" value="',null==e?void 0:e.value,'">'))},r.background=function(t,e){var i=r.nameToId(t="settings[style]"+(t?"["+t+"]":"")+"[background]")+"_"+r.guid(),t=r.radio(i,t+"[type]",["无","颜色","图片"],"0")+'<div class="value-input">'+r.backgroundValue(t,null==e?void 0:e.type)+"</div>";return r.input(i,"背景",t,"background-input")},r.backgroundValue=function(t,e){return!e||e<1?"":2==e?'<div class="file-input">\n            <input type="text" class="form-control " name="'.concat(t,'[value]" value="" size="10">\n            <button type="button" data-type="upload">上传</button>\n        </div>'):'<input type="color" class="form-control" name="'.concat(t,'[value]">')},r.visibility=function(t,e){var i=r.nameToId(t="settings[style]["+t+"][visibility]")+"_"+r.guid();return r.input(i,"可见",r.switch(i,t,e,"显示","隐藏"))},r.fontSize=function(t,e){var i=r.nameToId(t="settings[style]["+t+"][font-size]")+"_"+r.guid();return r.input(i,"字体大小",r.text(i,t,e,4))},r.textAlign=function(t,e){var i=r.nameToId(t="settings[style]["+t+"][text-align]")+"_"+r.guid();return r.input(i,"字体位置",r.radio(i,t,["居左","居中","居右"],e||0))},r.fontWeight=function(t,e){var i=r.nameToId(t="settings[style]["+t+"][font-weight]")+"_"+r.guid();return r.input(i,"字体粗细",r.text(i,t,e,4))},r.option=function(t,i){var n="";return $.each(t,function(t){var e=i==t?" selected":"";n+='<option value="'.concat(t,'"').concat(e,">").concat(this,"</option>")}),n},r.sideInput=function(t,e,i){void 0===i&&(i=[]);var n=r.nameToId(t)+"_"+r.guid();return r.input(n,e,r.side(n,t,i),"side-input")},r.side=function(i,n,o){void 0===o&&(o=[]);var r="";return $.each(["上","右","下","左"],function(t){var e=o&&o.length>t?o[t]:"";r+='<input type="text" id="'.concat(i,"_").concat(t,'" class="form-control " name="').concat(n,'[]" size="4" value="').concat(e,'" placeholder="').concat(this,'">')}),r},r.switch=function(t,e,i,n,o){return void 0===n&&(n="开启"),void 0===o&&(o="关闭"),i=EditorHelper.parseNumber(i),r.join('<div id="',t,'" class="switch-input" data-on="',n,'" data-off="',o,'"><span class="switch-control"></span><span class="switch-label">',0<i?n:o,'</span><input type="hidden" name="',e,'" value="',i,'"/></div>')},r.radio=function(n,o,t,r){var a="",s=0;return $.each(t,function(t){var e=[n,s++].join("_"),i=t==r?" checked":"";a+='<span class="radio-label"><input type="radio" id="'.concat(e,'" name="').concat(o,'" value="').concat(t,'"').concat(i,'><label for="').concat(e,'">').concat(this,"</label></span>")}),a},r.checkbox=function(n,o,t,r){void 0===r&&(r=[]);var a="",s=0;return $.each(t,function(t){var e=[n,s++].join("_"),i=r&&0<=r.indexOf(t)?" checked":"";a+='<span class="check-label"><input type="checkbox" id="'.concat(e,'" name="').concat(o,'" value="').concat(t,'"').concat(i,'><label for="').concat(e,'">').concat(this,"</label></span>")}),a},r.text=function(t,e,i,n){void 0===i&&(i="");n=n?' size="'.concat(n,'"'):"";return i=r.value(i),'<input type="text" id="'.concat(t,'" class="form-control" name="').concat(e,'" value="').concat(i,'"').concat(n,">")},r.input=function(t,e,i,n){return void 0===n&&(n=""),'<div class="input-group"><label for="'.concat(t,'">').concat(e,'</label><div class="').concat(n,'">').concat(i,"</div></div>")},r.button=function(t,e){return'<button type="button" class="btn '.concat(e,'">').concat(t,"</button>")},r.nameToId=function(t){return t.replace(/\[/g,"_").replace(/\]/g,"")},r._guid=0,r}();